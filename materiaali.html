<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <style>
            div.maar,
            div.esim,
            div.image {
                border:none;
                -webkit-box-shadow:rgba(0,0,0,0.2) 0 1px 0 0;
                -moz-box-shadow:rgba(0,0,0,0.2) 0 1px 0 0;
                box-shadow:rgba(0,0,0,0.2) 0 1px 0 0;
                color: #333;
                border-radius:5px;
                -moz-border-radius:5px;
                -webkit-border-radius:5px;

                margin: 1em;
                padding: 1em;
            }
            div.maar {
                background-color: #eeeeff;
            }

            div.esim {
                background-color: #eeffee;
            }
            div.maar h3 {
                background-color:#ddddee;
            }
            div.esim h3 {
                background-color:#ddeedd;
            }

            div.maar h3,
            div.esim h3 {
                -webkit-box-shadow:rgba(0,0,0,0.2) 0 1px 0 0;
                -moz-box-shadow:rgba(0,0,0,0.2) 0 1px 0 0;
                box-shadow:rgba(0,0,0,0.2) 0 1px 0 0;
                color:#333;
                border-radius:5px;
                -moz-border-radius:5px;
                -webkit-border-radius:5px;
                border:none;
                font-size:16px;
                font-weight:700;
                height:32px;
                padding:4px 16px;
                text-shadow:#FE6 0 1px 0;
                padding-top: 1em;
                cursor:pointer;
            }

            div.image {
                background-color: #fcfcfc;
                text-align: center;
            }

            div.image img{
                display: inline-block;
                margin-left: auto;
                margin-right: auto;
            }

            div.box-mooc {
                font-size: 1.2em;
            }

            div.sisalto {
                padding-left: 20px;
            }
        </style>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script type="text/javascript">
                    function hideExerciseText() {
                    \(('.drop').each(function() {
                    \((this).find(\(('.header')).each(function() {
                    \((this).next().hide();
                    });
                    })
                    }

                    function click() {
                    \(('.header').click(function() {
                    \((this).next('.sisalto').slideToggle(200);
                    });
                    }

                    \((document).ready(function() {
                    hideExerciseText();
                            click();
                    });

        </script>
    </head>
    <body>
        \(

        \newcommand{\N}{\mathbb{N}}
        \newcommand{\Z}{\mathbb{Z}}
        \newcommand{\Q}{\mathbb{Q}}
        \newcommand{\R}{\mathbb{R}}
        \newcommand{\C}{\mathbb{C}}
        \newcommand{\vP}{\mathcal{P}}
        \newcommand{\kB}{\mathcal{B}}
        \newcommand{\kC}{\mathcal{C}}
        \newcommand{\kS}{\mathcal{S}}
        \newcommand{\kR}{\mathcal{R}}
        \newcommand{\vS}{\mathcal{S}}
        \newcommand{\kE}{\mathcal{E}}
        \newcommand{\vF}{\mathcal{F}}

        \newcommand{\vx}{\bar{x}}
        \newcommand{\vy}{\bar{y}}
        \newcommand{\vv}{\bar{v}}
        \newcommand{\vw}{\bar{w}}
        \newcommand{\vu}{\bar{u}}
        \newcommand{\vp}{\bar{p}}
        \newcommand{\vq}{\bar{q}}
        \newcommand{\vn}{\bar{n}}
        \newcommand{\va}{\bar{a}}
        \newcommand{\vb}{\bar{b}}
        \newcommand{\vi}{\bar{i}}
        \newcommand{\vj}{\bar{j}}
        \newcommand{\vk}{\bar{k}}
        \newcommand{\ve}{\bar{e}}
        \newcommand{\suoral}{\mathcal{l}}
        \newcommand{\nv}{\bar{0}}
        \newcommand{\id}{\mathrm{id}} 
        \newcommand{\pv}{\overline}
        \)

        <section class="kappaleraja" id="1">
            <div div class="kappaleraja-linis" id="Avaruuksien \(\R^2\) ja \(\R^3\) vektorit" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                <h1>Avaruuksien \(\R^2\) ja \(\R^3\) vektorit</h1>
                <p>
                    Lukiomatematiikassa vektorit esitettiin olioina, joilla on suunta ja pituus. Tason ja kolmiulotteisen avaruuden vektorit kirjoitettiin yleensä yksikkövektorien \(\vi\), \(\vj\) ja \(\vk\) avulla. Eräs tason vektori saattoi olla vaikkapa \(\vv=3\vi-2\vj\). Huomattiin, että jokaisella koordinaatiston pisteellä on paikkavektori, jonka komponentit ovat pisteen koordinaatit. Esimerkiksi pisteen \((3,-2)\) paikkavektori olisi edellä mainittu vektori \(\vv\).
                </p><p>
                    Kun vektorin käsitettä yleistetään korkeampiin ulottuvuuksiin, osoittautuu helpoimmaksi käsitellä vektoreita ja avaruuden pisteitä samalla tavalla. Esimerkiksi merkintä \((3,-2)\) tulee tarkoittamaan sekä pistettä \((3,-2)\) että yllä määriteltyä vektoria \(\vv\). Myös merkinnät yksinkertaistuvat, kun voidaan luopua yksikkövektoreiden \(\vi\), \(\vj\) ja \(\vk\) käytöstä. <!-- , eikä korkeampiulotteisten avaruuksien kohdalla tule vastaan ongelmaa: mitä tehdä kun kirjaimet loppuvat. -->
                </p><p>
                    Tässä luvussa käsitellään tason ja kolmiulotteisen avaruuden vektoreita. Näitä avaruuksia kutsutaan nimillä \(\R^2\) ja \(\R^3\). <!-- Käsiteltävä asia on tuttua koulusta, mutta käytettävät merkinnät ja nimitykset saattavat olla uusia. -->
                </p>
                <h2 class="header">Kaksiulotteisen avaruuden vektorit</h2>

                <div class="maar">
                    <h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <p>Avaruus \(\R^2\) koostuu reaalilukupareista. Toisin sanoen</p>
                        \[
                        \R^2=\{(a,b) \mid \text{\(a \in \R\) ja \(b \in \R\)}\}.
                        \]
                        <p>Avaruuden \(\R^2\) alkioita kutsutaan <strong>vektoreiksi</strong>.</p>
                    </div>
                </div>
                <p>
                    <strong>Huom. 1.</strong> Määritelmä tarkoittaa sopimusta. Tässä siis sovitaan, mitä avaruuden \(\R^2\) vektoreilla tarkoitetaan. Määritelmää ei tarvitse perustella millään tavalla.
                </p><p>
                    <strong>Huom. 2.</strong> Tarkalleen ottaen vektori \((a,b)\) on niin kutsuttu <strong>järjestetty pari</strong>. Tämä tarkoittaa sitä, että lukujen \(a\) ja \(b\) järjestyksellä on väliä. Esimerkiksi järjestetty pari \((1,2)\) ei ole sama kuin järjestetty pari \((2,1)\).
                </p><p>
                    <strong>Huom. 3.</strong> Jos joukko-opin merkinnät (esim. \(\in\), \(\subset\), \(\setminus\)) eivät ole tuttuja, voit katsoa apua kurssisivulla olevasta tiedostosta ''<a href="https://wiki.helsinki.fi/download/attachments/86363760/joukkoOppia.pdf">Joukko-opin merkintöjä</a>''.

                </p><p>
                    Vektoreita merkitään tässä tekstissä yleensä pienellä kirjaimella, jonka päällä on viiva. Voidaan esimerkiksi kirjoittaa \(\vv=(a,b)\). Luvut \(a\) ja \(b\) ovat tällöin vektorin \(\vv\) <strong>komponentteja</strong>}. Avaruuden \(\R^2\) vektoreissa on aina kaksi komponenttia, ja avaruutta \(\R^2\) kutsutaan <strong>kaksiulotteiseksi vektoriavaruudeksi</strong>.
                </p>
                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Esimerkiksi \(\vv=(4,-1)\) ja \(\vu=\bigl(\frac{1}{2}, -\sqrt{5}\bigr)\) ovat
                            avaruuden \(\R^2\) vektoreita. Vektorin \(\vv\) komponentit ovat \(4\) ja \(-1\).
                            Vektorin \(\vu\) komponentit ovat puolestaan \(\frac{1}{2}\) ja \(-\sqrt{5}\).</p>
                    </div>
                </div>
                <p>
                    Kaksiulotteisen avaruuden vektoreita voidaan havainnollistaa eri tavoin. Eräs tapa on ajatella vektorit koordinaatiston pisteinä. Vektoria \((a,b)\) vastaa piste, jonka vaakakoordinaatti on \(a\) ja pystykoordinaatti \(b\). Kuvassa  alla <!-- alla <!-- \ref{k-->2} -->on esitetty vektoreita \((1,3)\) ja \((-3,2)\) vastaavat tason pisteet.
                </p><p>
                    Vektoria \((a,b)\) voi kuvata myös pisteen \((a,b)\) paikkavektorina eli suuntajanana, jonka lähtöpiste on origo ja päätepiste \((a,b)\). Vektoreita \((1,3)\) ja \((-3,2)\) vastaavat paikkavektorit on myös esitetty kuvassa  alla <!-- alla <!-- \ref{k-->2} -->.
                </p>
                <div class="image">

                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva2.png" /> 
                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva3.png" />
                    <p><strong>Kuva: </strong>Tason pisteet, jotka vastaavat vektoreita \((1,3)\) ja \((-3,2)\), sekä samoja vektoreita vastaavat paikkavektorit.</p><!-- <!-- \label{k2} -->
                </div>

                <p> Pisteen ja paikkavektorin lisäksi avaruuden \(\R^2\) vektoria voi havainnollistaa mistä tahansa pisteestä lähtevällä suuntajanana. Suuntajanan paikalla ei ole väliä, ainoastaan sen suunta ja pituus merkitsevät. Vektoria \((a,b)\) vastaavalla suuntajanalla on sama suunta ja pituus kuin pisteen \((a,b)\) paikkavektorilla. Kuvassa  alla <!-- alla <!-- \ref{k-->4} --> on esitetty vektoria \((1,3)\) vastaavia suuntajanoja sekä vektoria \((-3,2)\) vastaavia suuntajanoja.
                </p>
                <div class="image">

                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva4.png" />
                    <p><strong>Kuva: </strong>Vektoreita \((1,3)\) ja \((-3,2)\) vastaavia suuntajanoja.</p><!-- <!-- \label{k4} -->
                </div>
                <p>
                    Avaruuden \(\R^2\) vektori on siis tällä kurssilla määritelmänsä mukaan kahdesta reaaliluvusta koostuva järjestetty pari. Vektoreita voidaan kuitenkin havainnollistaa pisteinä, paikkavektoreina tai suuntajanoina. Se, millainen havainnollistamistapa on paras, riippuu siitä, mitä ollaan tekemässä. Usein vektoreita käsiteltäessä on pystyttävä vaihtamaan sulavasti yhdestä esitystavasta toiseen.
                </p><p>
                    Koulusta tutut tason yksikkövektorit ovat määritelmän mukaan \(\vi=(1,0)\) ja \(\vj=(0,1)\). Näitä merkintöjä ei käytetä tällä kurssilla.
                </p>
                <h2 class="header">Vektorien laskutoimitukset</h2>
                <p>
                    Vektoreille voidaan määritellä erilaisia laskutoimituksia. Yhteenlasku suoritetaan lisäämällä yhteenlaskettavien vektorien komponentit yhteen.
                </p>
                <div class="maar">
                    <h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <p>Oletetaan, että \(\vv=(v_1,v_2) \in \R^2\) ja \(\vw=(w_1,w_2) \in \R^2\).
                            Vektoreiden \(\vv\) ja \(\vw\) <strong>summa</strong> on vektori</p>
                        \[
                        \vv+\vw=(v_1+w_1,v_2+w_2).
                        \]
                    </div>
                </div>
                <p>
                    Lisäksi vektoreita voidaan kertoa reaaliluvuilla. Tätä operaatiota kutsutaan
                    <strong>skalaarikertolaskuksi</strong>. Skalaarikertolaskussa vektorin molemmat komponentit kerrotaan samalla luvulla.
                </p>
                <div class="maar">
                    <h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        Jos \(\vv=(v_1,v_2) \in \R^2\) ja \(c \in \R\), määritellään
                        \[
                        c\vv=(cv_1,cv_2).
                        \]
                    </div>
                </div>
                <p>
                    Vektorien yhteydessä reaalilukuja kutsutaan usein <strong>skalaareiksi</strong>, ja siitä johtuu myös skalaarikertolaskun nimitys.
                </p>
                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        Tarkastellaan vektoreita \(\vv=(4,1)\) ja \(\vw=(-3,2)\). Niiden summa on
                        \[
                        \vv+\vw=(4+(-3),1+2)=(1,3).
                        \]
                        <!-- Yhteenlaskussa vektorien komponentit lasketaan yhteen, ja siksi -->
                        Yhteenlaskua voidaan havainnollistaa geometrisesti (ks. kuva  alla <!-- alla <!-- \ref{k-->5}) -->. Vektorien summa nähdään asettamalla vektoreita vastaavat suuntajanat peräkkäin niin, että jälkimmäinen vektori alkaa siitä, mihin ensimmäinen päättyi. Summavektorin alkupiste on ensimmäisen vektorin alkupiste ja päätepiste jälkimmäisen vektorin päätepiste.

                        <div class="image">

                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva5.png" />
                            <p><strong>Kuva: </strong>Vektorit \(\vv\) ja \(\vw\) sekä niiden summa \(\vv + \vw\).</p><!-- <!-- \label{k5} -->
                        </div>

                        Tutkitaan sitten skalaarikertolaskua. Määritelmän mukaan
                        \[
                        \begin{split}
                        2\vv & =(2\cdot 4,2\cdot 1)=(8,2) \\
                        \text{ja}  -\frac{1}{2}\vv & =\left(-\frac{1}{2}\cdot 4, \, -\frac{1}{2}\cdot 1\right)
                        =\left(-2,-\frac{1}{2}\right).
                        \end{split}
                        \]
                        Vektorit \(2\vv\) ja \(-\frac{1}{2}\vv\) on piirretty kuvaan  alla <!-- alla <!-- \ref{k-->6} -->. Huomataan, että skalaarilla kertominen venyttää (eli skaalaa) vektoria vastaavan suuntajanan pituutta, mutta säilyttää suuntajanan suunnan, kuitenkin niin, että negatiivisella skalaarilla kertominen kääntää suunnan vastakkaiseksi.

                        <div class="image">

                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva6.png" />
                            <p><strong>Kuva: </strong>Skalaarimonikerrat \(2\vv\) ja \(-\frac{1}{2}\vv\).</p><!-- <!-- \label{k6} -->
                        </div>
                    </div>
                </div>

                <div class="maar">
                    <h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <p>Vektorille \((-1)\vv\) käytetään merkintää \(-\vv\).  Summalle \(\vv+(-\vw)\) puolestaan käytetään merkintää \(\vv-\vw\). Tätä kutsutaan vektorien \(\vv\) ja \(\vw\) <strong>erotukseksi</strong>.<p>
                    </div>
                </div>
                <p>
                    Esimerkiksi vektorien \((-1,6)\) ja \((4,2)\) erotus on
                    \[
                    (-1,6)-(4,2)=(-1,6)+(-1)(4,2)=(-1,6)+(-4,-2)=(-5,4).
                    \]
                </p><p>
                    Vektorien erotuksen voi määrittää kuvasta samaan tapaan kuin summan. Vektorien \(\vv\) ja \(\vw\) erotus \(\vv-\vw\) saadaan laskemalla yhteen vektori \(\vv\) ja vastavektori \(\vw\). Toisin sanoen jälkimmäisen vektorin suunta on käännettävä ennen yhteenlaskua.
                </p><p>
                    Se, että suuntajanan voi siirtää alkamaan mistä pisteestä tahansa, aiheuttaa toisinaan hämmennystä. Kuvassa  alla <!-- alla <!-- \ref{k-->8} --> on eräs tapa esittää kaksi vektoria sekä niiden summa ja erotukset molemmin päin. Kannattaa selvittää itselleen harjoituksen vuoksi, miksi vektorien suunnat ovat kuvassa niin kuin ovat.
                </p>
                <div class="image">

                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva8.png" />
                    <p><strong>Kuva: </strong>Vektorien \(\vv\) ja \(\vw\) summa sekä erotukset \(\vw-\vv\) ja \(\vv-\vw\).</p><!-- <!-- \label{k8} -->
                </div>

                <!-- Kahden vektorin summaa voi havainnollistaa suunnikkaan avulla. Jos vektorit ovat suunnikkaan sivut, summavektori on sivujen välissä kulkeva lävistäjä. Vektoreiden erotus on puolestaan samanlaisen suunnikkaan toinen lävistäjä. Erotusvektorin suunta riippuu siitä, kumpi vektori vähennetään kummasta. -->

                <h2 class="header">Kolmiulotteinen avaruus</h2>
                <p>
                    Kaikki edellä esitellyt käsitteet voidaan määritellä myös kolmiulotteisessa avaruudessa. Avaruus \(\R^3\) on joukko
                    \[
                    \{(a,b,c) \mid a,b,c \in \R\}.
                    \]
                    Myös avaruuden \(\R^3\) alkioita nimitetään vektoreiksi, ja avaruutta \(\R^3\) kutsutaan kolmiulotteiseksi vektoriavaruudeksi. Avaruuden \(\R^3\) vektoreita voidaan ajatella avaruuskoordinaatiston pisteinä, paikkavektoreina tai suuntajanoina. Yhteenlasku ja skalaarikertolasku määritellään komponenteittain samalla tavalla kuin avaruudessa \(\R^2\).
                    <!-- Kuvassa -->
                    <!-- ?? on esitetty vektorit \(\vv=(-3,4,1)\) ja \(\vv=(0,2,2)\). Niiden summa on -->
                    <!-- \[\vv+\vw=(-3+0,4+4,1+2)=(-3,8,3).\] -->
                    <!-- Lisäksi \(-4\vv=(-4(-3),-4\cdot 4, 1\cdot 2)=(12,-1,3)\). -->
                </p><p>
                    Kolmiulotteisen avaruuden yksikkövektorit ovat \(\vi=(1,0,0)\), \(\vj=(0,1,0)\) ja \(\vk=(0,0,1)\). Näitä merkintöjä ei jatkossa tulla tarvitsemaan.
                    <!-- Ovat merkinnät sitten mitkä tahansa, tulevat nämä vektorit olemaan keskeisessä roolissa myöhemmissä luvuissa. -->
                </p>
            </div>
        </section>
        <section class="kappaleraja" id="2">
            <div div class="kappaleraja-linis" id="Avaruus \(\R^n\)" tekija="Jokke häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                <h1>Avaruus \(\R^n\)</h1>
                <p>
                    Edellisessä luvussa käsiteltiin avaruuksien \(\R^2\) ja \(\R^3\) vektoreita eli
                    reaalilukupareja ja reaalilukukolmikoita. Näitä avaruuksia voidaan yleistää määrittelemällä \(n\)-ulotteinen avaruus \(\R^n\).
                </p>
                <div class="maar">
                    <h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <p>Oletetaan, että \(n \in \{1,2,3,\dots\}\). Avaruuden \(\R^n\) alkiot ovat reaaliluvuista koostuvia \(n\)-jonoja. Toisin sanoen</p>
                        \[\R^n=\{(v_1,v_2,\dots,v_n) \mid v_1,v_2,\dots,v_n \in \R\}.\]
                        <p>Avaruuden \(\R^n\) alkioita kutsutaan <strong>vektoreiksi</strong>.</p>
                    </div>
                </div>
                <p>
                    Jos \(\vv=(v_1,v_2,\dots,v_n) \in \R^n\), niin lukuja \(v_1,v_2,\dots,v_n\) kutsutaan
                    vektorin \(\vv\) <strong>komponenteiksi</strong>. Sovimme, että ellei toisin mainita, vektorin \(\vv\) komponentteja merkitään symboleilla
                    \(v_1,v_2,\dots,v_n\).
                </p><p>
                    Yleisille \(n\)-ulotteisen avaruuden vektoreille määritellään laskutoimitukset samoin kuin kaksi- ja kolmiulotteisessa tapauksessa.
                </p>
                <div class="maar"><h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <p>Oletetaan, että \(\vv \in \R^n\), \(\vw \in \R^n\) ja \(c \in \R\). Tällöin</p>
                        \[
                        \begin{align*}
                        \vv+\vw & =(v_1+w_1,\,v_2+w_2,\,\dots,\,v_n+w_n)  \text{ja} \\
                        c\vv & =(cv_1,\,cv_2,\,\dots,\,cv_n).
                        \end{align*}
                        \]
                        <p>Ensimmäistä laskutoimitusta nimitetään vektorien <strong>yhteenlaskuksi</strong> ja toista <strong>skalaarikertolaskuksi</strong>.</p>
                    </div>
                </div>
                <p>
                    Vektorien yhteydessä reaalilukuja kutsutaan <strong>skalaareiksi</strong>. Jos \(\vv \in \R^n\) ja \(c \in \R\), vektoria \(c\vv\) nimitetään vektorin \(\vv\) <strong>skalaarimonikerraksi</strong>.
                    <!-- ja siitä johtuu myös skalaarikertolaskun nimitys. -->

                </p><p>
                    <strong>Huom.</strong> Ainoastaan samanulotteisen avaruuden vektoreita voi laskea yhteen.
                </p>
                <div class="maar">
                    <h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <p> Vektorin \(\vv\) <strong>vastavektori</strong> on skalaarimonikerta \((-1)\vv\). Sitä merkitään \(-\vv\). Vektoreiden \(\vv\) ja \(\vw\) <strong>erotus</strong> on summa \(\vv+(-\vw)\). Sitä merkitään \(\vv-\vw\).
                            Vektoria \((0,0,\dots,0)\) kutsutaan <strong>nollavektoriksi</strong>. Sille käytetään merkintää \(\nv\).
                        </p>
                    </div>
                </div>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Merkitään \(\vv = (-5,3,0,1,-1)\) ja \(\vw = (-2,-4,2,3,5)\). Tällöin \(\vv\) ja \(\vw\) ovat avaruuden \(\R^5\) vektoreita. Lasketaan vektorit \(2\vv - 3\vw\) ja \(-5\vv-\vw\):</p>
                        \[
                        \begin{split}
                        2\vv - 3\vw &= (-10,6,0,2,-2) - (-6,-12,6,9,15)=(-4,18,-6,-7,-17) \\
                        -5\vv-\vw &= (25, -15, 0, -5, 5) - (-2,-4,2,3,5) = (27, -11, -2, -8, 0).
                        \end{split}
                        \]
                    </div>
                </div>
                <p>
                    Voidaan osoittaa, että avaruuden \(\R^n\) vektoreille pätevät koulusta tutut laskusäännöt.
                </p>
                <div class="lause">
                    <h3>Lause</h3><!-- <!-- \label{RnVektoriavaruusLause} -->
                    <p>Oletetaan, että \(\vv, \vw, \vu \in \R^n\) ja \(a, b \in \R\). Tällöin pätee:</p>
                    \[
                    \begin{align*}
                    & \text{1.}  \vv + \vw=\vw + \vv & & \text{(vaihdannaisuus)} \\
                    & \text{2.}  (\vu + \vv) + \vw = \vu + (\vv + \vw) & & \text{(liitännäisyys)} \\
                    & \text{3.}  \vv + \nv = \vv \\
                    & \text{4.}  \vv + (-\vv) = \nv \\
                    & \text{5.}  a(\vv+\vw)=a\vv+a\vw & & \text{(osittelulaki)} \\
                    & \text{6.}  (a+b)\vv = a\vv + b\vv & & \text{(osittelulaki)} \\
                    & \text{7.}  a(b\vv)=(ab)\vv  \\
                    & \text{8.}  1\vv =\vv.
                    \end{align*}
                    \]
                    <!--  <ol> -->
                    <!--  <li>  \(\vv + \vw=\vw + \vv\) (vaihdannaisuus) -->
                    <!--  <li>  \((\vu + \vv) + \vw = \vu + (\vv + \vw)\) (liitännäisyys) -->
                    <!--  <li>  \(\vv + \nv = \vv\)-->
                    <!--  <li>  \(\vv + (-\vv) = \nv\)-->
                    <!--  <li>  \(a(\vv+\vw)=a\vv+a\vw\) (osittelulaki) -->
                    <!--  <li>  \((a+b)\vv = a\vv + b\vv\) (osittelulaki) -->
                    <!--  <li>  \(a(b\vv)=(ab)\vv\)-->
                    <!--  <li>  \(1\vv =\vv\)-->
                    <!--  </ol> -->

                    <p>
                        <strong>Huom.</strong> Lause tarkoittaa väitettä, joka voidaan perustella todeksi nojautumalla määritelmiin ja aikaisemmin todeksi osoitettuihin väitteisiin.
                    </p>
                    <div class="proof drop">
                        <h4 class="otsikko">Todistus</h4>
                        <div class="sisalto">
                            Todistetaan esimerkin vuoksi kohta 1 ja jätetään loput kohdat harjoitustehtäviksi. Oletetaan kuten lauseessa, että \(\vv\in\R^n\) ja \(\vw\in\R^n\). Tällöin \(\vv=(v_1, \dots, v_n)\) ja \(\vw=(w_1, \dots, w_n)\), ja luvut \(v_1, \dots, v_n\) ja \(w_1, \dots, w_n\) ovat reaalilukuja. Koska reaalilukujen yhteenlasku on vaihdannainen, jokaisella \(i\in\{1,\dots,n\}\) pätee \(v_i+w_i=w_i+v_i\). Nyt nähdään, että
                            \[
                            \begin{split}
                            \vv + \vw &= (v_1 + w_1,\, v_2 + w_2,\, \dots,\, v_n+w_n) \\
                            &=(w_1 + v_1,\, w_2 + v_2,\, \dots,\, w_n+v_n)= \vw + \vv.
                            \end{split}
                            \]
                            Väite on todistettu.
                        </div>
                    </div>
                </div>
                <p>
                    Tasovektorien yhteydessä todettiin, että skalaarikertolasku säilyttää (tai kääntää) vektorin suunnan. Otetaan tämä havainto yleisten vektorien yhdensuuntaisuuden määritelmäksi.
                    <!-- Skalaarikertolaskun avulla voidaan määritellä vektorien yhdensuuntaisuus. -->
                </p>
                <div class="maar"><h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <p>Avaruuden \(\R^n\) vektorit \(\vv\) ja \(\vw\) ovat <strong>yhdensuuntaiset</strong>, jos \(\vv=r\vw\)
                            jollakin \(r \in \R \setminus \{0\}\). Tällöin merkitään \(\vv \parallel \vw\).</p>
                    </div>
                </div>
                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto"><!-- <!-- \label{esim:yhdensuuntaisuus -->
                        <p>
                            Vektorit \(\vv=(-2,1)\) ja \(\vw=(6,-3)\) ovat
                            yhdensuuntaiset, sillä \(\vv=-\frac{1}{3}\vw\). Vektorit \(\vv\) ja \(\vu=(3,-1)\) eivät
                            puolestaan ole yhdensuuntaiset, mikä voidaan päätellä seuraavasti. Jos olisi olemassa \(r \in \R\), jolle
                            pätisi \(\vv=r\vu\), niin täytyisi olla</p>
                        \[
                        \underbrace{(-2,1)}_{\vv}=r\underbrace{(3,-1)}_{\vu}=(3r,-r).
                        \]
                        <p>Siispä \(-2=3r\) ja \(1=-r\). Ensimmäisen yhtälön mukaan \(r=-2/3\), mutta toisen yhtälön mukaan \(r=-1\). Tämä on
                            mahdotonta, joten ei ole olemassa sellaista lukua \(r\), jolle pätee \(\vv=r\vu\).
                            Siten vektorit \(\vv\) ja \(\vu\) eivät ole yhdensuuntaiset.
                        </p><p>
                            Vektorit \(\vv\), \(\vw\) ja \(\vu\) on esitetty kuvassa  alla <!-- alla <!-- \ref{k-->7} -->.
                        </p>
                        <div class="image">

                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva7.png" />
                            <p><strong>Kuva: </strong>Esimerkin <!-- \ref{esim:yhdensuuntaisuus} --> vektorit \(\vv\), \(\vw\) ja \(\vu\).</p><!-- <!-- \label{k7} -->
                        </div>
                        <!-- Vektorit \(\vv=(3,-4,1,-3)\) ja \(\vx=(9,-12,3,-9)\) ovat samansuuntaiset, sillä \(\vv=1/3\vx\). -->
                        <!-- Piirrä tästä kuva. -->

                    </div>

                </div>
                <!-- Yhdensuuntaisuuden määritelmää voidaan myös yleistää ottamalla mukaan useampia vektoreita. Tällöin päädytään käsitteeseen, jota tarvitaan jatkossa hyvin monesti vektoriavaruuksien ominaisuuksia tutkittaessa -->

                <div class="maar">
                    <h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <p>Vektori \(\vw \in \R^n\) on vektoreiden \(\vv_1, \vv_2, \dots \vv_k \in \R^n\) <strong>lineaarikombinaatio</strong> eli  <strong>lineaariyhdistelmä</strong>, jos on olemassa sellaiset reaaliluvut \(a_1, a_2, \dots, a_k\), että</p>
                        \[
                        \vw = a_1\vv_1 + a_2\vv_2 + \cdots + a_k\vv_k.
                        \]
                        <!-- Jos \(\vv_1,\dots,\vv_k \in \R^n\) ja \(a_1,a_2,\dots,a_k \in \R\), summaa -->
                        <!-- \(a_1\vv_1+a_2\vv_2+\dots a_k\vv_k \mid a_1,a_2\) kutsutaan vektoreiden -->
                        <!-- \(\vv_1,\dots,\vv_k\) lineaarikombinaatioksi. -->
                    </div>
                </div>
                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Merkitään \(\vv_1 = (1,1)\), \(\vv_2 = (-1,2)\) ja \(\vw = (5,-1)\). Vektori \(\vw\) on vektoreiden \(\vv_1\) ja \(\vv_2\) lineaarikombinaatio, sillä</p>
                        \[
                        \begin{split}
                        3\vv_1 - 2\vv_2
                        &= 3(1,1) - 2(-1,2) = (3,3)-(-2,4) \\
                        &= (5,-1) = \vw.
                        \end{split}
                        \]

                        <div class="image">

                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva9.png" /> 
                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva10.png" />
                            <p><strong>Kuva: </strong>Vektori \(\vw\) on vektoreiden \(\vv_1\) ja \(\vv_2\) lineaarikombinaatio.</p><!-- <!-- \label{k9-10} -->
                        </div>
                    </div>
                </div>
                <p>Edellisessä esimerkissä arvattiin, mitkä kertoimien \(a_1\) ja \(a_2\) pitää olla, jotta pätisi \(\vw=a_1\vv_1+a_2\vv_2\). Myöhemmin esitellään yleinen keino kertoimien selvittämiseksi.</p>
            </div>
        </section>
        <section class="kappaleraja" id="3">
            <div div class="kappaleraja-linis" id="Suorat ja tasot" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                <h1>Suorat ja tasot</h1>

                <!-- Tässä luvussa käsitellään avaruuksien \(\R^2\) ja \(\R^3\) suoria ja tasoja vektoreiden näkökulmasta. -->

                <h2 class="header">Suora</h2>

                <!-- Havaitsimme skalaarikertolaskun tulkinnan yhteydessä, että -->
                <!-- Jos \(\vv\) on mikä tahansa nollasta poikkeava tason \(\R^2\) vektori ja \(t\) on jokin reaaliluku, niin vektori \(t\vv\) on yhdensuuntainen vektorin \(\vv\) kanssa. Tällöin että näitä vektoreita vastaavat koordinaatiston pisteet sijaitsevat samalla suoralla. Voidaan siis sanoa, että vektorijoukkoa -->
                <!-- \begin{equation}<!-- <!-- \label{yhtalo:origon_kautta_kulkeva_suora} -->
                <!-- \{t\vv \mid t \in \R\} -->
                <!-- \end{equation} -->
                <!-- vastaava pistejoukko muodostaa koordinaatiston suoran. Kullakin kertoimen \(t\) valinnalla saadaan jokin suoran pisteistä. Jos valitaan \(t=1\), saadaan alkuperäinen piste \(\vv\). -->
                <p>
                    Kun vektoria \((3,-1)\) kerrotaan reaaliluvuilla, on tuloksena vektoreita, jotka ovat yhdensuutaisia vektorin \((3,-1)\) kanssa. Näitä vektoreita vastaavat koordinaatiston pisteet sijaitsevat samalla suoralla. Voidaan siis sanoa, että joukko \(\{t(3,-1) \mid t \in \R\}\).
                    muodostaa koordinaatiston suoran. Kullakin kertoimen \(t\) valinnalla saadaan jokin suoran pisteistä. Jos valitaan \(t=1\), saadaan alkuperäinen piste \((3,1)\).
                    <!-- \begin{equation}<!-- <!-- \label{yhtalo:origon_kautta_kulkeva_suora} -->
                    <!-- \{t(3,1) \mid t \in \R\} -->
                    <!-- \end{equation -->
                </p>
                <div class="image">

                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva127.png" />
                    <p><strong>Kuva: </strong>Suora \(\{t(3,-1) \mid t \in \R\}\).</p><!-- <!-- \label{k127} -->
                </div>
                <p>
                    Kun edellä mainitussa esityksessä \(t(3,-1)\) valitaan \(t=0\), saadaan nollavektori \(\nv\). Suora kulkee siis origon kautta.
                    <!-- Nollavektori on siis aina mukana muotoa \eqref{yhtalo:origon_kautta_kulkeva_suora} olevassa suorassa. -->
                    Jos halutaan muodostaa  suora, joka ei kulje origon kautta, on suora ensin ''siirrettävä'' haluttuun paikkaan. Esimerkiksi suora \(\{(1,2)+t(3,-1) \mid t \in \R\}\)
                    <!-- \[ -->
                    <!-- \{(-1,2)+t(3,1) \mid t \in \R\} -->
                    <!-- \] -->
                    ei kulje origon kautta.
                </p>
                <div class="image">

                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva128.png" />
                    <p><strong>Kuva: </strong>Suora \(\{(1,2)+t(3,-1) \mid t \in \R\}\).</p><!-- <!-- \label{k128} -->
                </div>

                <!-- Määritelmä toimii yhtä hyvin kaksi- kuin kolmiulotteisessakin avaruudessa. -->

                <div class="maar">
                    <h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <!-- Olkoon \(n=2\) tai \(n=3\). -->
                        <p>Avaruuden \(\R^n\) <strong>suora</strong> on joukko</p>
                        \[
                        \{\vp+t\vv \mid t \in \R\},
                        \]
                        <p> missä
                            \(\vp \in \R^n\) ja \(\vv \in \R^n \setminus \{\nv\}\). Vektoria \(\vp\) kutsutaan suoran <strong>paikkavektoriksi</strong> ja vektoria \(\vv\) suoran <strong>suuntavektoriksi</strong>.</p>
                    </div>
                </div>
                <p>
                    Olkoon \(S\) avaruuden \(\R^2\) suora. Jos \((a,b) \in S\), niin sanotaan, että piste \((a,b)\) <strong>on suoralla \(S\)</strong> tai että suora \(S\) <strong>kulkee pisteen \((a,b)\) kautta</strong>. Vastaavia ilmauksia käytetään avaruudessa \(\R^n\).
                </p>
                <p>    <strong>Huom.</strong> Yllä ei ole annettu mitä tahansa suoran kuvailua, vaan suoran <strong>määritelmä</strong>. Emme siis ole lähteneet esimerkiksi jostakin suoran geometrisestä muotoilusta ja ilmaisseet saman asian vektoreilla, vaan määritelleet suoran käsitteen tämän kurssin tarpeita varten uudelleen.

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto"><!-- <!-- \label{suoraEsim} -->
                        <p>
                            Esimerkiksi joukko</p>
                        \[
                        S=\{(-1,2)+t(-2,-1) \mid t \in \R\}
                        \]
                        <p>on suora. Se on piirretty kuvaan  alla <!-- alla <!-- \ref{k-->24} -->. Määritelmän mukaan mikä tahansa suoran \(S\) piste voidaan kirjoittaa summana vektorista \(\vp = (-1,2)\) ja jostakin vektorin \(\vv = (-2,-1)\) skalaarimonikerrasta. Esimerkiksi \((-5,0)=\vp+2\vv\) ja \((3,4)=\vp-2\vv\), joten \((-5,0) \in S\) ja \((3,4) \in S\).
                            Siis suora \(S\) kulkee pisteiden \((-5,0)\) ja \((3,4)\) kautta.
                        </p><p>
                            Toisaalta piste \((4,2)\) ei ole suoralla \(S\). Jos nimittäin \((4,2)=(-1,2)+t(-2,-1)\) jollakin \(t \in
                            \R\), niin \(4=-1-2t\) ja \(2=2-t\). Ensimmäisen yhtälön perusteella \(t=-5/2\) ja toisen perusteella
                            \(t=0\). Tämä on mahdotonta, joten ei ole olemassa sellaista lukua \(t \in \R\), jolle pätee \((4,2)=(-1,2)+t(-2,-1)\). Siispä \((4,2) \notin S\).
                        </p>

                        <div class="image">

                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva24.png" />
                            <p><strong>Kuva: </strong>Suora \(S=\{(-1,2)+t(-2,-1) \mid t \in \R\}\) avaruudessa \(\R^2\). Suoran paikkavektori on \((-1,2)\) ja suuntavektori \((-2,-1)\).</p><!-- <!-- \label{k24} -->
                        </div>
                    </div>
                </div>
                <p>
                    Ryhdytään seuraavaksi määrittämään suoraa, joka kulkee annettujen pisteiden
                    kautta. Sitä ennen otetaan käyttöön muutama merkintä. Oletetaan, että \(A\) ja \(B\) ovat avaruuden \(\R^2\) tai \(\R^3\) pisteitä. Vektori \(\pv{AB}\) on vektori, jota vastaavan suuntajanan alkupiste on \(A\) ja päätepiste on \(B\) (ks. kuva alla <!-- alla <!-- \ref{k-->65} -->). Origoa on tapana merkitä kirjaimella \(O\). Siten
                    pisteen \(A\) paikkavektorille saadaan merkintä \(\pv{OA}\).
                </p>
                <div class="image">

                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva65.png" />
                    <p><strong>Kuva: </strong>Vektorit \(\pv{OA}\), \(\pv{OB}\) ja \(\pv{AB}\).</p><!-- <!-- \label{k65} -->
                </div>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>
                            Tutkitaan, millainen on pisteiden \(A=(-1,5)\) ja \(B=(2,2)\) kautta kulkeva suora.
                            Tätä varten tarvitaan suoralle paikkavektori. Paikkavektoriksi käy minkä
                            tahansa suoran pisteen paikkavektori, esimerkiksi vektori \(\pv{OA}=(-1,5)\).
                            Suuntavektoriksi käy mikä tahansa suoran suuntainen vektori, esimerkiksi vektori</p>
                        \[
                        \pv{AB}=\pv{OB}-\pv{OA}=(2,2)-(-1,5)=(3,-3).
                        \]
                        <p>Näin saadaan suora \(\{(-1,5)+t(3,-3) \mid t \in \R\}\).
                        </p>
                        <div class="image">

                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva68.png" />
                            <p><strong>Kuva: </strong>Suora \(\{(-1,5)+t(3,-3) \mid t \in \R\}\).</p><!-- <!-- \label{k68} -->
                        </div>
                        <p>
                            Varmistutaan vielä siitä, että annetut pisteet \(A\) ja \(B\) todellakin ovat suoralla.
                            Huomataan, että \((-1,5)=(-1,5)+0\cdot (3,-3)\) ja \((2,2)=(-1,5)+(3,-3)\). Siten
                            pisteet \(A\) ja \(B\) ovat suoralla.
                        </p><p>
                            Vastaavalla menetelmällä on aina mahdollista määrittää kahden pisteen kautta kulkeva suora, vaikka asiaa ei sen tarkemmin tässä osoitetakaan.
                        </p>
                    </div>
                </div>
                <p>
                    Suoran paikka- ja suuntavektorit eivät ole yksikäsitteisiä, sillä sama suora voidaan kirjoittaa joukkona \(\{\vp+t\vv \mid t \in \R\}\) usealla eri tavalla. Itse asiassa on mahdollista osoittaa, että
                <ul>
                    <li>  vektoriksi \(\vp\) voidaan valita suoran minkä tahansa pisteen paikkavektori
                    <li>  vektoriksi \(\vv\) voidaan valita mikä tahansa suoran suuntainen vektori.
                </ul>
                <p>Tutkitaan ilmiötä esimerkin avulla, ennen kuin todistetaan väitteet.
                    <!-- Väitteitä ei todisteta tässä; todistukset voi halutessaan laatia hieman haastavampana harjoitustehtävänä. -->
                </p>
                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>
                            Edellisen esimerkin <!--Esimerkin \ref{suoraEsim} --> suoralle \(S=\{(-1,2)+t(-2,-1) \mid t \in \R\}\) on mahdollista
                            valita paikkavektoriksi piste \((3,4)\) ja suuntavektoriksi vektori \((-4,-2)\). Tällöin \(S\) voidaan kirjoittaa muodossa
                            \[
                            \{(3,4)+s(-4,-2) \mid s \in \R\}.
                            \]
                            Vaikka tämä joukko onkin äkkiseltään katsottuna erilainen kuin suoran \(S\) alkuperäinen määritelmä, on joukoissa täsmälleen samat alkiot. Asiaa on havainnollistettu kuvassa  alla <!-- alla <!-- \ref{k-->66-67} -->.
                        </p>
                        <div class="image">

                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva67.png" /> 
                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva66.png" />
                            <p><strong>Kuva: </strong>Suoran paikkavektori ja suuntavektori eivät ole yksikäsitteisiä.</p><!-- <!-- \label{k66-67} -->
                        </div>
                        <p>
                            Kuvasta katsominen ei vielä todista suoria samoiksi.
                            Osoitetaan huolellisesti, että joukot \(S=\{(-1,2)+t(-2,-1) \mid t \in \R\}\) ja \(S'=\{(3,4)+s(-4,-2) \mid s \in \R\}\) ovat samat. Kaksi joukkoa osoitetaan samoiksi näyttämällä, että kumpikin on toisen osajoukko.
                        </p><p>
                            ''\(\subset\)'': Osoitetaan ensin, että \(S \subset S'\). Tämä tehdään näyttämällä, että jokainen joukon \(S\) alkio on joukossa \(S'\). Oletetaan, että \(\va \in S\). Tällöin joukon \(S\) määritelmän perusteella pätee \(\va=(-1,2)+t(-2,-1)\) jollakin \(t \in \R\). On osoitettava, että \(\va \in S'\). Tavoitteena on siis kirjoittaa vektori \(\va=(-1,2)+t(-2,-1)\) muodossa \((3,4)+ s(-4,-2)\), missä \(s\) on jokin reaaliluku. Ryhdytään muokkaamaan vektoria \(\va\) haluttuun muotoon. Huomataan, että</p>
                        \[
                        \begin{split}
                        \va & =(-1,2)+t(-2,-1)=(3,4)+(-4,-2)+t(-2,-1) \\
                        & =(3,4)+2(-2,-1)+t(-2,-1)=(3,4)+(2+t)(-2,-1)\\
                        & =(3,4)+ \frac{2+t}{2}(-4,-2).
                        \end{split}
                        \]
                        <p>Koska \((2+t)/2 \in \R\), viimeisestä muodosta nähdään, että \(\va \in S'\). (Joukon \(S'\) määritelmässä voidaan valita \(s=(2+t)/2\).) On siis osoitettu, että \(S \subset S'\).
                        </p><p>
                            ''\(\supset\)'': Osoitetaan sitten, että \(S' \subset S\), eli näytetään, että jokainen joukon \(S'\) alkio on joukossa \(S\). Oletetaan, että \(\va \in S'\). Nyt \(\va=(3,4)+s(-4,-2)\) jollakin \(s \in \R\). On osoitettava, että \(\va \in S\). Tavoitteena on siis kirjoittaa vektori \(\va\) muodossa \((-1,2)+t(-2,-1)\), missä \(t\) on jokin reaaliluku. Huomataan, että</p>
                        \[
                        \begin{split}
                        \va & =(3,4)+s(-4,-2)=(-1,2)+(4,2)+s(-4,-2)\\
                        &=(-1,2)+(-1)(-4,-2)+s(-4,-2)=(-1,2)+(-1+s)(-4,-2) \\
                        &=(-1,2)+2(-1+s)(-2,-1) =(-1,2)+(-2+2s)(-2,-1).
                        \end{split}\]
                        <p>Koska \(-2+2s\in\R\), tiedetään, että \(\va \in S\). Näin on osoitettu, että \(S' \subset S\).</p>
                    </div>
                </div>

                <p>Osoitetaan sitten yleisessä tapauksessa, että paikkavektoriksi voidaan valita suoran minkä tahansa pisteen paikkavektori
                    ja suuntavektoriksi mikä tahansa suoran suuntainen vektori. Todistus mukailee edellistä esimerkkiä.</p>
                <div class="lause">
                    <h3>Lause</h3>
                    <p> Olkoon \(S=\{\vp+t\vv \mid t \in \R\}\) avaruuden \(\R^n\) suora.  Oletetaan, että \(\vq \in S\) ja \(\vw\) on yhdensuuntainen vektorin \(\vv\) kanssa. Tällöin \(S=\{\vq+t\vw \mid t \in \R\}\)</p>


                    <div class="proof drop">
                        <h4 class="otsikko">Todistus</h4>
                        <div class="sisalto">
                            <p>Merkitään \(S'=\{\vq+t\vw \mid t \in \R\}\) ja osoitetaan, että \(S=S'\). Koska vektorit \(\vv\) ja \(\vw\) ovat yhdensuuntaisia, on olemassa \(k \in \R \setminus\{0\}\), jolle pätee \(\vv=k\vw\). Tästä seuraa, että \(\vw=(1/k)\vv\). Toisaalta \(\vq \in S\), joten \(\vq=\vp+b\vw\) jollakin \(b \in \R\). Tästä seuraa, että \(\vp=\vq-b\vw\)
                            </p>
                            <p>''\(\subset\)'':  Oletetaan, että \(\va \in S\). Joukon \(S\) määritelmän perusteella \(\va=\vp+t\vv\) jollakin \(t \in \R\). Huomataan, että</p>
                            \[
                            \begin{split}
                            \va & =\vp+t\vv=\vq-b\vw+t(k\vw)\\
                            & =\vq-b\vw+(tk)\vw=\vq+(-b+tk)\vw \in S'
                            \end{split}
                            \]
                            <p>On siis osoitettu, jokainen joukon \(S\) alkio on joukossa \(S'\). Toisin sanoen \(S \subset S'\).</p>

                            <p>''\(\supset\)'': Oletetaan, että \(\va \in S'\). Nyt \(\va=\vq+t\vw\) jollakin \(t \in \R\). Huomataan, että</p>
                            \[
                            \begin{split}
                            \va & =\vq+t\vw=\vp+b\vw+t((1/k)\vv) \\
                            & =\vp+b\vw+(t/k)\vv=\vp+(b+t/k)\vv \in S.
                            \end{split}\]
                            Näin on osoitettu, että \(S' \subset S\).

                            Siten \(S=S'\).
                        </div>
                    </div>
                </div>
                <h2 class="header">Taso</h2>

                <p>Kolmiulotteisessa avaruudessa voidaan määritellä tasot samaan tapaan kuin suorat. Nyt tarvitaan kuitenkin kahta suuntavektoria, ja näiden täytyy olla erisuuntaiset.</p>

                <div class="maar">
                    <h3 class="otsikko">Määritelmä</h3>
                    <div class="sisalto">
                        <p>Avaruuden \(\R^n\) <strong>taso</strong> on joukko</p>
                        \[
                        \{\vp+s\vv+t\vw \mid s,t \in \R\},
                        \] 
                        <p>missä \(\vp \in \R^n\), \(\vv,\vw \in \R^n \setminus \{\nv\}\) ja vektorit \(\vv\) ja \(\vw\)
                            eivät ole yhdensuuntaiset. Vektoria \(\vp\) kutsutaan tason <strong>paikkavektoriksi</strong> ja vektoreita \(\vv\) ja
                            \(\vw\) tason <strong>suunta\-vektoreiksi</strong>.</p>
                    </div>
                </div>

                <p>Olkoon \(T\) avaruuden \(\R^3\) taso. Jos \((a,b,c) \in T\), niin sanotaan, että piste
                    \((a,b,c)\) <strong>on tasossa \(T\)</strong> tai että taso \(T\) <strong>kulkee pisteen \((a,b,c)\) kautta</strong>. Tasoa ja siinä olevaa pistettä on havainnollistettu kuvassa  alla <!-- alla <!-- \ref{k-->28 -->}. Vastaavia ilmauksia käytetään avaruudessa \(\R^n\).</p>

                <div class="image">

                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva28.png" />
                    <p><strong>Kuva: </strong>Piste \((a,b,c)\) on tasossa \(T\).</p><!-- <!-- \label{k28} -->
                </div>

                <p>Kuten suorien kohdalla voidaan tasojenkin tapauksessa osoittaa, että sama taso on mahdollista kirjoittaa usealla eri tavalla joukkona \(\{\vp+s\vw + t\vv \mid s, t \in \R\}\). Tarkemmin sanoen</p>
                <ul>
                    <li>  vektoriksi \(\vp\) voidaan valita tason minkä tahansa pisteen paikkavektori
                    <li>  vektoreiksi  \(\vw\) ja \(\vv\) voidaan valita mitkä tahansa tason suuntaisen vektorit, kunhan \(\vw\) ja \(\vv\) eivät ole yhdensuuntaiset.
                </ul>
                <p>Tilannetta on havainnollistettu kuvassa  alla <!-- alla <!-- \ref{k-->28b-29} -->. Todistus on samanlainen kuin suorien tapauksessa, mutta sitä ei esitetä tässä.</p>
                <!-- Tarkka todistus jätetään jälleen (haastavaksi) harjoitustehtäväksi. -->

                <div class="image">

                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva28b.png" /> 
                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva29.png" />
                    <p><strong>Kuva: </strong>Taso voidaan kirjoittaa eri tavoin joukkona \(\{\vp+s\vw + t\vv \mid s, t \in \R\}\).</p><!-- <!-- \label{k28b-29} -->
                </div>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Määritetään pisteiden \(A = (0,1,0)\), \(B = (-1,3,2)\) ja \(C = (-2,0,1)\) kautta kulkeva taso \(T\).
                            Valitaan ensin tason paikkavektori. Esimerkiksi tason pisteen \(A\) paikkavektori \(\pv{OA} = (0,1,0)\) käy tähän tarkoitukseen.
                            Lisäksi tarvitaan tason suuntaiset suuntavektorit:</p>
                        \[
                        \pv{AB}=\pv{OB}-\pv{OA}=(-1,2,2)  \text{ja} 
                        \pv{AC}=\pv{OC}-\pv{OA}=(-2,-1,1).
                        \]
                        <p>Huomaa, että vektorit eivät ole yhdensuuntaiset, sillä \(\pv{AB} \neq r \pv{AC}\) kaikilla nollasta poikkeavilla reaaliluvuilla \(r\). (Tämä pitäisi tietysti todistaa täsmällisesti, mutta sivuutamme sen.)
                            Näin saadaan taso</p>
                        \[
                        \begin{split}
                        T & = \bigl\{\pv{OA} + s\pv{AB} + t\pv{AC} \mid s,t \in \R\bigr\} \\
                        & = \{(0,1,0)+ s(-1,2,2)+ t(-2,-1,1) \mid s,t \in \R\}.
                        \end{split}
                        \]
                    </div>
                </div>
            </div>
        </section>


        <section class="kappaleraja" id="4">
            <div div class="kappaleraja-linis" id="Avaruuden \(\R^n\)aliavaruudet" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                <h1>Avaruuden \(\R^n\)aliavaruudet</h1>

                <p>Edellisessä luvussa käsittelimme suoria ja tasoja. Osoittautuu, että erityisesti origon kautta kulkevat suorat ja tasot ovat lineaarialgebran kannalta mielenkiintoisia. Ne ovat niin kutsuttuja aliavaruuksia.
                    <!-- %Tässä luvussa yleistämme tällaiset suorat ja tasot avaruuteen \(\R^n\)ja tutkimme niin kutsuttuja aliavaruuksia. -->

                </p>
                <p>
                    Esimerkiksi avaruuden \(\R^2\)suora \(S=\{\nv+a(-3,1) \mid a \in \R\}\)kulkee origon kautta. Sen voi kirjoittaa muodossa</p>
                \[
                S=\{a(-3,1) \mid a \in \R\}.
                \]
                <p>    Suora \(S\)koostuu siis vektorin \(\vv=(-3,1)\)monikerroista. Sanotaan, että suora \(S\)on vektorin \((-3,1)\)virittämä.
                </p>
                <p>
                    Avaruuden \(\R^3\)origon kautta kulkeva taso \(T=\{\nv+a_1(-3,1,2)+a_2(2,2,0) \mid a_1,a_2 \in \R\}\)voidaan kirjoittaa muodossa</p>
                \[
                T=\{a_1(-3,1,2)+a_2(2,2,0) \mid a_1,a_2 \in \R\}.
                \]
                <p>   Taso \(T\)koostuu siis vektorien \(\vv_1=(-3,1,2)\)ja \(\vv_2=(2,2,0)\)kaikista mahdollisista lineaarikombinaatioista. Sanotaan, että taso \(T\)on vektorien \((-3,1,2)\)ja \((2,2,0)\)virittämä.
                </p>
                <div class="maar">
                    <h3>Määritelmä</h3>
                    <p> Vektoreiden \(\vv_1,\dots,\vv_k \in \R^n\) virittämä <strong>aliavaruus</strong></p><!-- \index{aliavaruus</strong> --><!-- \index{vektoreiden virittämä aliavaruus} --><!-- \index{virittäminen} --> on joukko
                    \[
                    \vir(\vv_1,\dots,\vv_k)=\{a_1\vv_1+a_2\vv_2+\dots +a_k\vv_k \mid a_1,a_2,\dots,a_k \in \R\}.
                    \]
                    }

                    <p>  Vektoreiden virittämä aliavaruus koostuu siis kaikista kyseisten vektoreiden
                        lineaarikombinaatioista.
                        <!-- %Jos ei olla kiinnostuneita siitä, mitkä vektorit aliavaruuden virittävät, voidaan puhua vain --> <!-- %aliavaruudesta ottamatta kantaa siihen, mitkä virittäjät ovat. -->
                        Englannin kielen verbi ''span'' tarkoittaa virittämistä tai ulottamista.
                    </p><p>
                        Edellä käsitelty suora \(S\)voidaan nyt kirjoittaa käyttäen uutta merkintää:</p>
                    \[
                    \{a(-3,1) \mid a \in \R\}=\vir((-3,1)).
                    \]
                    <p>    Samaan tapaan voidaan kirjoittaa taso \(T\):</p>
                    \[
                    \{a_1(-3,1,2)+a_2(2,2,0) \mid a_1,a_2 \in \R\}=\vir((-3,1,2),(2,2,0)).
                    \]

                    <!-- %<div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> -->
                    <!-- %Esimerkiksi avaruuden \(\R^2\)suora -->
                    <!-- %\[ -->
                    <!-- %S=\{\nv+t(-3,1) \mid t \in \R\}=\{t(-3,1) \mid t \in \R\} -->
                    <!-- %\] -->
                    <!-- %on vektorin \((-3,1)\)virittämä aliavaruus, eli \(S=\vir\bigl((-3,1)\bigr)\). Avaruuden -->
                    <!-- %\(\R^3\)taso -->
                    <!-- %\[ -->
                    <!-- %T=\{\nv+t(-3,1,2)+s(2,2,0) \mid t,s \in \R\}=\{t(-3,1,2)+s(2,2,0) \mid t,s \in \R\} -->
                    <!-- %\] -->
                    <!-- %taas on vektorien -->
                    <!-- %\)(-3,1,2)\)ja \((2,2,0)\)virittämä aliavaruus, joten voidaan merkitä \(T=\vir\bigl((-3,1,2), --><!-- %(2,2,0)\bigr)\). -->
                    <!-- %</div></div> -->

                    <div class="esim drop">
                        <h3 class="otsikko">Esimerkki</h3>
                        <div class="sisalto">
                            <p>   Tutkitaan hieman, millaisia aliavaruuksia voidaan virittää avaruuksissa \(\R^2\)ja \(\R^3\).
                                Nollavektorin virittämä aliavaruus on \(\vir(\nv)=\{a \cdot \nv \mid a \in \R\}=\{\nv\}\). Aliavaruudessa on siis ainoastaan nollavektori.
                            </p><p>
                                Oletetaan sitten, että \(\vv \in \R^2 \setminus \{\nv\}\) tai \(\vv \in \R^3  \setminus \{\nv\}\). Tällöin vektorin \(\vv\) virittämä aliavaruus \(\vir(\vv)=\{a\vv \mid a\ \in \R\}\) on vektorin \(\vv\) suuntainen suora. Tämän suoran paikkavektori on nollavektori, joten suora kulkee origon kautta.
                            </p><p>
                                Jos taas \(\vv\), \(\vw \in \R^3 \setminus \{\nv\}\) ja \(\vv\) ja \(\vw\) eivät ole
                                yhdensuuntaisia, vektorien \(\vv\) ja \(\vw\) virittämä aliavaruus
                                \(\vir(\vv,\vw)=\{s\vv+t\vw \mid s,t\ \in \R\}\) on taso, joka kulkee origon
                                kautta.
                            </p><p>
                                Myös koko avaruus \(\R^3\)on eräiden vektoreiden virittämä aliavaruus:</p>
                            \[
                            \begin{align*}
                            \vir((1,0,0),(0,1,0),(0,0,1))&=\{a_1(1,0,0)+a_2(0,1,0),a_3(0,0,1) \mid a_1,a_2,a_3 \in \R\}\\
                            &=\{(a_1,a_2,a_3) \mid a_1,a_2,a_3 \in \R\}=\R^3.
                            \end{align*}
                            \]
                            <p>      Tulemme näkemään, että avaruudelle \(\R^3\)löytyy monia muitakin virittäjävektoreita kuin \((1,0,0)\), \((0,1,0)\)ja \((0,0,1)\).
                            </p>
                        </div></div>

                    <div class="image">

                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva41.png" /> 
                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva40.png" /> 
                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva42.png" />
                        <strong>Kuva: </strong>Nollavektorin virittämä aliavaruus on \(\{\nv\}\). Vektorin \(\vv \neq \nv\) virittämä aliavaruus on origon kautta kulkeva suora. Kahden vektorin virittämä aliavaruus voi olla origon kautta kulkeva taso.<!-- \label{k42} -->
                    </div>

                    <p> Aliavaruus yleistää siis origon kautta kulkevan suoran ja
                        tason käsitteitä. Seuraava esimerkki osoittaa, miksi juuri origon kautta kulkevat suorat ja tasot ovat erityisen kiinnostavia.</p>
                    <div class="esim drop">
                        <h3 class="otsikko">Esimerkki</h3>
                        <div class="sisalto">
                            <p> Tarkastellaan origon kautta kulkevaa suoraa</p>
                            \[
                            S=\vir(\vv)=\{t\vv \mid t \in \R\},
                            \]
                            <p>   missä \(\vv \in \R^2 \setminus \{\nv\}\).
                                Jos \(\vw\), \(\vu \in S\), niin \(\vw=a\vv\) ja \(\vu=b\vv\) joillakin \(a\), \(b
                                \in \R\). Nyt \(\vw+\vu=(a+b)\vv\), joten summa \(\vw + \vu\) on suoran \(S\) alkio. Lisäksi jos \(c \in \R\), niin
                                \)c\vw=c(a\vv)=(ca)\vv\). Siten kaikkien suoran \(S\) alkioiden
                                skalaarimonikerrat ovat edelleen suoran \(S\)alkioita. Tavallaan suora \(S\)on oma
                                pieni avaruutensa avaruuden \(\R^2\) sisässä, ja siellä voidaan laskea vektoreita yhteen
                                ja kertoa niitä reaaliluvuilla. Sama pätee origon kautta kulkeviin tasoihin.
                            </p><p>
                                Tilanne on aivan toinen, jos suora tai taso ei kulje origon kautta. Tutkitaan
                                vaikkapa esimerkin \ref{suoraEsim} suoraa</p>
                            \[
                            S=\{(-1,2)+t(-2,-1) \mid t \in \R\}.
                            \]
                            <p> Nyt esimerkiksi \((-1,2)\) ja \((-3,1)\) ovat suoralla \(S\). Summa
                                \((-1,2)+(-3,1)=(-4,3)\) ei kuitenkaan ole suoralla \(S\)(ks. kuva alla <!-- \ref{k74} -->). Myöskään
                                skalaarimonikerta \(2 \cdot (-1,2) = (-2,4)\) ei ole suoralla \(S\).
                            </p>
                            <div class="image">

                                <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva74.png" />
                                <strong>Kuva: </strong>Esimerkin \ref{suoraEsim} suora \(S\), joka ei ole aliavaruus.<!-- \label{k74} -->
                            </div>
                        </div>
                    </div>
                    <p>
                        Edellä tehdyt havainnot voidaan yleistää minkä tahansa vektoreiden virittämälle
                        aliavaruudelle. Jos aliavaruuden kaksi vektoria lasketaan yhteen, on summa
                        edelleen aliavaruudessa. Samoin aliavaruuden vektoreiden skalaarimonikerrat
                        ovat aliavaruudessa. Lisäksi nollavektori kuuluu aina aliavaruuteen.
                    </p>
                    <div class="lause">
                        <h3>Lause</h3> <!-- \label{avaruudenRnAliavaruusLause} -->
                        <p>      Oletetaan, että \(\vv_1, \vv_2, \dots, \vv_k \in \R^n\). Olkoon
                            \)W=\vir(\vv_1, \ldots, \vv_k)\). Tällöin seuraavat väitteet pätevät:</p>
                        <ol><!-- \begin{aakkosta*} -->
                            <li> Jos \(\vu\), \(\vw \in W\), niin \(\vu + \vw \in W\).</li>
                            <li> Jos \(\vw \in W\)ja \(c \in \R\), niin \(c\vw \in W\).</li>
                            <li> \(\nv \in W\).</li>
                        </ol><!-- \end{aakkosta*} -->


                        <div class="todistus drop">
                            <h4 class="otsikko">Todistus</h4>
                            <p>   Osoitetaan kohta a) ja jätetään loput kohdat harjoitustehtäviksi. Oletetaan,
                                että \(\vu, \vw \in W\). Nyt \(\vu=a_1\vv_1+\cdots+a_k\vv_k\) joillakin
                                \(a_1,\dots,a_k \in \R\)ja \(\vw=b_1\vv_1+\cdots+b_k\vv_k\) joillakin
                                \(b_1,\dots,b_k \in \R\). Osoitetaan, että summa \(\vu+\vw\) on aliavaruuden \(W\) alkio. Huomataan, että</p>
                            \[
                            \begin{split}
                            \vu+\vw & =(a_1\vv_1+\cdots+a_k\vv_k)+(b_1\vv_1+\cdots+b_k\vv_k) \\
                            & =(a_1+b_1)\vv_1+\cdots+(a_k+b_k)\vv_k.
                            \end{split}
                            \]
                            <p>  Koska \(\vu+\vw\)on vektoreiden \(\vv_1, \vv_2, \dots, \vv_k\)lineaarikombinaatio, pätee \(\vu+\vw \in W\).</p>
                        </div>
                    </div>

                    <div class="esim drop">
                        <h3 class="otsikko">Esimerkki</h3>
                        <div class="sisalto">
                            <p>       Tutkitaan, kuuluuko vektori \(\vw=(-2,3,2,-1)\)vektoreiden</p>
                            \[
                            \vv_1=(0,-1,2,1),  \vv_2=(2,0,1,-1)  \text{ja}  \vv_3=(4,2,2,0)
                            \]
                            <p> virittämään aliavaruuteen \(\vir(\vv_1,\vv_2,\vv_3)\). On siis selvitettävä, onko olemassa reaalilukuja \(x_1,x_2,x_3\), joille pätee</p>
                            \[
                            x_1\vv_1+x_2\vv_2+x_3\vv_3=\vw.
                            \]
                            <p>   Toisin sanoen on pääteltävä, onko \(\vw\)vektoreiden \(\vv_1\), \(\vv_2\)ja \(\vv_3\)lineaarikombinaatio.
                            </p>
                            <p>   Sijoittamalla annetut vektorit yllä olevaan yhtälöön saadaan</p>
                            \[
                            x_1(0,-1,2,1)+x_2(2,0,1,-1)+x_3(4,2,2,0)=(-2,3,2,-1)
                            \]
                            <p>    ja laskemalla kerto- ja yhteenlaskut auki yhtälö voidaan vielä muuttaa muotoon</p>
                            <!-- % \[(0,-x_1,2x_1,x_1)+(2x_2,0,x_2,-x_2)+(4x_3,2x_3,2x_3,0)=(-2,3,2,-1)\] -->
                            <!-- % ja edelleen yhtälöksi -->
                            \[
                            (2x_2+4x_3, \; -x_1+2x_3, \; 2x_1+x_2+2x_3, \; x_1-x_2)=(-2,3,2,-1).
                            \]
                            <p>      Kun tarkastellaan jokaista komponenttia erikseen, saatua vektoriyhtälöä vastaa yhtälöryhmä</p>
                            \[
                            \left\{
                            \begin{array}{rcr}
                            2x_2+4x_3 & = & -2 \\
                            -x_1\hphantom{{}+x_2}+2x_3 & = & 3 \\
                            2x_1+x_2+2x_3 & = & 2 \\
                            x_1-x_2\hphantom{{}+2x_3} & = & -1
                            \end{array}\right.
                            \]
                            <p>    Miten tällainen yhtälöryhmä ratkaistaan?
                                Ennen kuin syvennymme enemmän vektoreiden virittämiin aliavaruuksiin, on syytä
                                perehtyä yhtälöryhmien ratkaisemiseen.</p>
                        </div>
                    </div>

                </div>
        </section>
        <section class="kappaleraja" id="5">
            <div div class="kappaleraja-linis" id="Lineaariset yhtälöryhmät" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                <h1>Lineaariset yhtälöryhmät</h1>

                <p>Edellisen luvun lopun esimerkissä päädyttiin yhtälöryhmään, jonka ratkaisemisesta riippui, kuuluuko tietty vektori eräiden toisten vektorien virittämään aliavaruuteen. Tämäntyyppisiä tilanteita esiintyy lineaarialgebrassa jatkuvasti, ja kysymykset voivat olla hyvin monimuotoisia. Esimerkiksi mainitussa esimerkissä ei itse asiassa tarvittu yhtälöryhmän varsinaista ratkaisua, vaan oli ainoastaan osoitettava sen <strong>olemassaolo</strong>. Toisissa kysymyksissä olennaista saattaa olla, onko mahdollisia ratkaisuja yksi vai useampia. Joidenkin yhtälöryhmien kohdalla haluamme selvittää, minkälaisen aliavaruuden ratkaisut muodostavat.
                </p>
                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto"> 
                        <p>Tarkastellaan yhtälöryhmää</p>
                        \[
                        \left\{
                        \begin{aligned}
                        3x+2y+z & =1 \\
                        -x+2y\hphantom{{}+x} & =-1 \\
                        2x+4y+z & = 0
                        \end{aligned}\right.
                        \]
                        <p>Kysymyksessä on niin sanottu lineaarinen yhtälöryhmä, koska yhtälöt ovat kaikki ensimmäisen asteen yhtälöitä. Yritetään ratkaista yhtälöryhmä eli löytää sellaiset luvut \(x\), \(y\)ja \(z\), että kaikki ryhmän yhtälöt toteutuvat yhtä aikaa.
                        </p>

                        <p>                                        Aloitetaan ratkaisemalla toisesta yhtälöstä \(x\):</p>
                        \[
                        -x+2y=-1 \iff x=2y+1.
                        \]
                        <p> Sijoitetaan sitten saatu \(x\)ensimmäiseen yhtälöön, ja ratkaistaan \(z\):</p>
                        \[
                        3(2y+1)+2y+z=1 \iff 6y+3+2y+z=1 \iff z=-8y-2.
                        \]
                        <p>Sijoitetaan sitten sekä \(x\)että \(z\)kolmanteen yhtälöön, jotta voitaisiin ratkaista \(y\):</p>
                        \[
                        2(2y+1)+4y-8y-2=0 \iff 4y+2+4y-8y-2=0 \iff 0=0.
                        \]

                        <p> Päädyttiin tulokseen \(0=0\). Miten tämä pitäisi tulkita? Onko ratkaisuja yksi vai useampia? Päteekö yhtälö ehkä kaikilla luvuilla? Selvästihän \(x\)ja \(z\)kuitenkin riippuvat \(y\):stä, koska ne ratkaistiin yllä \(y\):n lausekkeina. Mutta samalla tavoinhan \(y\):n voitaisiin ajatella riippuvan \(x\):stä ja \(z\):sta. Vai olisiko sijoitus pitänyt tehdä jossain toisessa järjestyksessä?
                        </p>
                    </div>
                </div>

                <p>Esimerkki osoittaa, että yhtälöryhmien monimutkaistuessa tarvitaan jokin järjestelmällinen menetelmä, jota käyttämällä sekä saadaan aina varmasti jokin vastaus että pystytään tulkitsemaan vastauksen merkitys. Tässä luvussa esiteltävä Gaussin--Jordanin eliminointimenetelmä redusoi minkä tahansa lineaarisen yhtälöryhmän sellaiseen muotoon, että kaikkiin (ainakin tällä kurssilla tarvittaviin) kysymyksiin voidaan helposti antaa vastaus.
                </p>
                <h2>Lineaarisen yhtälöryhmän määritelmä</h2>

                <p><strong>Lineaarinen yhtälöryhmä</strong><!-- \index{lineaarinen yhtälöryhmä} --><!-- \index{yhtälöryhmä} on yhtälöryhmä, joka on muotoa -->
                </p>
                \[
                \begin{equation*}
                \left\{
                \begin{array}{rcrcccrcr}
                a_{11}x_1&+&a_{12}x_2&+&\cdots&+&a_{1n}x_n&=&b_1 \\
                a_{21}x_1&+&a_{22}x_2&+&\cdots&+&a_{2n}x_n&=&b_2 \\
                &&&&&&&\vdots & \\
                a_{m1}x_1&+&a_{m2}x_2&+&\cdots&+&a_{mn}x_n&=&b_m \\
                \end{array}
                \right.
                \begin{equation*}
                \]
                <p>missä \(a_{11},\dots,a_{mn},b_1,\dots,b_m \in \R\).
                    Symbolit \(x_1,x_2,\dots,x_n\) ovat yhtälöiden <strong>tuntemattomia</strong><!-- \index{tuntematon} -->.
                    Lukuja \(a_{11},\dots,a_{mn}\)nimitetään yhtälöryhmän <strong>kertoimiksi</strong> ja lukuja \(b_1,b_2,\dots,b_m\) <strong>vakioiksi</strong>.
                    Jos tuntemattomia on vähän, niitä merkitään yleensä symboleilla \(x,y,z\)ja niin
                    edelleen.</p>

                <p>Esimerkiksi</p>
                \[
                \begin{equation*}<!-- \label{yhtaloryhmaEsim} -->
                \left\{
                \begin{array}{rcrcrcr}
                -4x_1&+&\sqrt{3}x_2&+&2x_3&=&4 \\
                x_1&&&+&\frac{6}{8}x_3&=&0 \\
                5x_1&+&\sqrt{2}x_2&+&11x_3&=&-3 \\
                &&-6x_2&-&32x_3&=&4 \\
                \end{array}
                \right.
                \begin{equation*}
                \]
                <p>
                    on lineaarinen yhtälöryhmä.</p>

                <p>Lineaarisen yhtälöryhmän ratkaiseminen merkitsee sitä, että löydetään kaikki ne luvut, jotka tuntemattomien \(x_1,\dots,x_n\)paikalle
                    sijoitettuina toteuttavat yhtä aikaa kaikki yhtälöt.
                </p>

                <p>Lineaarisen yhtälöryhmän ratkaisemisen kannalta oleellista ovat vain kertoimien ja vakioiden arvot, esimerkiksi tuntemattomien nimityksellä ei ole merkitystä. Kaikki tieto
                    yhtälöryhmästä voidaankin tiivistää lukutaulukkoon eli <strong>matriisiin</strong>, jossa
                    luetellaan kaikki kertoimet sekä vakiot. Kun
                    käsitellään yhtälöryhmien sijasta matriiseja, on kirjoitettavaa paljon vähemmän,
                    sillä tuntemattomia ei tarvitse kirjata ylös.</p>

                <p> Esimerkiksi edellä esitellyn yhtälöryhmän matriisi on</p>
                \[
                \begin{bmatrix}[rrr|r]
                -4&\sqrt{3}&2&4 \\
                1&0&\frac{6}{8}&0 \\
                5&\sqrt{2}&11&-3 \\
                0&-6&-32&4
                \end{bmatrix}.
                \]

                <p>Selkeyden vuoksi kertoimet on tapana erottaa vakioista pystyviivalla. Viivalla ei kuitenkaan ole matemaattista merkitystä. Huomaa,
                    että matriisiin on kirjoitettava nolla niiden termien kohdalle, jotka puuttuvat
                    yhtälöryhmästä. Kyseisten termien kertoimena on nimittäin nolla.</p>

                <p> Kappaleessa 8 tutustutaan matriisien teoriaan yleisemmin. Tässä luvussa käsittelemme vain yhtälöryhmistä saatuja
                    matriiseja.</p>

                <h2>Alkeisrivitoimitukset ja porrasmatriisit</h2>

                <p>Seuraavaksi käydään läpi menetelmä, jolla voidaan ratkaista mikä tahansa
                    lineaarinen yhtälöryhmä. Ideana on muokata yhtälöryhmästä uusia yhtälöryhmiä,
                    joilla on samat ratkaisut kuin alkuperäisellä yhtälöryhmällä. Viimeisenä saatu
                    yhtälöryhmä on sellaisessa muodossa, josta sen ratkaisuja koskeviin kysymyksiin on helppo vastata. Koska viimeisen yhtälöryhmän ratkaisut ovat samat kuin alkuperäisen yhtälöryhmän, myös alkuperäisen yhtälöryhmän ratkaisut ja niiden luonne tunnetaan.
                </p>

                <div class="maar">
                    <h3>Määritelmä</h3>
                    <p>Yhtälöryhmiä kutsutaan <strong>ekvivalenteiksi</strong><!-- \index{ekvivalentit yhtälöryhmät} -->, jos niillä on täsmälleen samat
                        ratkaisut.</p>
                </div>

                <p>Ryhdymme muokkaamaan yhtälöryhmiä niin kutsutuilla alkeisrivitoimituksilla. Niiden avulla tuotetaan uusia yhtälöryhmiä, jotka ovat ekvivalentteja alkuperäisen yhtälöryhmän kanssa. Koska matriisien käsitteleminen on helpompaa kuin yhtälöryhmien, tehdään alkeisrivitoimitukset suoraan matriiseille.
                </p>

                <div class="maar">
                    <h3>Määritelmä</h3>
                    <p>Seuraavat kolme operaatiota ovat <strong>alkeisrivitoimituksia</strong></p><!-- \index{alkeisrivitoimitus} -->:
                    <ol>
                        <li> Vaihdetaan kahden rivin paikka matriisissa.
                        <li> Kerrotaan jokin rivi nollasta poikkeavalla reaaliluvulla.
                        <li> Lisätään johonkin riviin jokin toinen rivi reaaliluvulla kerrottuna.
                    </ol>
                </div>
                <!-- %<div class="maar"><h3>Määritelmä</h3> -->
                <!-- %Seuraavat operaatiot tuottavat uuden yhtälöryhmän, joka on ekvivalentti -->
                <!-- %alkuperäisen yhtälöryhmän kanssa: -->
                <!-- %<ul> -->
                <!-- %<li>[a)] Vaihdetaan kahden rivin paikka. -->
                <!-- %<li>[b)] Kerrotaan jokin rivi nollasta poikkeavalla reaaliluvulla. -->
                <!-- %<li>[c)] Lisätään johonkin riviin toinen rivi nollasta -->
                <!-- %poikkeavalla reaaliluvulla kerrottuna. -->
                <!-- %</ul> -->
                <!-- %Näitä operaatioita kutsutaan <strong>alkeisrivitoimituksiksi}. -->
                <!-- %</div> -->

                <p>  Alkeisrivitoimituksille käytetään tässä materiaalissa seuraavia
                    lyhennysmerkintöjä</p>
                <ul>
                    <li>\(R_i \leftrightarrow R_j\): vaihdetaan rivien \(i\)ja \(j\) paikat (\(i \neq j\().
                    <li>\(aR_i\): kerrotaan rivi \(i\)luvulla \(a \neq 0\).
                    <li>\(R_i+bR_j\): lisätään riviin \(i\)rivi \(j\) luvulla \(b\) kerrottuna (\(i \neq j\().
                </ul>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <!-- %Tutkitaan -->
                        <!-- %matriisin -->
                        <!-- %\[ -->
                        <!-- %\begin{bmatrix}[cc|c] -->
                        <!-- %-4&3&4 \\ -->
                        <!-- %1&0&0 \\ -->
                        <!-- %5&3&-3 \\ -->
                        <!-- %0&-6&4 -->
                        <!-- %\end{bmatrix} -->
                        <!-- %\] -->
                        <!-- %avulla, miltä alkeisrivitoimitukset näyttävät: -->
                        <p>Seuraavassa on annettu esimerkit erilaisista alkeisrivitoimituksista:</p>
                        \[
                        \begin{split}
                        \begin{bmatrix}[rr|r]
                        -4&3&4 \\
                        1&2&-1 \\
                        5&3&2 \\
                        0&6&4
                        \end{bmatrix}
                        \overset{R_1 \leftrightarrow R_2}{\longrightarrow}
                        \begin{bmatrix}[rr|r]
                        1&2&-1 \\
                        -4&3&4 \\
                        5&3&2 \\
                        0&6&4
                        \end{bmatrix}
                        \overset{R_3-5R_1}{\longrightarrow}
                        \begin{bmatrix}[rr|r]
                        1&2&-1 \\
                        -4&3&4 \\
                        0&-7&7 \\
                        0&6&4
                        \end{bmatrix}
                        \overset{-\frac{1}{7}R_3}{\longrightarrow}
                        \begin{bmatrix}[rr|r]
                        1&2&-1 \\
                        -4&3&4 \\
                        0&1&-1 \\
                        0&6&4
                        \end{bmatrix}\\
                        \end{split}
                        \]
                    </div>
                </div>

                <div class="maar">
                    <h3>Määritelmä</h3>
                    <p>Matriisi \(A\) on <strong>riviekvivalentti</strong><!-- \index{riviekvivalentti} --> matriisin \(B\) kanssa, jos \(B\) saadaan
                        matriisista \(A\)alkeisrivitoimituksilla.</p>
                </div>

                <p>Esimerkiksi edellisen esimerkin matriisit</p>
                \[
                \begin{bmatrix}[rr|r]
                -4&3&4 \\
                1&2&-1 \\
                5&3&2 \\
                0&6&4
                \end{bmatrix}
                \text{ja} 
                \begin{bmatrix}[rr|r]
                1&2&-1 \\
                -4&3&4 \\
                0&1&-1 \\
                0&6&4
                \end{bmatrix}
                \]
                <p>ovat riviekvivalentit. Alkeisrivitoimituksia voidaan ajatella tehtävän myös nolla kappaletta. Siten jokainen matriisi on itsensä kanssa riviekvivalentti.
                </p>

                <div class="lause">
                    <h3>Lause</h3> <!-- \label{ekvivalenttiLause} -->
                    <p>Jos yhtälöryhmiä vastaavat matriisit ovat riviekvivalentit, yhtälöryhmät ovat ekvivalentit.</p>


                    <p>Lause voidaan muotoilla myös toisin: jos yhtälöryhmiä vastaavat matriisit ovat riviekvivalentit, yhtälöryhmillä on täsmälleen samat ratkaisut. Alkeisrivitoimituksen tekeminen ei siis muuta yhtälöryhmän ratkaisuja. Lauseen todistus on esitetty luvun lopussa.
                    </p>
                    <div class="image">

                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva75.png" />
                        <strong>Kuva: </strong>Gaussin--Jordanin eliminointimenetelmän perusta.<!-- \label{k75} -->
                    </div>
                </div>

                <p>Yhtälöryhmää ratkaistaessa on tavoitteena muuttaa yhtälöryhmän
                    matriisi alkeisrivitoimituksilla niin kutsutuksi redusoiduksi porrasmatriisiksi,
                    josta ratkaisut on helppo lukea. Määritellään ensin porrasmatriisi.</p>

                <div class="maar"><h3>Määritelmä</h3>
                    <p>Matriisi on <strong>porrasmatriisi</strong><!-- \index{porrasmatriisi} -->, jos seuraavat ehdot toteutuvat:</p>
                    <ol>
                        <li> mahdolliset nollarivit ovat alimpina
                        <li> kullakin rivillä ensimmäinen nollasta poikkeava alkio, ns. <strong>johtava alkio</strong><!-- \index{johtava alkio} -->, on ylemmän rivin johtavan alkion
                            oikealla puolella.
                    </ol>
                </div>

                <p>Esimerkiksi seuraavat matriisit ovat porrasmatriiseja. Niiden johtavat alkiot on lihavoitu.</p>
                \[
                \begin{bmatrix}[rrrr]
                \mathbf{14}&3&2&4 \\
                0&0&\mathbf{8}&0 \\
                0&0&0&\mathbf{-3} \\
                0&0&0&0
                \end{bmatrix} 
                \begin{bmatrix}[rrrrrr]
                0&0&\mathbf{4}&0&0&-3 \\
                0&0&0&\mathbf{-1}&7&-11 \\
                0&0&0&0&\mathbf{1}&-3
                \end{bmatrix} 
                \begin{bmatrix}[rrrrrr]
                \mathbf{-3}&-41&1&0&-3&6 \\
                0&0&0&0&\mathbf{5}&-11 \\
                0&0&0&0&0&0
                \end{bmatrix}
                \]

                <p>Porrasmuoto auttaa jo yhtälöryhmän ratkaisemisessa, mutta se ei ole yksikäsitteinen. Kutakin matriisia kohden löytyy nimittäin useampi kuin yksi sen kanssa riviekvivalentti porrasmatriisi. Porrasmatriisi voidaan kuitenkin muokata alkeisrivitoimitusten avulla redusoituun muotoon, joka on kullekin matriisille yksikäsitteinen.
                </p>

                <div class="maar">
                    <h3>Määritelmä</h3>
                    <p>Matriisi on <strong>redusoitu porrasmatriisi</strong><!-- \index{redusoitu porrasmatriisi} -->, jos seuraavat ehdot toteutuvat:
                    </p>
                    <ol>
                        <li> matriisi on porrasmatriisi
                        <li> jokaisen rivin johtava alkio on 1
                        <li> jokainen johtava alkio on sarakkeensa ainoa nollasta poikkeava alkio.
                    </ol>
                </div>

                <p>Esimerkiksi seuraavat matriisit ovat redusoituja porrasmatriiseja. Johtavat ykköset on jälleen lihavoitu.</p>
                \[
                \begin{bmatrix}[rrrr]
                \mathbf{1}&0&0&4 \\
                0&\mathbf{1}&0&0 \\
                0&0&\mathbf{1}&-3 \\
                0&0&0&0
                \end{bmatrix} 
                \begin{bmatrix}[rrrrrrr]
                0&0&\mathbf{1}&-53&0&0&-3 \\
                0&0&0&0&\mathbf{1}&0&-11 \\
                0&0&0&0&0&\mathbf{1}&-3 \\
                \end{bmatrix} 
                \begin{bmatrix}[rrrrrr]
                \mathbf{1}&3&0&0&-3&8 \\
                0&0&\mathbf{1}&-3&5&-11 \\
                0&0&0&0&0&0
                \end{bmatrix}
                \]

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Matriisi</p>
                        \[
                        \begin{bmatrix}[rrr|r]
                        1 & 0 & 0 & 4 \\
                        0 & 1 & 0 & -2 \\
                        0 & 0 & 1 & 3 \\
                        \end{bmatrix}
                        \]
                        <p>on redusoitu porrasmatriisi. Sitä vastaava yhtälöryhmä on</p>
                        <!-- %\[\begin{equation*} -->
                        <!-- %\left\{ -->
                        <!-- %\begin{array}{rrrcr} -->
                        <!-- %x_1&&&=&4 \\ -->
                        <!-- %&x_2&&=&-2 \\ -->
                        <!-- %&&x_3&=&3. -->
                        <!-- %\end{array} -->
                        <!-- %\right. -->
                        <!-- % \left\{ -->
                        <!-- % \begin{aligned} -->
                        <!-- % x_1\phantom{{}+x_2+x_3}&=4 \\ -->
                        <!-- % x_2 \phantom{{}+x_3}&=-2 \\ -->
                        <!-- % x_3&=3. -->
                        <!-- % \end{aligned} -->
                        <!-- % \right. -->
                        <!-- % \begin{equation*}\] -->
                        \[
                        \left\{
                        \begin{array}{rcr}
                        x_1 & = & 4 \\
                        x_2 & = & -2 \\
                        x_3 & = & 3
                        \end{array}\right.
                        \]
                        <p>Huomataan, että matriisista näkyy suoraan yhtälöryhmän ratkaisu.</p>
                        <!-- %, joka on -->
                        <!-- % \[\begin{equation*} -->
                        <!-- % \left\{ -->
                        <!-- % <!-- %\begin{array}{rcr} -->
                        <!-- % <!-- %x_1&=&4 \\ -->
                        <!-- % <!-- %x_2&=&-2 \\ -->
                        <!-- % <!-- %x_3&=&3. \\ -->
                        <!-- % <!-- %\end{array} -->
                        <!-- % \begin{aligned} -->
                        <!-- % x_1&=4 \\ -->
                        <!-- % x_2&=-2 \\ -->
                        <!-- % x_3&=3. -->
                        <!-- % \end{aligned} -->
                        <!-- % \right. -->
                        <!-- % \begin{equation*}\] -->
                        <!-- % Ratkaisut on helppo nähdä juuri sen vuoksi, että yhtälöryhmän matriisi on redusoitu porrasmatriisi. -->
                    </div>
                </div>

                <h2>Gaussin--Jordanin eliminointimenetelmä</h2><!-- \index{Gaussin-Jordanin eliminointimenetelmä} -->

                <p>Tavoitteena on muuttaa yhtälöryhmän matriisi alkeisrivitoimitusten avulla redusoiduksi porrasmatriisiksi, josta ratkaisut näkyvät suoraan. Voidaan osoittaa, että mikä tahansa matriisi voidaan muuttaa tällä tavoin redusoiduksi porrasmatriisiksi ja että alkeisrivitoimitusten käyttämisjärjestys ei vaikuta tulokseen. Seuraava esimerkki näyttää, kuinka tämä tehdään.
                </p>

                <!-- %TODO: miksei todisteta? löytyykö todistus jostakin? -->

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto"><!-- \label{redusoituPorrasmuotoEsim} -->
                        <!-- %\[ -->
                        <!-- %\begin{bmatrix} -->
                        <!-- %1&0&2&1\\ -->
                        <!-- %2&-1&3&2\\ -->
                        <!-- %-1&-2&0&3 -->
                        <!-- %\end{bmatrix}\] -->
                        <!-- %ja muutetaan se redusoiduksi porrasmatriisiksi. -->
                        <!-- %Aloitetaan ensimmäisestä sarakkeesta. Ensimmäisen rivin johtavan alkion alla -->
                        <!-- %pitäisi olla pelkkiä nollia. Nollat saadaan aikaan ensimmäisen rivin johtavan -->
                        <!-- %alkion avulla. Lisätään toiseen riviin ensimmäinen rivi luvulla \(-2\)kerrottuna: -->
                        <p>Muutetaan matriisi</p>
                        \[
                        \begin{bmatrix}[rrrr]
                        2&-1&3&2\\
                        1&0&2&1\\
                        -1&-2&0&3
                        \end{bmatrix}
                        \]
                        <p>redusoiduksi porrasmatriisiksi. Aloitetaan ensimmäisestä sarakkeesta. Vaihtamalla ensimmäisen ja toisen rivin paikat, saadaan ensimmäisen rivin johtavaksi alkioksi~1:
                        </p>
                        \[
                        \overset{R_1 \leftrightarrow R_2}{\longrightarrow}
                        \begin{bmatrix}[rrrr]
                        1&0&2&1\\
                        2&-1&3&2\\
                        -1&-2&0&3
                        \end{bmatrix}.
                        \]
                        <p>Tämän jälkeen johtavan alkion alla olevat alkiot on helppo muuttaa nolliksi. Vähennetään ensin toisesta rivistä ensimmäinen rivi luvulla \(2\)kerrottuna:
                        </p>
                        \[
                        \overset{R_2-2R_1}{\longrightarrow}
                        \begin{bmatrix}[rrrr]
                        1&0&2&1\\
                        0&-1&-1&0\\
                        -1&-2&0&3
                        \end{bmatrix} .\]
                        <p>Lisätään sitten kolmanteen riviin ensimmäinen rivi luvulla 1 kerrottuna:
                        </p>
                        \[
                        \overset{R_3+R_1}{\longrightarrow}
                        \begin{bmatrix}[rrrr]
                        1&0&2&1\\
                        0&-1&-1&0\\
                        0&-2&2&4
                        \end{bmatrix}.
                        \]
                        <p>Nyt ensimmäinen sarake on halutussa muodossa. Siirrytään muokkaamaan toista
                            saraketta. Muutetaan ensin sen johtava alkio ykköseksi, jotta voidaan toimia
                            samoin kuin edellä. Kerrotaan siis toinen rivi luvulla \(-1\).
                            <!-- %Tätä operaatiota voidaan merkitä \(-1 \cdot R_2\). -->
                            Saadaan matriisi
                        </p>
                        \[
                        \overset{-1 \cdot R_2}{\longrightarrow}
                        \begin{bmatrix}[rrrr]
                        1&0&2&1\\
                        0&1&1&0\\
                        0&-2&2&4
                        \end{bmatrix}.
                        \]
                        <p>Toisen rivin johtavan alkion avulla voidaan muuttaa sen alla oleva alkio nollaksi. Lisätään
                            kolmanteen riviin toinen rivi luvulla 2 kerrottuna. Saadaan matriisi
                        </p>
                        \[
                        \overset{R_3+2R_2}{\longrightarrow}
                        \begin{bmatrix}[rrrr]
                        1&0&2&1\\
                        0&1&1&0\\
                        0&0&4&4
                        \end{bmatrix},
                        \]
                        <p>joka on porrasmatriisi.
                        </p>
                        <p>Jatketaan muokkaamista niin, että saadaan aikaan redusoitu porrasmatriisi.
                            Muutetaan ensin viimeinenkin johtava alkio ykköseksi:</p>
                        \[
                        \overset{\frac{1}{4}R_3}{\longrightarrow}
                        \begin{bmatrix}[rrrr]
                        1&0&2&1\\
                        0&1&1&0\\
                        0&0&1&1
                        \end{bmatrix}.
                        \]
                        <p>Muutetaan alimman rivin johtavan alkion avulla kaikki kolmannen sarakkeen
                            muut alkiot nolliksi:</p>
                        \[\begin{split}
                        \overset{R_2-R_3}{\longrightarrow} &
                        \begin{bmatrix}[rrrr]
                        1&0&2&1\\
                        0&1&0&-1\\
                        0&0&1&1
                        \end{bmatrix}
                        \overset{R_1-2R_3}{\longrightarrow}
                        \begin{bmatrix}[rrrr]
                        1&0&0&-1\\
                        0&1&0&-1\\
                        0&0&1&1
                        \end{bmatrix}.
                        \end{split}
                        \]
                        <p>Näin saatu matriisi on redusoitu porrasmatriisi.</p>

                        <p>Saatu redusoitu porrasmatriisi on eri matriisi kuin se, josta lähdettiin
                            liikkeelle. Matriisit myös vastaavat erilaisia yhtälöryhmiä. Näillä
                            yhtälöryhmillä on kuitenkin samat ratkaisut edellisen lauseen <!-- ~\ref{ekvivalenttiLause} --> nojalla.</p>
                    </div>
                </div>

                <p>Ohjeita redusoidun porrasmatriisin aikaansaamiseksi:</p>
                <ul>
                    <li> Porrasmatriisia muodostetaan vasemmalta oikealle ja ylhäältä alaspäin.
                    <li> Johtavat alkiot kannattaa useimmiten muuttaa ykkösiksi.
                    <li> Johtavien alkioiden avulla muutetaan niiden alapuolella olevat alkiot
                        nolliksi. Näin saadaan aikaan porrasmatriisi.
                    <li> Redusoitua porrasmatriisia muodostetaan oikealta vasemmalle ja alhaalta
                        ylöspäin.
                    <li> Johtavien alkioiden avulla muutetaan niiden yläpuolella olevat alkiot nolliksi.
                    <li> Tee vain yksi alkeisrivitoimitus kerrallaan!
                </ul>

                <p>Toisinaan redusoituun porrasmatriisin voi päätyä nopeammin käyttämällä jotakin toista reittiä. Edellä kuvattujen välivaiheiden seuraaminen on kuitenkin turvallista, sillä ne tuottavat aina redusoidun porrasmatriisin.
                </p>

                <p>Nyt olemme valmiita ratkaisemaan yhtälöryhmiä. Yhtälöryhmän ratkaiseminen Gaussin--Jordanin menetelmää käyttäen sisältää seuraavat vaiheet:
                </p>
                <ul>
                    <li> Kirjoita yhtälöryhmän matriisi.
                    <li> Muuta matriisi alkeisrivitoimituksilla porrasmatriisiksi.
                    <li> Muuta porrasmatriisi redusoiduksi porrasmatriisiksi.
                    <li> Lue ratkaisut redusoidusta porrasmatriisista.
                </ul>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Ratkaistaan yhtälöryhmä</p>
                        \[
                        \left\{
                        \begin{array}{rcrcrcl}
                        2x_1&-&x_2&+&3x_3&=&2 \\
                        x_1&&&+&2x_3&=&1 \\
                        -x_1&-&2x_2&&&=&3. \\
                        \end{array}
                        \right.
                        \]
                        <p>Yhtälöryhmän matriisi on</p>
                        \[
                        \begin{bmatrix}[rrr|r]
                        2&-1&3&2\\
                        1&0&2&1\\
                        -1&-2&0&3
                        \end{bmatrix}.
                        \]
                        <p>Tämä matriisi muutettiin redusoiduksi porrasmatriisiksi edellisessä esimerkissä <!-- \ref{redusoituPorrasmuotoEsim}-->:</p>
                        \[
                        \begin{bmatrix}[rrr|r]
                        1&0&0&-1\\
                        0&1&0&-1\\
                        0&0&1&1
                        \end{bmatrix}.
                        \]
                        <p>Redusoitua porrasmatriisia vastaava yhtälöryhmä on</p>
                        \[
                        \begin{equation*}
                        \left\{
                        \begin{array}{rcr}
                        x_1 & = & -1 \\
                        x_2 & = & -1 \\
                        x_3 & = & 1
                        \end{array}
                        \right.
                        \begin{equation*}
                        \]
                        <p>Koska alkuperäisen yhtälöryhmän ratkaisut ovat edellisen lause<!-- en \ref{ekvivalenttiLause} --> nojalla samat kuin lopuksi saadun yhtälöryhmän, on yhtälöryhmä ratkaistu. Sen ratkaisu on siis
                        </p>
                        \[
                        \begin{equation*}
                        \left\{
                        \begin{array}{rcr}
                        x_1 & = & -1 \\
                        x_2 & = & -1 \\
                        x_3 & = & 1 \\
                        \end{array}
                        \right.
                        \begin{equation*}
                        \]
                    </div>
                </div>

                <!-- %<div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> -->
                <!-- %Ratkaistaan lineaarinen yhtälöryhmä -->
                <!-- %\[ -->
                <!-- %\left\{ -->
                <!-- %\begin{aligned} -->
                <!-- %-3x+5y&=-22 \\ -->
                <!-- %3x+4y&=4 \\ -->
                <!-- %4x-8y&=32. -->
                <!-- %\end{aligned} -->
                <!-- %\right. -->
                <!-- %\] -->
                <!-- %</div></div> -->

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Ratkaistaan lineaarinen yhtälöryhmä</p>
                        \[
                        \left\{
                        \begin{array}{rcr}
                        x+2y+z & = & 8 \\
                        -3x-6y-3z & = & -21
                        \end{array}\right.
                        \]
                        <p>Muutetaan yhtälöryhmän matriisi redusoiduksi porrasmatriisiksi:</p>
                        \[
                        \begin{bmatrix}[rrr|r]
                        1 & 2 & 1 & 8 \\
                        -3 & -6 & -3 & -21
                        \end{bmatrix}
                        \overset{R_2+3R_1}{\longrightarrow}
                        \begin{bmatrix}[rrr|r]
                        1 & 2 & 1 & 8 \\
                        0 & 0 & 0 & 3
                        \end{bmatrix}.
                        \]
                        <p>Vastaava yhtälöryhmä on</p>
                        \[
                        \left\{
                        \begin{aligned}
                        x+2y+z&=8 \\
                        0&=3.
                        \end{aligned}
                        \right.
                        \]
                        <p>Alin yhtälö on aina epätosi, joten yhtälöryhmällä ei ole ratkaisuja.</p>
                    </div>
                </div>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto"><!-- \label{esim:yhtaloryhma_vapaa_muuttuja} -->
                        <p>Ratkaistaan lineaarinen yhtälöryhmä</p>
                        \[
                        \left\{
                        \begin{array}{rcr}
                        3x_1+3x_2-15x_3 & = & 9 \\
                        x_1\phantom{{}+3x_2}-2x_3 & = & 1 \\
                        2x_1-x_2-x_3 & = & 0
                        \end{array}\right.
                        \]
                        <p>Muutetaan yhtälöryhmän matriisi redusoiduksi porrasmatriisiksi:</p>
                        \[
                        \begin{alignat*}{4}
                        & & &\begin{bmatrix}[rrr|r]
                        3 & 3 & -15 & 9 \\
                        1 & 0 & -2 & 1 \\
                        2 & -1 & -1 & 0
                        \end{bmatrix}
                        &\  &\overset{\frac{1}{3}R_1}{\longrightarrow} &\
                        &\begin{bmatrix}[rrr|r]
                        1 & 1 & -5 & 3 \\
                        1 & 0 & -2 & 1 \\
                        2 & -1 & -1 & 0
                        \end{bmatrix} \\[1mm]
                        &\overset{R_2-R_1}{\longrightarrow} &\
                        &\begin{bmatrix}[rrr|r]
                        1 & 1 & -5 & 3 \\
                        0 & -1 & 3 & -2 \\
                        2 & -1 & -1 & 0
                        \end{bmatrix}
                        & &\overset{R_3 - 2R_1}{\longrightarrow}
                        & &\begin{bmatrix}[rrr|r]
                        1 & 1 & -5 & 3 \\
                        0 & -1 & 3 & -2 \\
                        0 & -3 & 9 & -6
                        \end{bmatrix} \\[1mm]
                        &\overset{-1 \cdot R_2}{\longrightarrow}
                        & &\begin{bmatrix}[rrr|r]
                        1 & 1 & -5 & 3 \\
                        0 & 1 & -3 & 2 \\
                        0 & -3 & 9 & -6
                        \end{bmatrix}
                        & &\overset{R_3+3R_2}{\longrightarrow}
                        & &\begin{bmatrix}[rrr|r]
                        1 & 1 & -5 & 3 \\
                        0 & 1 & -3 & 2 \\
                        0 & 0 & 0 & 0
                        \end{bmatrix} \\[1mm]
                        &\overset{R_1-R_2}{\longrightarrow}
                        & &\begin{bmatrix}[rrr|r]
                        1 & 0 & -2 & 1 \\
                        0 & 1 & -3 & 2 \\
                        0 & 0 & 0 & 0
                        \end{bmatrix}.
                        \end{alignat*}
                        \]

                        <p>Saatua matriisia vastaa yhtälöryhmä</p>
                        \[
                        \left\{
                        \begin{aligned}
                        x_1-2x_3 & =1 \\
                        x_2-x_3 & =2 \\
                        0 & =0
                        \end{aligned}\right.
                        \]
                        <p>Alin yhtälö \(0 = 0\)on aina tosi. Se ei siis anna ratkaisujen kannalta mitään informaatiota. Tuntemattomalle \(x_3\)ei puolestaan aseteta mitään rajoitteita, joten se voi olla mikä tahansa reaaliluku. Sanotaan, että \(x_3\)on <strong>vapaa muuttuja</strong><!-- \index{vapaa muuttuja} -->. Merkitään \(x_3 = t\), missä \(t \in \R\).</p>

                        <p>Ratkaistaan vielä muut tuntemattomat. Ensimmäinen yhtälö on \(x_1-2t=1\), joten \(x_1=1+2t\). Toinen yhtälö puolestaan on \(x_2-3t=2\) eli \(x_2=2+3t\). Siten yhtälöryhmän ratkaisu on</p>
                        \[
                        \left\{
                        \begin{aligned}
                        x_1 & =1 + 2t \\
                        x_2 & =2 + 3t \\
                        x_3 & = t
                        \end{aligned}\right.
                        \text{missä \(t \in \R\).}
                        \]
                        <p>Ratkaisuja on siis äärettömän monta. Esimerkiksi \(x_1 = 3\), \(x_2 = 3\) ja \(x_3 = 1\) sekä \(x_1 = -1\), \(x_2 = 1\)ja \(x_3 = -1\)ovat yhtälöryhmän ratkaisuja. Jokaisella reaaliluvulla \(t\)yhtälöryhmälle saadaan eri ratkaisu.</p>
                    </div>
                </div>

                <p>Yhtälöryhmässä saattaa olla useitakin vapaita muuttujia. Nämä löytyvät redusoidussa porrasmatriisissa niistä sarakkeista, joissa ei ole lainkaan johtavaa alkiota.</p>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Lineaarisen yhtälöryhmän matriisi muutettiin alkeisrivitoimituksilla redusoiduksi porrasmatriisiksi</p>
                        \[\begin{bmatrix}[cccccc|c]
                        1&3&0&4&0&0&7\\
                        0&0&1&2&0&0&0\\
                        0&0&0&0&0&1&3\\
                        \end{bmatrix}.\]
                        <p>Mikä on yhtälöryhmän ratkaisu?</p>

                        <p>Havaitaan, että johtavat alkiot ovat sarakkeissa 1, 3 ja 6. Muita sarakkeita vastaavat tuntemattomat \(x_2\), \(x_4\)ja \(x_5\)ovat vapaita muuttujia. Merkitään \(x_2=r\), \(x_4 = s\) ja \(x_5 = t\), missä \(r\), \(s\), \(t \in \R\).</p>

                        <p>Nyt voidaan kirjoittaa</p>
                        \[
                        \left\{
                        \begin{aligned}
                        x_1+3r+4s&=7 \\
                        x_3+2s&=0 \\
                        x_6&=3
                        \end{aligned}
                        \right.
                        \]
                        ja edelleen
                        \[
                        \left\{
                        \begin{aligned}
                        x_1 & =7-3r-4s \\
                        x_3 & =-2s \\
                        x_6 & = 3
                        \end{aligned}
                        \right.
                        \]
                        <p>Yhtälöryhmän ratkaisu on siis</p>
                        \[
                        \left\{
                        \begin{aligned}
                        x_1 & =7-3r-4s \\
                        x_2 & = r \\
                        x_3 & =-2s \\
                        x_4 & = s \\
                        x_5 & = t \\
                        x_6 & = 3
                        \end{aligned}\right.
                        \text{missä \(r, s, t \in \R\)}.
                        \]
                        <p>Luvut \(r\), \(s\)ja \(t\)voidaan valita täysin vapaasti, ja jokainen valinta tuottaa yhtälöryhmän erään ratkaisun.
                        </p>
                    </div>
                </div>

                <h3>Porrasmatriisien tulkinta</h3>

                <p>Edelliset esimerkit kuvaavat tilanteita, joihin Gaussin--Jordanin menetelmää käyttäen voidaan päätyä. Kootaan vielä yhteen redusoidun porrasmatriisin \(M\) merkitys sitä vastaavan yhtälöryhmän kannalta eri tapauksissa.</p>
                <ul>
                    <li> Jos jokin matriisin \(M\) viimeisistä riveistä on muotoa \(\begin{bmatrix}[rrr|r]0 & \cdots & 0 & 1\end{bmatrix}\)(eli rivin johtava ykkönen on pystyviivan oikealla puolella), kyseistä riviä vastaa epätosi yhtälö \(0=1\). Yhtälöryhmällä ei ole ratkaisua.
                    <li> Oletetaan, että edellinen tapaus ei toteudu. Jos joltakin matriisin \(M\) sarakkeelta puuttuu johtava alkio (pystyviivan vasemmalta puolelta), tuota saraketta vastaava muuttuja on vapaa. Yhtälöryhmän ratkaisut voidaan esittää vapaiden muuttujien avulla. Kunkin vapaan muuttujan arvo voidaan valita vapaasti, joten yhtälöryhmällä on ratkaisuja ääretön määrä.
                    <li> Oletetaan, että edelliset tapaukset eivät toteudu. Tällöin matriisin \(M\) jokaisessa sarakkeessa oikeanpuoleisinta lukuunottamatta on johtava alkio, ja yhtälöryhmällä on täsmälleen yksi ratkaisu.
                </ul>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Usein kiinnostavaa ei ole yhtälöryhmän tarkka ratkaiseminen, vaan se, <strong>kuinka monta} ratkaisua yhtälöryhmällä on. Tällöin ei tarvitse muuttaa yhtälöryhmän matriisia redusoituun porrasmuotoon, vaan pelkkä porrasmuoto riittää.</p>

                        <p>Oletetaan vaikkapa, että yhtälöryhmän matriisi on saatu alkeisrivitoimituksilla muotoon</p>
                        \[
                        \begin{bmatrix}[ccc|c]
                        4&-3&1&0\\
                        0&-1&2&2\\
                        0&0&0&-4\\
                        0&0&0&0\\
                        \end{bmatrix}.
                        \]
                        <p>Toiseksi viimeinen rivi vastaa yhtälöä \(0=-4\), mikä on mahdotonta. Nyt tiedetään, että yhtälöryhmällä ei ole ratkaisuja.</p>

                        <p>Tutkitaan sitten yhtälöryhmää, jonka matriisi on saatu alkeisrivitoimituksilla porrasmatriisiksi</p>
                        \[
                        \begin{bmatrix}[cccc|c]
                        4&-3& 0&1&0\\
                        0&6&2& 3&2\\
                        0&0&0& -1&-4\\
                        \end{bmatrix}.
                        \]
                        <p>Epätosia yhtälöitä ei ole, joten yhtälöryhmällä on ratkaisuja. Koska kolmannessa sarakkeessa ei ole johtavaa alkiota, yhtälöryhmällä on äärettömän monta ratkaisua.</p>

                        <p>Tarkastellaan vielä lopuksi yhtälöryhmää, jonka matriisi on saatu alkeisrivitoimituksilla porrasmatriisiksi</p>
                        \[
                        \begin{bmatrix}[ccc|c]
                        4&-3&1&0\\
                        0&6&2&2\\
                        0&0&2&-4\\
                        \end{bmatrix}.
                        \]
                        <p>Epätosia yhtälöitä ei ole, joten yhtälöryhmällä on ratkaisuja. Koska jokaisessa sarakkeessa on johtava alkio, ei vapaita muuttujia ole. Siten yhtälöryhmällä on täsmälleen yksi ratkaisu.</p>
                    </div>
                </div>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Tarkastellaan yhtälöryhmää</p>
                        \[
                        \left\{
                        \begin{aligned}
                        x+\phantom{k}y+kz&=1 \\
                        x+ky+\phantom{k}z&=1 \\
                        kx+\phantom{k}y+\phantom{k}z&=-2\,.
                        \end{aligned}
                        \right.
                        \]

                        <p>Tutkitaan, miten luvun \(k\)arvot vaikuttavat ratkaisujen lukumäärään. Ryhdytään muuttamaan yhtälöryhmän matriisia redusoiduksi porrasmatriisiksi:</p>

                        \[
                        \begin{align*}
                        & \begin{bmatrix}[rrr|r]
                        1&1&k&1\\
                        1&k&1&1\\
                        k&1&1&-2\\
                        \end{bmatrix} \overset{R_2-R_1}{\longrightarrow}
                        \begin{bmatrix}[rrr|r]
                        1&1&k&1\\
                        0&k-1&1-k&0\\
                        k&1&1&-2\\
                        \end{bmatrix} \\
                        \overset{R_3-kR_1}{\longrightarrow}
                        &\begin{bmatrix}[rrr|r]
                        1&1&k&1\\
                        0&k-1&1-k&0\\
                        0&1-k&1-k^2&-2-k\\
                        \end{bmatrix}
                        \overset{R_3+R_2}{\longrightarrow}
                        \begin{bmatrix}[rrr|r]
                        1&1&k&1\\
                        0&k-1&1-k&0\\
                        0&0&2-k-k^2&-2-k\\
                        \end{bmatrix}
                        \end{align*}
                        \]

                        <!-- %Nyt joudutaan tarkastelemaan erilaisia vaihtoehtoja sen mukaan, onko \(k-1\)nolla vai ei. -->
                        <p>Kaikki alkeisrivitoimitukset voidaan tähän asti tehdä riippumatta siitä, mikä luku \(k\) on. Jatkaminen ei kuitenkaan onnistu, sillä toisen rivin alkio \(k - 1\) saattaa olla nolla, samoin kolmannen rivin alkio \(2 - k - k^2\). Tarkastellaan näitä tapauksia erikseen.</p>

                        <p>Oletetaan ensin, että kolmannen rivin alkio \(2 - k - k^2 = 0\) eli \(k = -2\) tai \(k = 1\).</p>
                        <ul>
                            <li> Jos \(k = -2\), viimeinen matriisi on
                                \[
                                \begin{bmatrix}[rrr|r]
                                1&1&-2&1\\
                                0&-3&3&0\\
                                0&0&0&0\\
                                \end{bmatrix}.
                                \]
                                Havaitaan, että alinta riviä vastaava yhtälö \(0 = 0\) on aina tosi. Lisäksi tuntematonta \(x_3\) vastaavassa sarakkeessa ei ole johtavaa alkiota, joten \(x_3\) on vapaa muuttuja. Ratkaisuja on siten äärettömän monta.
                            <li> Jos \(k = 1\), viimeinen matriisi on
                                \[
                                \begin{bmatrix}[rrr|r]
                                1&1&1&1\\
                                0&0&0&0\\
                                0&0&0&-3\\
                                \end{bmatrix}.
                                \]
                                Havaitaan, että alinta riviä vastaava yhtälö \(0 = -3\)
                                on aina epätosi. Siten yhtälöryhmällä ei ole ratkaisuja.
                        </ul>

                        <p>Oletetaan sitten, että toisen rivin alkio \(k-1 = 0\)eli \(k = 1\). Tämä tapaus käsiteltiin sattumalta jo edellä.</p>

                        <p>Tarkastellaan vielä lopuksi tilannetta, jossa sekä toisen rivin alkio \(k-1\)että kolmannen rivin alkio \(2 - k - k^2\) ovat nollasta poikkeavia. Tällöin voidaan jatkaa alkeisrivitoimitusten tekemistä.</p>
                        <p>Koska \(k-1 \neq 0\)ja \(2 - k - k^2 \neq 0\) saadaan</p>
                        \[
                        \overset{\frac{1}{k-1}R_2}{\longrightarrow}
                        \begin{bmatrix}[ccc|c]
                        1&1&k&1\\
                        0&1&-1&0\\
                        0&0&2-k-k^2&-2-k
                        \end{bmatrix} \overset{\frac{1}{2 - k - k^2}R_3}{\longrightarrow}
                        \begin{bmatrix}[ccc|c]
                        1&1&k&1\\
                        0&1&-1&0\\
                        0&0&1&\frac{-2-k}{2 - k - k^2}
                        \end{bmatrix}.
                        \]
                        <p>Tällöin yhtälöryhmällä on täsmälleen yksi ratkaisu.</p> <!-- %Nähdään nimittäin, että \(x_3 = (-2-k)/(2-k-k^2)\)ja ylemmistä yhtälöistä saadaan muut tuntemattomat.
                        
                        <!-- %Jos kerroin \(2-k-k^2\)on nolla eli \(k = -2\), on periaatteessa kaksi mahdollisuutta: -->
                        <!-- %<ol> -->
                        <!-- %<li> Pätee \(-2-k = 0\)eli \(k = -2\). Tällöin yhtälöllä on äärettömän monta ratkaisua. Alinta riviä nimittäin vastaa yhtälö \(0 = 0\)ja \(x_3\) --><!-- %on vapaa muuttuja. -->
                        <!-- %<li> Pätee \(-2-k \neq 0\)eli \(k \neq -2\). Tämä on kuitenkin mahdotonta, sillä oletimme, että \(k = -2\). -->
                        <!-- %</ol> -->

                        <!-- %Oletetaan sitten, että \(k-1 = 0\)eli \(k = 1\). Alkuperäinen -->
                        <!-- %yhtälöryhmä on tällöin -->
                        <!-- %\[ -->
                        <!-- %\left\{ -->
                        <!-- %\begin{aligned} -->
                        <!-- %x+y+z&=1 \\ -->
                        <!-- %x+y+z&=1 \\ -->
                        <!-- %x+y+z&=-2\,. -->
                        <!-- %\end{aligned} -->
                        <!-- %\right. -->
                        <!-- %\] -->
                        <!-- %Ylin ja alin yhtälö ovat keskenään ristiriitaiset, joten yhtälöryhmällä ei ole ratkaisua. -->

                        <p>Päädyttiin siis seuraavaan tulokseen: Yhtälöryhmällä on äärettömän monta ratkaisua, jos ja vain jos \(k = -2\). Yhtälöryhmällä ei ole ratkaisua, jos ja vain jos \(k = 1\). Yhtälöryhmällä on tasan yksi ratkaisu, jos ja vain jos \(k \neq 1\)ja \(k \neq -2\).</p>
                    </div>
                </div>

                <div class="esim drop">
                    <h3 class="otsikko">Esimerkki</h3>
                    <div class="sisalto">
                        <p>Redusoidut porrasmatriisit ovat teoreettisesti mielenkiintoisia, koska jokaista matriisia vastaa täsmälleen yksi redusoitu porrasmatriisi. Edellä kuitenkin nähtiin, että yhtälöryhmän ratkaisujen lukumärä on luettavissa jo porrasmatriisista. Itse asiassa yhtälöryhmä voidaan jopa ratkaista porrasmatriisivaiheen avulla.</p>

                        <p>Esimerkin <!-- ~\ref{esim:yhtaloryhma_vapaa_muuttuja} --> yhtälöryhmää vastaava porrasmatriisi oli</p>
                        \[
                        \begin{bmatrix}[rrr|r]
                        1 & 1 & -5 & 3 \\
                        0 & 1 & -3 & 2 \\
                        0 & 0 & 0 & 0
                        \end{bmatrix}.
                        \]
                        <p>Koska kolmannessa sarakkeessa ei ole johtavaa alkiota, sitä vastaava muuttuja on vapaa. Tähän havaintoon ei tarvita redusoitua porrasmuotoa. Jos merkitään \(x_3=t\), muut muuttujat voidaan ratkaista \(t\):n avulla. Toisen rivin perusteella</p>
                        \[
                        x_2-3t=2 \iff x_2=2+3t,
                        \]
                        <p>ja tämän jälkeen ensimmäisen rivin perusteella</p>
                        \[
                        x_1+x_2-5t=3 \iff x_1+(3t+2)-5t=3 \iff x_1=1+2t.
                        \]
                        <p>Porrasmatriisi siis riittää yhtälöryhmän ratkaisemiseen.</p>
                    </div>
                </div>


                <p><strong>Historiallinen huomautus.</strong> Gauss ei itse kehittänyt nimeään kantavaa menetelmää, vaan sen tunsi jo ainakin Newton sata vuotta aikaisemmin 1600-luvun loppupuolella. Kiinalaiset puolestaan tunsivat menetelmän jo toisella vuosisadalla eKr. Nimitys ''Gaussin eliminointimenetelmä'' tuli käyttöön kuitenkin vasta 1950-luvulla. Tällä nimityksellä tarkoitetaan yleensä nimenomaan porrasmatriisiin tähtäävää menetelmää, ja mikäli halutaan jatkaa redusoituun porrasmatriisiin asti, menetelmää kutsutaan ''Gaussin--Jordanin eliminoinniksi''. Jordan esitti tämän version eliminointimenetelmästä vuonna 1887.</p>

                <h3>Geometrinen tulkinta</h3>

                <p>Yhtälöryhmällä voi siis olla täsmälleen yksi ratkaisu, äärettömän monta ratkaisua tai ei yhtään ratkaisua. Kun muuttujia on kaksi tai kolme, tilannetta voi havainnollistaa analyyttisen geometrian avulla.</p>
                <p>Tutkitaan yhtälöparia</p>
                \[
                \begin{equation*}
                \left\{
                \begin{aligned}
                ax+by&=c \\
                dx+ey&=f.
                \end{aligned}
                \right.
                \begin{equation*}
                \]
                <p>Oletetaan, että yhtälöllä on ratkaisu \(x=r\), \(y=s\). Sitä voidaan ajatella tason pisteenä \((r,s)\). Koska ratkaisu toteuttaa ensimmäisen yhtälön, piste \((r,s)\) on suoralla, jonka yhtälö on \(ax+by=c\). Samoin piste \((r,s)\) on suoralla, jonka yhtälö on \(dx+ey=f\). Piste \((r,s)\) on siis molemmilla suorilla, eli se on suorien leikkauspiste.</p>

                <p>Jos yhtälöt määrittävät kaksi erisuuntaista suoraa, on niillä on täsmälleen yksi leikkauspiste. Tällöin yhtälöparilla on täsmälleen yksi ratkaisu. Jos yhtälöt määrittävät saman suoran, on leikkauspisteitä äärettömän monta. Silloin ratkaisujakin on äärettömän monta. Jos yhtälöiden määrittämät suorat eivät ole samat mutta ovat kuitenkin yhdensuuntaiset, ei leikkauspisteitä ole. Silloin ei myöskään yhtälöparilla ole ratkaisuja.</p>

                <div class="image">

                    <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva76.png" />
                    <strong>Kuva: </strong>Yhtälöryhmällä on tasan yksi ratkaisu, äärettömän monta ratkaisua tai ei yhtään ratkaisua.<!-- \label{k76} -->
                </div>

                </p>Kun muuttujia on kolme, yhtälöt kuvaavat tasoja. Esimerkiksi kolmen tason leikkausjoukko voi olla piste, suora tai taso. Nämä vastaavat tilanteista, joissa ratkaisuun tulee nolla, yksi tai kaksi vapaata muuttujaa. Leikkausjoukko voi olla myös tyhjä, jolloin yhtälöryhmällä ei ole ratkaisuja.</p>

                <h2>Yhtälöryhmien ekvivalenssin todistus</h2>

                <p>Käydään vielä lopuksi todistus sille, että yhtälöryhmillä on samat ratkaisut, jos niiden matriisit ovat riviekvivalentit (lause <!-- ~\ref{ekvivalenttiLause} -->).</p>

                <div class="todistus drop">
                    <h4 class="otsikko">Todistus</h4><!-- [Lauseen~\ref{ekvivalenttiLause} todistus] -->
                    <p>Osoitetaan, että jos yhtälöryhmiä vastaavat matriisit ovat riviekvivalentit, yhtälöryhmät ovat ekvivalentit. Tätä varten riittää näyttää, että alkeisrivitoimituksen tekeminen ei vaikuta yhtälöryhmän ratkaisuihin. Tutkitaan yhtälöryhmää</p>

                    \[
                    \begin{equation} \label{eiKerrottu}
                    \left\{
                    \begin{array}{rcrcccrcr}
                    a_{11}x_1&+&a_{12}x_2&+&\dots&+&a_{1n}x_n&=&b_1 \\
                    &&&&&&&\vdots & \\
                    a_{i1}x_1&+&a_{i2}x_2&+&\dots&+&a_{in}x_n&=&b_i \\
                    &&&&&&&\vdots & \\
                    a_{m1}x_1&+&a_{m2}x_2&+&\dots&+&a_{mn}x_n&=&b_m, \\
                    \end{array}
                    \right.
                    \end{equation}
                    \]
                    <p>missä \(a_{11},\dots,a_{mn},b_1,\dots,b_m \in \R\).</p>

                    <p>1. Ensinnäkin huomataan, että yhtälöryhmän rivien järjestyksellä ei ole väliä. Siten kahden rivin paikkojen vaihtaminen ei muuta yhtälöryhmän ratkaisuja.</p>

                    <p>2. Tutkitaan sitten alkeisrivitoimitusta, joka kertoo rivin \(i\) luvulla \(c \in \R \setminus\{0\}\). Tuloksena on yhtälöryhmä</p>

                    \[
                    \begin{equation}\label{kerrottu}
                    \left\{
                    \begin{array}{rcrcccrcr}
                    a_{11}x_1&+&a_{12}x_2&+&\cdots&+&a_{1n}x_n&=&b_1 \\
                    &&&&&&&\vdots & \\
                    ca_{i1}x_1&+&ca_{i2}x_2&+&\cdots&+&ca_{in}x_n&=&cb_i \\
                    &&&&&&&\vdots & \\
                    a_{m1}x_1&+&a_{m2}x_2&+&\cdots&+&a_{mn}x_n&=&b_m. \\
                    \end{array}
                    \right.
                    \end{equation}
                    \]

                    <p>On osoitettava, yhtälöryhmillä (<!-- \ref{eiKerrottu} -->) ja (<!-- \ref{kerrottu} -->) on samat ratkaisut. Tämä tehdään kahdessa osassa. Ensin näytetään, että jokainen yhtälöryhmän (<!-- \ref{eiKerrottu} -->) ratkaisu on myös yhtälöryhmän (alla <!-- \ref{kerrottu} -->) ratkaisu. Sitten näytetään, että jokainen yhtälöryhmän (alla <!-- \ref{kerrottu} -->) ratkaisu on myös yhtälöryhmän (<!-- \ref{eiKerrottu} -->) ratkaisu.</p>

                    <p>Oletetaan ensin, että \(x_1=r_1, \dots, x_n=r_n\)on yhtälöryhmän (<!-- \ref{eiKerrottu} -->)
                        ratkaisu ja osoitetaan, että se on myös ryhmän (alla <!-- \ref{kerrottu} -->) ratkaisu. Oletuksen perusteella pätee</p>
                    \[
                    \begin{equation*}
                    \left\{
                    \begin{array}{rcrcccrcl}
                    a_{11}r_1&+&a_{12}r_2&+&\cdots&+&a_{1n}r_n&=&b_1 \\
                    &&&&&&&\vdots & \\
                    a_{i1}r_1&+&a_{i2}r_2&+&\cdots&+&a_{in}r_n&=&b_i \\
                    &&&&&&&\vdots & \\
                    a_{m1}r_1&+&a_{m2}r_2&+&\cdots&+&a_{mn}r_n&=&b_m. \\
                    \end{array}
                    \right.
                    \begin{equation*}
                    \]
                    <p>Kun \(i\):nnen yhtälön molemmat puolet kerrotaan luvulla \(c\), saadaan yhtälö \[ca_{i1}r_1+\cdots +ca_{in}r_n=cb_i.\]
                        Nyt siis \(x_1=r_1, \dots x_n=r_n\)toteuttaa yhtälöryhmän (<!-- \ref{kerrottu} -->), ja siten se on myös yhtälöryhmän (<!-- \ref{kerrottu} -->)ratkaisu.</p>

                    <p>Oletetaan sitten, että \(x_1=s_1, \dots, x_n=s_n\) on yhtälöryhmän (<!-- \ref{kerrottu} -->)
                        ratkaisu ja osoitetaan, että se on myös ryhmän (<!-- \ref{eiKerrottu} -->) ratkaisu. Nyt siis</p>
                    \[
                    \begin{equation*}
                    \left\{
                    \begin{array}{rcrcccrcl}
                    a_{11}s_1&+&a_{12}s_2&+&\cdots&+&a_{1n}s_n&=&b_1 \\
                    &&&&&&&\vdots & \\
                    ca_{i1}s_1&+&ca_{i2}s_2&+&\cdots&+&ca_{in}s_n&=&cb_i \\
                    &&&&&&&\vdots & \\
                    a_{m1}s_1&+&a_{m2}s_2&+&\cdots&+&a_{mn}s_n&=&b_m. \\
                    \end{array}
                    \right.
                    \begin{equation*}
                    \]
                    <p>Koska \(c \neq 0\), voidaan \(i\):nnen yhtälön molemmat puolet jakaa luvulla \(c\). Tällöin saadaan yhtälö \(a_{i1}s_1+\cdots +a_{in}s_n=b_i\). Nyt nähdään, että \(x_1=s_1, \dots, x_n=s_n\)toteuttaa myös yhtälöryhmän (<!-- \ref{eiKerrottu} -->), joten se on myös yhtälöryhmän (<!-- \ref{eiKerrottu} -->) ratkaisu. Siten yhtälöryhmillä on samat ratkaisut.</p>

                    <p>3. Kolmannen alkeisrivitoimituksen tarkastelu jätetään lukijalle.</p>

                    <!-- \begin{comment}
                    Väitettä ei todisteta tässä tarkasti. Käydään kuitenkin todistus läpi yhdelle
                    alkeisrivitoimituksista siinä tapauksessa, että yhtälöryhmässä on kaksi yhtälöä
                    ja kaksi tuntematonta. Yleinen tapaus todistetaan samaan tapaan.
                    %Tämän erikoistapauksen todistuksesta näkyy, millä tavoin väite osoitetaan.

                    Tarkastellaan yhtälöryhmää
                    \begin{equation} <!-- \label{ryhma1} -->
                    \left\{
                    \begin{array}{rcrcl}
                    a_{11}x_1&+&a_{12}x_2&=&b_1 \\
                    a_{21}x_1&+&a_{22}x_2&=&b_2.
                    \end{array}
                    \right.
                    \end{equation}
                    Olkoon \(c \in \R\). Kun yhtälöryhmälle tehdään alkeisrivitoimitus \(R_2+cR_1\)
                    saadaan yhtälöryhmä
                    \begin{equation} <!-- \label{ryhma2} -->
                    \left\{
                    \begin{array}{rcrcl}
                    a_{11}x_1&+&b_{12}x_2&=&b_1 \\
                    (ca_{11}+a_{21})x_1&+&(ca_{12}+a_{22})x_2&=&b_2+cb_1.
                    \end{array}
                    \right.
                    \end{equation}
                    Nyt on osoitettava, että näillä kahdella yhtälöryhmällä on samat ratkaisut. Tämä tehdään kahdessa osassa. Ensin näytetään, että jokainen yhtälöryhmän (\ref{ryhma1}) ratkaisu on myös yhtälöryhmän (\ref{ryhma2}) ratkaisu. Sitten näytetään, että jokainen yhtälöryhmän (\ref{ryhma2}) ratkaisu on myös yhtälöryhmän (\ref{ryhma1}) ratkaisu.

                    Oletetaan ensin, että \(x_1=r_1\), \(x_2=r_2\)on yhtälöryhmän (\ref{ryhma1})
                    ratkaisu ja osoitetaan, että se on myös ryhmän (\ref{ryhma2}) ratkaisu. Oletuksen perusteella pätee
                    \[\begin{equation*}
                    \left\{
                    \begin{array}{rcrcl}
                    a_{11}r_1&+&a_{12}r_2&=&b_1 \\
                    a_{21}r_1&+&a_{22}r_2&=&b_2.
                    \end{array}
                    \right.
                    \begin{equation*}\]
                    Kun toisen ensimmäisen molemmat puolet kerrotaan luvulla \(c\), saadaan \(ca_{11}r_1+ca_{12}r_2=cb_1\). Lasketaan tämä puolittain yhteen ensimmäisen yhtälön kanssa. Tuloksena on
                    \[(ca_{11}c+a_{21})x_1+(a_{12}+ca_{22})x_2=b_2+cb_1.\]
                    Siis pätee
                    \[\begin{equation*}
                    \left\{
                    \begin{array}{rcrcl}
                    a_{11}r_1&+&b_{12}r_2&=&b_1 \\
                    (ca_{11}+a_{21})r_1&+&(ca_{12}+a_{22})r_2&=&b_2+cb_1.
                    \end{array}
                    \right.
                    \begin{equation*}\]
                    ja näin ollen \(x_1=r_1\), \(x_2=r_2\)on yhtälöryhmän (\ref{ryhma2}) ratkaisu.

                    Oletetaan sitten, että \(x_1=r_1\), \(x_2=r_2\)on yhtälöryhmän (\ref{ryhma2})
                    ratkaisu. Samalla tavalla kuin edellä voidaan osoittaa, että  \(x_1=r_1\), \(x_2=r_2\)on myös yhtälöryhmän (\ref{ryhma2}) ratkaisu. Tämä jätetään lukijalle.
                    \end{comment} -->

                    <!-- \begin{comment}
                    ja osoitetaan, että se on myös ryhmän \ref{ryhma1} ratkaisu. Nyt
                    \[\begin{equation*}
                    \left\{
                    \begin{array}{rcrcr}
                    a_{11}r_1&+&b_{12}r_2&=&b_1.
                    (ca_{11}+a_{21})r_1&+&(ca_{12}+a_{22})r_2&=&b_2+cb_1 \\
                    \end{array}
                    \right.
                    \begin{equation*}\]
                    Kerrotaan ylempi yhtälö luvulla \(-1\)ja lisätään se alempaan yhtälöön.
                    Näin saadaan \(ca_{11}r_1+ca_{22}r_2=cb_2\). Jaetaan tämä luvulla \(c\). Nyt tiedetään, että \(a_{21}r_1+a_{22}r_2=b_2\). Siis
                    \[\begin{equation*}
                    \left\{
                    \begin{array}{rcrcr}
                    a_{11}r_1&+&a_{12}r_2&=&b_1 \\
                    a_{21}r_1&+&a_{22}r_2&=&b_2.
                    \end{array}
                    \right.
                    \begin{equation*}\]
                    ja siksi \(x_1=r_1\), \(x_2=r_2\)on yhtälöryhmän \ref{ryhma1} ratkaisu.
                    \end{comment} -->
                </div>

                <!-- \begin{comment}

                Seuraavaa riviekvivalentteihin matriiseihin liittyvää lausetta tullaan tarvitsemaan jatkossa.

                <div class="lause"><h3>Lause</h3> <!-- \label{riviekvLause} 
                    <ol><!-- \begin{aakkosta*}
                <li>
                Jos matriisi \(A\)on riviekvivalentti matriisin \(B\)kanssa, niin matriisi \(B\)on riviekvivalentti matriisin \(A\)kanssa.
                <li>
                Jos matriisi \(A\)on riviekvivalentti matriisin \(B\)kanssa ja matriisi \(B\)on riviekvivalentti matriisin \(C\)kanssa, niin \(A\)on riviekvivalentti matriisin \(C\)kanssa.
                </ol><!-- \end{aakkosta*}


                <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                    a) Käydään läpi todistuksen idea. Oletetaan, että matriisi \(A\)on riviekvivalentti matriisin \(B\)kanssa. Nyt on olemassa alkeisrivitoimitukset, joiden avulla matriisi \(A\)voidaan muuttaa matriisiksi \(B\). Jokainen alkeisrivitoimitus voidaan kuitenkin peruuttaa toisella alkeisrivitoimituksella kuten kohta nähdään. Kutsutaan tätä alkeisrivitoimitusta alkuperäisen alkeisrivitoimituksen <strong>käänteistoimitukseksi}.

                        Oletetaan, että \(a,b \in \R\)ja \(a \neq 0\). Jos matriisille tehdään alkeisrivitoimitus \(R_i \leftrightarrow R_j\), päästään takaisin alkutilanteeseen tekemällä sama alkeisrivitoimitus uudelleen. Alkeisrivitoimitus \(R_i \leftrightarrow R_j\)on siis itsensä käänteistoimitus. Alkeisrivitoimituksen \(aR_i\)käänteistoimitus on puolestaan \(\frac{1}{a}R_i\), ja alkeisrivitoimituksen \(R_i+bR_j\)käänteistoimitus on \(R_i-bR_j\).

                        Matriisille \(A\)on siis tehty alkeisrivitoimituksia ja niiden avulla on päädytty matriiisin \(B\). Jos matriisille \(B\)tehdään samojen alkeisrivitoimitusten käänteistoimitukset päinvastaisessa järjestyksessä, saadaan matriisi \(A\). Siten matriisi \(B\)on riviekvivalentti matriisin \(A\)kanssa.

                        b) Todistus jätetään harjoitustehtäväksi.
                </div>

                \end{comment} -->
            </div>
        </section>
        <section class="kappaleraja" id="6">
            <div div class="kappaleraja-linis" id="Vapaus" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                <h1>Vapaus</h1> <!-- \label{vapausLuku} -->

                <!-- %Tutkitaan seuraavaksi sellaisia vektorijonoja, jotka virittävät koko avaruuden. Esimerkiksi jono ?? <!-- %virittää avaruuden \(\R^2\), sillä jokainen avaruuden vektori on muotoa ??. Toisaalta myös jono ?? <!-- %virittää avaruuden \(\R^2\). -->

                <!-- %Tutkitaan vektoreiden ?? virittämää aliavaruutta. Huomataan, että myös vektoreiden ?? ja ??. <!-- %Alkuperäisessä vektorijonossa/joukossa oli siis tavallaan turha vektori, jota ei tarvita virittämiseen. -->

                <!-- %Tutkitaan vektoreiden ?? virittämää aliavaruutta. Vektori ?? kuuluu siihen, -->
                <!-- %sillä ??. Vektori ?? voidaan kirjoittaa myös toisella tavalla virittäjien -->
                <!-- %lineaarikombinaationa. -->

                <!-- %<div class="maar"><h3>Määritelmä</h3> -->
                <!-- %Vektorijono \(\vv_1,\vv_2,\dots,\vv_n\)on aliavaruuden \(W=\span(\vv_1,\vv_2,\dots,\vv_n)\)kanta, jos <!-- %jokainen aliavaruuden \(W\)vektori voidaan kirjoittaa täsmälleen yhdellä tavalla vektorien <!-- %\(\vv_1,\vv_2,\dots,\vv_n\)lineaarikombinaationa. -->
                <!-- %</div> -->

                Edellisen luvun lopussa tutkittiin vektoreiden \(\vu_1=(1,1,0)\), \(\vu_2=(1,0,1)\), \(\vu_3=(0,1,1)\)ja \(\vu_4=(-2,1,1)\)virittämää aliavaruutta \(W=\vir(\vu_1,\vu_2,\vu_3,\vu_4)\). Silloin huomattiin, että aliavaruuden vektorin voi kirjoitta monella eri tavalla virittäjävektoreiden lineaarikombinaationa. Esimerkiksi nollavektorin voi kirjoittaa muodossa \(\nv=0\vu_1+0\vu_2+0\vu_3+0\vu_4\), muodossa \(\nv=1\vu_1+1\vu_2+(-2)\vu_3+1\vu_4\)tai muodossa \(\nv=2\vu_1+2\vu_2+(-4)\vu_3+2\vu_4\). Tämä ei ole toivottavaa, sillä yleensä halutaan, että vektorit on mahdollista kirjoittaa virittäjävektorien lineaarikombinaationa täsmälleen yhdellä tavalla. Tällöin vaikkapa nollavektori saadaan aikaiseksi <strong>ainoastaan} niin, että jokaisen virittäjävektorin kertoimena on nolla. Tavoitteen täyttävää virittäjäjoukkoa kutsutaan vapaaksi.

                    <h2>Vapauden määritelmä}

                        <div class="maar"><h3>Määritelmä</h3> 
                            Oletetaan, että \(\vv_1,\vv_2,\dots,\vv_k \in \R^n\). Vektorijono \((\vv_1,\vv_2,\dots,\vv_k)\)on <strong>vapaa</strong><!-- \index{vapaa} --> eli <strong>lineaarisesti riippumaton</strong><!-- \index{lineaarisesti riippumaton} -->, jos seuraava ehto pätee:
                            \[
                            \text{jos}  c_1\vv_1+c_2\vv_2+\dots+c_k\vv_k=\nv  \text{joillakin \(c_1,\dots,c_k \in \R\),}
                            \]
                            niin \(c_1=0\), \(c_2=0\), \dots, \(c_k=0\).
                            }

                            Jos jono \((\vv_1,\vv_2,\dots,\vv_k)\)on vapaa eli lineaarisesti riippumaton, voidaan myös sanoa, että vektorit
                            \(\vv_1,\vv_2,\dots,\vv_k\)ovat lineaarisesti riippumattomia toisistaan. Jos jono ei ole
                            vapaa, sanotaan, että se on <strong>sidottu</strong><!-- \index{sidottu} -->.

                            <strong>Huom. 1.} Vektorijonolla \((\vv_1,\vv_2,\dots,\vv_k)\)tarkoitetaan yksinkertaisesti tiettyjen vektorien muodostamaa kokoelmaa. Sitä ei saa sekoittaa vektorimerkintään. Kyseessä ei siis ole jonkinlainen ''vektorien vektori''.

                                <strong>Huom. 2.} Määritelmän ehto voidaan ilmaista muodossa ''vektorien lineaarikombinaatio on nolla vain, jos kaikki kertoimet ovat nollia''.
                                    <!-- %on ''jos\dots niin''-muotoinen, ja asioiden järjestys on olennaista. Tarkoitus on sanoa, että <strong>jos} lineaarikombinaatio on nollavektori, niin kaikki kertoimet \(c_i\)ovat nollia. Toisinpäin ehto pätisi joka tapauksessa aina. -->


                                    Tullaan näkemään, että jos jono \((\vv_1,\vv_2,\dots,\vv_k)\)on vapaa, aliavaruuden \(\vir(\vv_1,\vv_2,\dots,\vv_k)\)alkiot voidaan kirjoittaa täsmälleen yhdellä tavalla virittäjävektorien lineaarikombinaatioina. Virittäjien joukossa ei siis tällöin ole tarpeettomia vektoreita. Katsotaan ensin kuitenkin muutamia esimerkkejä.

                                    <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"><!-- \label{vapaaEsim} -->
                                            Merkitään \(\ve_1 = (1,0)\)ja \(\ve_2 = (0,1)\). Osoitetaan, että avaruuden \(\R^2\)jono \((\ve_1,\ve_2)\)on vapaa. Oletetaan, että reaaliluvut \(c_1\)ja
                                            \)c_2\)ovat sellaisia, että
                                            \[c_1\ve_1+c_2\ve_2=\nv.\]
                                            Nyt \(c_1(1,0)+c_2(0,1)=(0,0)\), joten \((c_1,c_2)=(0,0)\). Täytyy siis päteä \(c_1=0\)ja
                                            \)c_2=0\). Näin on osoitettu, että jono \((\ve_1,\ve_2)\)on vapaa.
                                            \begin{center}
                                            <div class="image">

                                                <!-- %\resizebox{\columnwidth}{!}{{kuva7.png" />} -->
                                                <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva49.png" />
                                                <strong>Kuva: </strong>Jono \((\ve_1, \ve_2)\)on vapaa. <!-- \label{k49}} -->
                                            </div>
                                            \end{center}
                                        </div></div>

                                    <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                            Merkitään \(\vv_1 = (1,2)\)ja \(\vv_2 = (-3,-1)\). Tutkitaan, onko jono \((\vv_1, \vv_2)\)vapaa vai sidottu.

                                            Oletetaan, että \(c_1\vv_1 + c_2\vv_2 = \nv\)joillakin \(c_1\), \(c_2 \in \R\).
                                            Nyt
                                            \[
                                            c_1(1,2) + c_2(-3,-1) = (0,0)
                                            \]
                                            eli
                                            \[
                                            \left\{
                                            \begin{aligned}
                                            c_1-3c_2&=0 \\
                                            2c_1-c_2&=0.
                                            \end{aligned}
                                            \right.
                                            \]
                                            Ratkaistaan tästä \(c_1\)ja \(c_2\):
                                            \begin{align*}
                                            \begin{bmatrix}[rr|c]
                                            1&-3&0\\
                                            2&-1&0\\
                                            \end{bmatrix}
                                            \overset{R_2-2R_1}{\longrightarrow}
                                            \begin{bmatrix}[rr|c]
                                            1&-3&0\\
                                            0&5&0\\
                                            \end{bmatrix}
                                            \overset{\frac{1}{5}R_2}{\longrightarrow}
                                            \begin{bmatrix}[rr|c]
                                            1&-3&0\\
                                            0&1&0\\
                                            \end{bmatrix}
                                            \overset{R_1+3R_2}{\longrightarrow}
                                            \begin{bmatrix}[rr|c]
                                            1&0&0\\
                                            0&1&0\\
                                            \end{bmatrix}.
                                            \end{align*}
                                            Ainoa ratkaisu on \(c_1 = 0\)ja \(c_2 = 0\). Jono \((\vv_1, \vv_2)\)on siis vapaa.
                                            \begin{center}
                                            <div class="image">

                                                <!-- %\resizebox{\columnwidth}{!}{{kuva7.png" />} -->
                                                <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva45.png" />
                                                <strong>Kuva: </strong>Jono \((\vv_1, \vv_2)\)on vapaa. <!-- \label{k45}} -->
                                            </div>
                                            \end{center}
                                        </div></div>

                                    <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                            Kun osoitetaan jono sidotuksi, ei välttämättä tarvitse ratkaista yhtälöryhmää. Toisinaan on nimittäin helppo nähdä, minkälaisten kertoimien avulla lineaarikombinaatiosta muodostuu nollavektori.

                                            Merkitään \(\vw_1 = (2,1)\)ja \(\vw_2 = (-4,-2)\). Huomataan, että
                                            \[
                                            2\vw_1+\vw_2=\nv.
                                            \]
                                            Koska vektorien \(\vw_1\)ja \(\vw_2\)lineaarikombinaatio on nollavektori, vaikka kertoimet eivät ole nollia, jono \((\vw_1, \vw_2)\)on määritelmän nojalla sidottu.
                                        </div></div>

                                    <!-- %Huomaa, että vapautta tutkittaessa saadaan ratkaistavaksi homogeeninen <!-- %yhtälöryhmä. (Ks. luku \ref{homogeeninenLuku}.) -->

                                    <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                            Merkitään \(\vv_1 = (1,2)\), \(\vv_2 = (-3,-1)\)ja \(\vv_3 = (-1,1)\). Tutkitaan, onko jono \((\vv_1, \vv_2, \vv_3)\)vapaa vai sidottu.
                                            Oletetaan, että \(c_1\vv_1 + c_2\vv_2 + c_3\vv_3 = \nv\)joillakin \(c_1\), \(c_2\), \(c_3 \in \R\).
                                            Tällöin
                                            \[
                                            c_1(1,2) + c_2(-3,-1) + c_3(-1,1) = (0,0)
                                            \]
                                            eli
                                            \[
                                            \left\{
                                            \begin{aligned}
                                            c_1-3c_2-c_3&=0 \\
                                            2c_1-c_2+c_3&=0.
                                            \end{aligned}
                                            \right.
                                            \]
                                            Ratkaistaan tästä \(c_1\)ja \(c_2\):
                                            \begin{align*}
                                            &\begin{bmatrix}[rrr|c]
                                            1&-3&-1&0\\
                                            2&-1&1&0\\
                                            \end{bmatrix}
                                            \overset{R_2-2R_1}{\longrightarrow}
                                            \begin{bmatrix}[ccc|c]
                                            1&-3&-1&0\\
                                            0&5&3&0\\
                                            \end{bmatrix} \\[2mm]
                                            \overset{\frac{1}{5}R_2}{\longrightarrow}
                                            &\begin{bmatrix}[rrr|c]
                                            1&-3&-1&0\\
                                            0&1&3/5&0\\
                                            \end{bmatrix}
                                            \overset{R_1+3R_2}{\longrightarrow}
                                            \begin{bmatrix}[rrr|c]
                                            1&0&4/5&0\\
                                            0&1&3/5&0\\
                                            \end{bmatrix}.
                                            \end{align*}
                                            Huomataan, että yhtälöryhmällä on äärettömän monta ratkaisua:
                                            \[
                                            \left\{
                                            \begin{aligned}
                                            x_1 &=-(4/5)t \\
                                            x_2 &= -(3/5)t \\
                                            x_3&=t
                                            \end{aligned}
                                            \right.  \text{missä \(t \in \R\).}
                                            \]
                                            Näin ollen \(c_1=0\), \(c_2=0\), \(c_3=0\)ei ole ainoa ratkaisu.
                                            Voidaan valita esimerkiksi \(t= 5\), jolloin \(c_1 = -4\)ja \(c_2 = -3\)ja \(c_3=5\). Tällöin \(-4\vv_1 - 3\vv_2+5\vv_3 = \nv\). Jono \((\vv_1, \vv_2, \vv_3)\)on siis sidottu. Tilannetta on havainnollistettu kuvassa alla <!-- \ref{k-->46&52}.
                                            \begin{center}
                                            <div class="image">

                                                <!-- %\resizebox{\columnwidth}{!}{{kuva7.png" />} -->
                                                <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva46.png" />
                                                <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva52.png" />
                                                <strong>Kuva: </strong>Jono \((\vv_1, \vv_2,\vv_3)\)on sidottu. <!-- \label{k46&52}} -->
                                            </div>
                                            \end{center}
                                        </div></div>

                                    Määritelmän mukaan jonon vapaus kertoo siitä, että nollavektori voidaan kirjoittaa vain yhdellä tavalla jonon vektorien lineaarikombinaationa. Selvästikin yhtälö
                                    \[
                                    c_1\vv_1+\dots+c_k\vv_k=\nv
                                    \]
                                    toteutuu ainakin, jos kertoimiksi \(c_1,\dots,c_k\)valitaan nollat. Toisinaan yhtälö kuitenkin toteutuu myös joillakin muilla kertoimilla.
                                    Jono on vapaa, jos yhtälö toteutuu <strong>ainoastaan nollakertoimilla}.<!-- % lineaarikombinaationa <strong>täsmälleen yhdellä tavalla}. -->

                                        Seuraava lause osoittaa, että vektorijono \((\vv_1,\dots,\vv_k)\)on vapaa, jos ja vain
                                        jos aliavaruuden \(\vir(\vv_1,\dots,\vv_k)\)kaikki vektorit voidaan ilmaista
                                        täsmälleen yhdellä tavalla virittäjävektorien \(\vv_1,\dots,\vv_k\)
                                        lineaarikombinaatioina. Siis jos nollavektori voidaan kirjoittaa vain yhdellä tavalla virittäjävektoreiden lineaarikombinaationa, myös kaikki muut aliavaruuden \(\vir(\vv_1,\dots,\vv_k)\)vektorit voidaan kirjoittaa vain yhdellä tavalla virittäjävektoreiden lineaarikombinaationa, ja päinvastoin.
                                        Vapaat vektorijonot ovat kiinnostavia nimenomaan sen vuoksi,
                                        että niistä saadaan virittäjäjoukko, jossa ei ole turhia
                                        vektoreita.

                                        <div class="lause"><h3>Lause</h3> <!-- \label{vapausLause} -->
                                            Oletetaan, että \(\vv_1,\vv_2,\dots,\vv_k \in \R^n\). Jono
                                            \)(\vv_1,\vv_2,\dots,\vv_k)\)on vapaa, jos ja vain jos jokainen
                                            aliavaruuden \(\vir(\vv_1,\vv_2,\dots,\vv_k)\)alkio voidaan kirjoittaa
                                            täsmälleen yhdellä tavalla vektorien \(\vv_1,\vv_2,\dots,\vv_k\)
                                            lineaarikombinaationa.


                                            <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                Muotoa ''jos ja vain jos'' oleva väite todistetaan kahdessa osassa. Ensin oletetaan väitteen ensimmäisen osan olevan totta ja osoitetaan, että tällöin jälkimmäinen osa pätee. Tätä todistuksen vaihetta merkitään usein symbolilla ''\(\Rightarrow\)''. Sitten oletetaan jälkimmäisen osan olevan totta ja osoitetaan, että tällöin ensimmäinen osa pätee. Tätä todistuksen vaihetta merkitään symbolilla ''\(\Leftarrow\)''. Ryhdytään todistamaan väitettä.

                                                ''\(\Rightarrow\)'': Oletetaan ensin, että jono \((\vv_1,\vv_2,\dots,\vv_k)\)on vapaa. Osoitetaan,
                                                että jokainen aliavaruuden \(W=\vir(\vv_1,\vv_2,\dots,\vv_k)\)alkio voidaan
                                                kirjoittaa täsmälleen yhdellä tavalla virittäjävektorien \(\vv_1,\vv_2,\dots,\vv_k\)
                                                lineaarikombinaationa. Oletetaan, että alkio \(w \in W\)voidaan kirjoittaa
                                                lineaarikombinaationa
                                                \begin{equation}<!-- \label{yhtalo:eka_lineaarikombinaatio} -->
                                                \vw=a_1\vv_1+\dots+a_k\vv_k
                                                \end{equation}
                                                ja lineaarikombinaationa
                                                \begin{equation}<!-- \label{yhtalo:toka_lineaarikombinaatio} -->
                                                \vw=b_1\vv_1+\dots+b_k\vv_k
                                                \end{equation}
                                                joillakin \(a_1,\dots,a_k,b_1,\dots,b_k \in \R\).
                                                Nyt \(a_1\vv_1+\dots+a_k\vv_k=b_1\vv_1+\dots+b_k\vv_k\), joten
                                                \[
                                                a_1\vv_1+\dots+a_k\vv_k-(b_1\vv_1+\dots+b_k\vv_k)=\nv.
                                                \]
                                                Vektorien yhteenlaskun ja skalaarikertolaskun ominaisuuksien perusteella pätee
                                                \[
                                                (a_1-b_1)\vv_1+\dots+(a_k-b_k)\vv_k = \nv.
                                                \]
                                                Jono \((\vv_1,\vv_2,\dots,\vv_k)\)on oletuksen nojalla vapaa, joten yllä olevasta yhtälöstä seuraa, että kaikki kertoimet ovat nollia: \(a_1-b_1=0\), \dots, \(a_k-b_k=0\). Siten \(a_1=b_1\), \dots, \(a_k=b_k\). Näin ollen
                                                tutkitut lineaarikombinaatiot \eqref{yhtalo:eka_lineaarikombinaatio} ja \eqref{yhtalo:toka_lineaarikombinaatio} ovatkin itse asiassa samanlaiset (niissä on samat kertoimet). Siksi vektoria \(\vw\)ei voida kirjoittaa usealla eri tavalla virittäjävektoreiden lineaarikombinaationa.

                                                ''\(\Leftarrow\)'': Oletetaan sitten, että jokainen aliavaruuden \(W=\vir(\vv_1,\vv_2,\dots,\vv_k)\)
                                                alkio voidaan kirjoittaa täsmälleen yhdellä tavalla virittäjävektorien
                                                \(\vv_1,\vv_2,\dots,\vv_k\)lineaarikombinaationa. Osoitetaan, että jono
                                                \)(\vv_1,\vv_2,\dots,\vv_k)\)on vapaa. Sitä varten oletetaan, että luvut
                                                \)c_1,\dots,c_k \in \R\)ovat sellaisia, että
                                                \[
                                                c_1\vv_1+c_2\vv_2+\dots+c_k\vv_k=\nv.
                                                \]
                                                Tiedetään, että ainakin
                                                \[
                                                0\vv_1+0\vv_2+\dots+0\vv_k=\nv.
                                                \]
                                                Koska nollavektori \(\nv\)on aliavaruuden \(W\)alkio, se voidaan oletuksen mukaan kirjoittaa virittäjävektorien lineaarikombinaationa täsmälleen yhdellä tavalla. Siksi pätee \(c_1=0\), \dots, \(c_k=0\). Siis jono \((\vv_1,\vv_2,\dots,\vv_k)\)on vapaa.
                                            </div>

                                            Kahden vektorin tapauksessa lineaarinen riippumattomuus on helppo tarkistaa. Rittää tutkia, ovatko vektorit yhdensuuntaisia.
                                            <div class="lause"><h3>Lause</h3><!-- \label{lause:vapausJaYhdensuuntaisuus} -->
                                                Oletetaan, että \(\vv, \vw \in V\)ja kumpikaan vektoreista ei ole nollavektori. Tällöin \((\vv,\vw)\)on vapaa, jos ja vain jos vektorit \(\vv\)ja \(\vw\)eivät ole yhdensuuntaisia.


                                                <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                    Todistus jätetään harjoitustehtäväksi.
                                                </div>

                                                <!-- %Todistetaan vielä muutama vapauteen liittyvä tulos. -->
                                                Seuraava lause osoittaa, että vektorijono on sidottu, jos ja vain jos jokin sen vektoreista voidaan ilmaista toisten lineaarikombinaationa.
                                                <div class="lause"><h3>Lause</h3> <!-- \label{sidottuLause} -->
                                                    Oletetaan, että \(\vv_1,\vv_2,\dots,\vv_k \in \R^n\)ja \(k \ge 2\). Jono
                                                    \)(\vv_1,\vv_2,\dots,\vv_k)\)on sidottu, jos ja vain jos
                                                    \[\vv_j \in \vir(\vv_1,\dots,\vv_{j-1},\vv_{j+1},\dots,\vv_k)\]
                                                    jollakin \(j \in \{1,2,\dots,k\}\).


                                                    <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                        ''\(\Rightarrow\)'': Oletetaan, että jono \((\vv_1,\vv_2,\dots,\vv_k)\)on sidottu. On siis olemassa reaaliluvut \(c_1,\dots,c_k\), joilla pätee
                                                        \[c_1\vv_1+c_2\vv_2+\dots+c_k\vv_k=\nv,\]
                                                        ja lisäksi \(c_j \neq 0\)jollakin \(j \in \{1,2,\dots,k\}\). Nyt
                                                        \[c_j\vv_j=-c_1\vv_1- \dots -c_{j-1}\vv_{j-1}-c_{j+1}\vv_{j+1}- \dots -c_k\vv_k\]
                                                        ja edelleen
                                                        \[\vv_j=-\frac{c_1}{c_j}\vv_1- \dots -\frac{c_{j-1}}{c_j}\vv_{j-1}-\frac{c_{j+1}}{c_j}\vv_{j+1}- \dots -\frac{c_k}{c_j}\vv_k.\]
                                                        Siis \(\vv_j \in  \vir(\vv_1,\dots,\vv_{j-1},\vv_{j+1},\dots,\vv_k)\).

                                                        ''\(\Leftarrow\)'':
                                                        Oletetaan sitten, että \[\vv_j \in \vir(\vv_1,\dots,\vv_{j-1},\vv_{j+1},\dots,\vv_k)\]
                                                        jollakin \(j \in \{1,2,\dots,k\}\). Nyt on olemassa sellaiset \(c_1,\dots,c_{j-1},c_{j+1},\dots,c_k \in \R\), että
                                                        \[\vv_j=c_1\vv_1+\dots +c_{j-1}\vv_{j-1}+c_{j+1}\vv_{j+1}+ \dots +c_k\vv_k.\]
                                                        Tästä seuraa, että
                                                        \[\nv = c_1\vv_1+ \dots +c_{j-1}\vv_{j-1}+(-1)\vv_j+c_{j+1}\vv_{j+1}+ \dots +c_k\vv_k.\]
                                                        Koska kerroin \(-1\)ei ole nolla, on jono \((\vv_1,\vv_2,\dots,\vv_k)\)sidottu.
                                                    </div>

                                                    <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                            Tarkastellaan eräitä avaruuden \(\R^3\)vektoreita \(\vv_1 = (1,-1,0)\), \(\vv_2 = (1,1,0)\), \(\vv_3 = (0,0,2)\)ja \(\vv_4 = (3,-1,0)\). Näillä pätee muun muassa
                                                            \[
                                                            2\vv_1  + \vv_2 - \vv_4 = \nv,
                                                            \]
                                                            joten jono \((\vv_1,\vv_2, \vv_3, \vv_4)\)on sidottu. Edellisen lauseen perusteella jokin vektoreista voidaan kirjoittaa toisten lineaarikombinaationa. Yllä olevasta yhtälöstä nähdäänkin, että
                                                            \[
                                                            \vv_2 = -2\vv_1 + \vv_4.
                                                            \]
                                                            Kaikkia vektoreita ei kuitenkaan välttämättä voida kirjoittaa toisten lineaarikombinaationa. Esimerkiksi ei ole olemassa sellaisia lukuja \(a\), \(b\)ja \(c\), että pätisi
                                                            \[
                                                            \vv_3 \neq a\vv_1 + b\vv_2 + c\vv_4.
                                                            \]
                                                            (Tämän täsmällinen todistaminen jätetään lukijalle.)
                                                        </div></div>

                                                    <!-- \begin{comment}
                                                    <div class="lause"><h3>Lause</h3>
                                                    Jokainen vapaan jonon osajono on vapaa.
                                                    
                                                    
                                                    <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                    Osajono tarkoittaa jonoa, joka saadaan poistamalla
                                                    alkuperäisestä jonosta vektoreita. Myös jono itse on yksi osajonoista.
                                                    
                                                    Oletetaan, että vektorijono \((\vv_1,\vv_2,\dots,\vv_k)\)on vapaa. Nyt on osoitettava, että mikä tahansa sen osajono on vapaa. Koska vapautta tutkittaessa vektoreiden järjestyksellä ei ole väliä, riittää osoittaa, että
                                                    jono \((\vv_1,\vv_2,\dots,\vv_m)\)on vapaa kaikilla \(1 \ge m \in \ge k\).
                                                    
                                                    Oletetetaan siis, että \(m \in \{1,\dots,k\}\). Olkoot luvut \(c_1,\dots,c_m \in \R\)sellaisia, että
                                                    \[c_1\vv_1+c_2\vv_2+\dots+c_m\vv_m=\nv.\]
                                                    Tästä seuraa, että
                                                    \[c_1\vv_1+c_2\vv_2+\dots+c_m\vv_m+c_{m+1}\vv_{m+1}+\dots+c_k\vv_k=\nv.\]
                                                    Koska jono \((\vv_1,\vv_2,\dots,\vv_k)\)on vapaa, täytyy kaikkien kertoimien olla nollia. Siis \(C_1=0,\dots,c_m=0\). Siten jono \((\vv_1,\vv_2,\dots,\vv_m)\)on vapaa.
                                                    </div>
                                                    
                                                    <!-- %Lauseesta seuraa, että kahden vektorin muodostama jono \((\vv_1,\vv_2)\)on <!-- %sidottu, jos ja vain jos \(\vv_1 \in \vir(\vv_2)\)tai \(\vv_2 \in \vir(\vv_1)\). <!-- %Tämä toteutuu täsmälleen silloin, kun \(\vv_1=t\vv_2\)jollakin \(t \in \R\)tai <!-- %\(\vv_2=t\vv_1\)jollakin \(t \in \R\). Toisin sanoen jono \((\vv_1,\vv_2)\)on <!-- %sidottu, jos ja vain jos \(\vv_1 \parallel \vv_2\). -->

                                                    \end{comment} -->

                                                    <h2>Homogeeniset yhtälöryhmät ja vapaus}<!-- \label{homogeeninenLuku} -->

                                                        Vektorijonon vapautta tutkittaessa päädytään ratkaisemaan yhtälöryhmiä, joissa  vakiot ovat nollia. Tällaista yhtälöryhmää kutsutaan homogeeniseksi.

                                                        <div class="maar"><h3>Määritelmä</h3> 
                                                            Lineaarinen yhtälöryhmä, jonka kaikki vakiot ovat nollia, on nimeltään <strong>homogeeninen yhtälöryhmä</strong><!-- \index{homogeeninen yhtälöryhmä} -->.
                                                            }

                                                            Homogeeninen yhtälöryhmä on siis muotoa
                                                            \[
                                                            \left\{
                                                            \begin{array}{rcl}
                                                            a_{11}x_1 + a_{12}x_2 +\cdots + a_{1n}x_n & = & 0 \\
                                                            a_{21}x_1 + a_{22}x_2 +\cdots + a_{2n}x_n & = & 0 \\
                                                            \vdots\hspace{1.6cm} & & \vdots \\
                                                            a_{m1}x_1 + a_{m2}x_2 +\cdots + a_{mn}x_n & = & 0, \\
                                                            \end{array}
                                                            \right.
                                                            \]
                                                            missä \(a_{11},\dots,a_{mn} \in \R\).
                                                            Homogeenisella yhtälöryhmällä on aina ainakin yksi ratkaisu:
                                                            \[
                                                            x_1 = 0,  x_2 = 0,  \dots  x_n = 0.
                                                            \]
                                                            Tätä kutsutaan yhtälöryhmän triviaaliksi ratkaisuksi.

                                                            <div class="lause"><h3>Lause</h3><!-- \label{homogLause} -->
                                                                Jos homogeenisessa yhtälöryhmässä tuntemattomien määrä \(n\)on suurempi kuin yhtälöiden määrä \(m\), yhtälöryhmällä on äärettömän monta ratkaisua.


                                                                <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                    Ensinnäkin yhtälöryhmällä on välttämättä ainakin triviaali ratkaisu. Siten ratkaisuja on joko yksi tai äärettömän monta.

                                                                    Oletuksen mukaan yhtälöryhmän matriisissa on enemmän sarakkeita kuin rivejä.
                                                                    Johtavia alkioita enintään yksi joka rivillä. Koska sarakkeita on enemmän kuin rivejä, on matriisissa ainakin yksi sarake, jossa ei ole johtavaa alkiota. Siten vapaita muuttujia on ainakin yksi, ja yhtälöryhmällä on äärettömän monta ratkaisua.
                                                                </div>

                                                                \begin{kor} <!-- \label{vapausKorollaari} -->
                                                                Oletetaan, että \(\vv_1\), \(\vv_2,\dots,\vv_n \in \R^m\), missä \(n \in \{1,2,\ldots\}\).
                                                                Jos \(n > m\), niin jono \((\vv_1,\vv_2,\dots,\vv_n)\)on sidottu.
                                                                \end{kor}

                                                                <strong>Huom.</strong> Korollaari on lause joka seuraa suoraan tai lähes suoraan toisesta lauseesta. Tämä korollaari on lauseen \ref{homogLause} seuraus.

                                                                <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                    Merkitään \(\vv_k = (v_{1k}, v_{2k}, \dots, v_{mk})\)kaikilla \(k \in \{1,\dots, n\}\). Nyt
                                                                    yhtälöä \(x_1\vv_1 + x_2\vv_2 + \dots + x_n\vv_n = \nv\)vastaavaksi yhtälöryhmäksi saadaan
                                                                    \[{\left\{
                                                                    \begin{array}{rcl}
                                                                    v_{11}x_1 + v_{12}x_2 +\cdots + v_{1n}x_n & = & 0 \\
                                                                    v_{21}x_1 + v_{22}x_2 +\cdots + v_{2n}x_n & = & 0 \\
                                                                    \vdots\hspace{1.6cm} & & \vdots \\
                                                                    v_{m1}x_1 + v_{m2}x_2 +\cdots + v_{mn}x_n & = & 0.
                                                                    \end{array}
                                                                    \right.}\]

                                                                    Tässä homogeenisessa yhtälöryhmässä on enemmän tuntemattomia kuin yhtälöitä. Siten yhtälöryhmällä on äärettömän monta ratkaisua. Koska löytyy muitakin ratkaisuja kuin triviaaliratkaisu, ei jono \((\vv_1,\vv_2,\dots,\vv_n)\)ole vapaa.
                                                                </div>

                                                                Jos homogeenisessa yhtälöryhmässä tuntemattomien määrä \(n\)on pienempi tai yhtä suuri kuin yhtälöiden määrä \(m\), ei ratkaisujen määrästä voi äkkiseltään sanoa mitään varmaa. Ratkaisuja voi olla täsmälleen yksi (triviaali ratkaisu) tai äärettömän monta. Jos siis avaruuden \(\R^n\)jonon \((\vv_1,\vv_2,\dots,\vv_m)\)pituus \(m\)on <strong>pienempi</strong> kuin \(n\), ei jonon lineaarisesta riippumattomuudesta voida sanoa sen perusteella mitään.
                                                            </div>
                                                            </section>

                                                            <section class="kappaleraja" id="1">
                                                                <div div class="kappaleraja-linis" id="Kanta" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                                                                    <h1>Kanta</h1>

                                                                    Tässä luvussa tarkastellaan aliavaruuden virittäjävektoreita, jotka muodostavat lineaarisesti riippumattoman jonon. Merkintöjen helpottamiseksi oletetaan luvussa koko ajan, että \(W\)on vektoreiden \(\vv_1,\vv_2,\dots,\vv_m \in \R^n\)virittämä avaruuden \(\R^n\)aliavaruus eli
                                                                    \[
                                                                    W=\vir(\vv_1,\vv_2,\dots,\vv_m).
                                                                    \]

                                                                    <div class="maar"><h3>Määritelmä</h3>
                                                                        Olkoot \(\vw_1,\vw_2,\dots,\vw_k \in W\).
                                                                        Vektorijono \((\vw_1,\vw_2,\dots,\vw_k)\)on aliavaruuden \(W\)<strong>kanta</strong><!-- \index{kanta} -->, jos seuraavat ehdot pätevät:
                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                            <li> \(W=\vir(\vw_1,\vw_2,\dots,\vw_k)\)
                                                                            <li> jono \((\vw_1,\vw_2,\dots,\vw_k)\)on vapaa.
                                                                        </ol><!-- \end{aakkosta*} -->
                                                                        }

                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                Esimerkissä \ref{virLuonnollinenEsim} osoitettiin, että vektorit \(\ve_1 =
                                                                                (1,0)\)ja \(\ve_2 = (0,1)\)virittävät avaruuden \(\R^2\). Jono \((\ve_1,\ve_2)\)on
                                                                                lisäksi vapaa esimerkin \ref{vapaaEsim} perusteella. Siten \((\ve_1,\ve_2)\)on
                                                                                avaruuden \(\R^2\)kanta.

                                                                                Vastaavasti avaruudella \(\R^n\)on kanta
                                                                                \[
                                                                                (\ve_1,\ve_2,\dots,\ve_n).
                                                                                \]
                                                                                Tässä \(\ve_i=(0,\dots,0,1,0,\dots,0)\), missä luku 1 on vektorin \(i\):s komponentti. Kantaa kutsutaan avaruuden \(\R^n\)
                                                                                <strong>luonnolliseksi kannaksi}. Lukijan tehtäväksi jätetään osoittaa, että
                                                                                    kyseessä on todellakin kanta.
                                                                            </div></div>

                                                                        Kannan vektorit siis virittävät aliavaruuden, ja lisäksi kanta on vapaa. Lauseesta~\ref{vapausLause} saadaan seuraava hyvin käyttökelpoinen tulos:
                                                                        <!-- \begin{comment}
                                                                        Koska kanta virittää
                                                                        aliavaruuden \(W\), voidaan kaikki aliavaruuden \(W\)
                                                                        vektorit ilmaista kantavektoreiden lineaarikombinaatioina. Toisaalta
                                                                        kanta on vapaa, mikä on lauseen \ref{vapausLause} perusteella yhtäpitävää sen
                                                                        kanssa, että jokainen aliavaruuden \(W\)vektori voidaan ilmaista
                                                                        yksikäsitteisesti kannan vektoreiden lineaarikombinaationa. Näin saadaan
                                                                        seuraava lause.
                                                                        \end{comment} -->
                                                                        <div class="lause"><h3>Lause</h3><!-- \label{kantaEhtoLause} -->
                                                                            Jono \((\vw_1,\vw_2,\dots,\vw_k)\)on aliavaruuden \(W\)kanta, jos ja vain jos
                                                                            jokainen aliavaruuden \(W\)vektori voidaan kirjoittaa täsmälleen yhdellä tavalla
                                                                            vektoreiden \(\vw_1,\vw_2,\dots,\vw_k\)lineaarikombinaationa.


                                                                            <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                ''\(\Rightarrow\)'': Oletetaan, että jono \((\vw_1,\dots,\vw_k)\)on aliavaruuden \(W\)kanta. Tällöin kannan määritelmän nojalla \(W = \vir(\vw_1,\dots,\vw_k)\)ja jono \((\vw_1,\dots,\vw_k)\)on vapaa. Lauseesta \ref{vapausLause} seuraa, että jokainen aliavaruuden \(W = \vir(\vw_1,\dots,\vw_k)\)vektori voidaan kirjoittaa tasan yhdellä tavalla
                                                                                vektoreiden \(\vw_1,\dots,\vw_k\)lineaarikombinaationa.


                                                                                ''\(\Leftarrow\)'': Oletetaan, että jokainen aliavaruuden \(W\)vektori voidaan kirjoittaa täsmälleen yhdellä tavalla
                                                                                vektoreiden \(\vw_1,\dots,\vw_k\)lineaarikombinaationa. Tästä seuraa heti, että \(W = \vir(\vw_1,\dots,\vw_k)\). Nyt lauseen~\ref{vapausLause} mukaan jono \((\vw_1,\dots,\vw_k)\)on vapaa. Näin kannan määritelmän molemmat ehdot täyttyvät. Siis \((\vw_1,\dots,\vw_k)\)on aliavaruuden \(W\)kanta.
                                                                            </div>

                                                                            <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"><!-- \label{kantaEhtoEsim} -->
                                                                                    Merkitään \(\vw_1 = (2,-1)\), \(\vw_2 = (1,3)\).
                                                                                    Osoitetaan lauseen alla <!-- \ref{k-->antaEhtoLause} avulla, että \((\vw_1, \vw_2)\)on avaruuden \(\R^2\)kanta.  Oletetaan, että \(\vv \in \R^2\). Ratkaistaan yhtälö \(x_1\vw_1 + x_2\vw_2 = \vv\)eli yhtälö
                                                                                    \)x_1(2,-1) + x_2(1,3) = (v_1,v_2)\). Sitä vastaa yhtälöryhmä
                                                                                    \[
                                                                                    \left\{
                                                                                    \begin{aligned}
                                                                                    2x_1+x_2 & =v_1 \\
                                                                                    -x_1+3x_2 & =v_2.
                                                                                    \end{aligned}
                                                                                    \right.
                                                                                    \]
                                                                                    Kun yhtälöryhmän matriisia muokataan alkeisrivitoimituksilla, saadaan matriisi
                                                                                    \[
                                                                                    \begin{bmatrix}[cc|c]
                                                                                    1 & 0 & \frac{1}{7}(3v_1-v_2) \\[2pt]
                                                                                    0 & 1 & \frac{1}{7}(v_1+2v_2) \\
                                                                                    \end{bmatrix}.
                                                                                    \]
                                                                                    Matriisista nähdään, että yhtälöryhmällä on täsmälleen yksi ratkaisu riippumatta vektorista \(\vv \in \R^2\). Siis jono \((\vw_1, \vw_2)\)on avaruuden \(\R^2\)kanta.
                                                                                </div></div>

                                                                            <h2>Koordinaatit</h2>

                                                                            Kun aliavaruuden vektori kirjoitetaan kannan vektorien lineaarikombinaationa, kertoimia kutsutaan vektorin koordinaateiksi.

                                                                            <div class="maar"><h3>Määritelmä</h3>
                                                                                Oletetaan, että \(\mathcal{B}=(\vw_1,\dots,\vw_k)\)on
                                                                                aliavaruuden \(W\)kanta. Oletetaan, että \(\vu \in W\).
                                                                                Vektorin \(\vu\)
                                                                                <strong>koordinaateiksi kannan \(\mathcal{B}\)suhteen</strong><!-- \index{koordinaatit} --> kutsutaan reaalilukuja \(b_1,\dots,b_k\), joilla \[\vu=b_1\vw_1+\dots+b_k\vw_k\,.\]
                                                                                }

                                                                                <strong>Huom.</strong> Vektorin koordinaatit jonkin tietyn kannan suhteen ovat yksikäsitteiset, sillä vektori voidaan lauseen~alla <!-- \ref{k-->antaEhtoLause} mukaan kirjoittaa vain yhdellä tavalla kannan alkioiden lineaarikombinaationa. Vektorilla on siis kunkin tietyn kannan suhteen vain yhdet koordinaatit. Eri kantojen suhteen saman vektorin koordinaatit voivat tietenkin olla erilaisia.

                                                                                <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                        Luonnollisen kannan suhteen koordinaatit on helppo määrittää.
                                                                                        Esimerkiksi vektorin \(\va=(-1,-4)\)koordinaatit avaruuden \(\R^2\)luonnollisen kannan \(\kE_2 = (\ve_1, \ve_2)\)suhteen ovat \(-1\)ja \(-4\), sillä
                                                                                        \(\va =(-1,-4) =  (-1)(1,0) + (-4)(0,1) = (-1)\ve_1 + (-4)\ve_2\).

                                                                                        \begin{center}
                                                                                        <div class="image">

                                                                                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva129.png" />
                                                                                            <strong>Kuva: </strong>Vektorin \(\va\)koordinaatit kannan \(\kE_2 = (\ve_1, \ve_2)\)suhteen ovat \(-1\)ja \(-4\). <!-- \label{k129}} -->
                                                                                        </div>
                                                                                        \end{center}

                                                                                        Tutkitaan sitten erästä toista avaruuden \(\R^2\)kantaa. Merkitään \(\vv_1 = (2,-1)\), \(\vv_2 = (1,3)\).
                                                                                        Nyt \(\kB=(\vv_1, \vv_2)\)on avaruuden \(\R^2\)kanta, minkä osoittaminen jätetään lukijalle. Määritetään vektorin \(\va=(-1,-4)\)koordinaatit kannan \(\kB\)suhteen. On ratkaistava yhtälö
                                                                                        \(\va=x_1\vv_1+x_2\vv_2\)eli yhtälö
                                                                                        \[(-1,-4)=x_1(2,-1)+x_2(1,3).\]
                                                                                        Tästä yhtälöstä saadaan tuttuun tapaan yhtälöryhmä, jonka ratkaisuksi paljastuu \(x_1=3\), \(x_2=2\).
                                                                                        <!-- %\[ -->
                                                                                        <!-- %\left\{ -->
                                                                                        <!-- %\begin{aligned} -->
                                                                                        <!-- %x_1 & =3 \\ -->
                                                                                        <!-- %x_2 & =2. -->
                                                                                        <!-- %\end{aligned} -->
                                                                                        <!-- %\right. -->
                                                                                        <!-- %\] -->
                                                                                        Näin ollen \(\va=3\vv_1+2\vv_2\)eli vektorin \(\va\)koordinaatit kannan \(\kB\)suhteen ovat 3 ja 2. 

                                                                                        Vektorin \(\va=(-1,-4)\)koordinaatteja kannan \(\kB=(\vv_1, \vv_2)\)suhteen on havainnollistettu kuvassa alla <!-- \ref{k-->115}.
                                                                                        Jotta päästään pisteeseen \((-1,-4)\)on mentävä 3 ruutua vektorin \(\vv_1\)suuntaan ja 2 ruutua vektorin \(\vv_2\)suuntaan. Siten vektorin \(\va=(-1,-4)\)koordinaatit kannan \(\kB\)suhteen ovat 3 ja 2.

                                                                                        <div class="image">

                                                                                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva115.png" />
                                                                                            <strong>Kuva: </strong>Vektori \(\va=(-1,-4)\)ilmaistuna kannan \(\kB=(\vv_1, \vv_2)\)vektoreiden lineaarikombinaationa.
                                                                                            Vektorin koordinaatit kannan \(\kB\)suhteen ovat 3 ja 2.}  <!-- \label{k115} -->
                                                                                        </div>

                                                                                        Kun käytetään jotakin muuta kuin luonnollista kantaaa, vääntyy koordinaatisto ikään kuin vinoon. Kuvassa alla <!-- \ref{k-->122} luonnollisen kannan koordinaattiakselit on häivytetty pois ja niiden sijasta näkyvissä ovat kantavektoreiden \(\vv_1\)ja \(\vv_2\)muodostamat koordinaattiakselit.

                                                                                        <div class="image">

                                                                                            <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva122.png" /> 
                                                                                            <strong>Kuva: </strong>Vektori \(\vu=(-1,-4)\)ilmaistuna kannan \(\kB=(\vv_1, \vv_2)\)vektoreiden lineaarikombinaationa. Kun käytetään jotakin muuta kuin luonnollista kantaaa, vääntyy koordinaatisto vinoon.}  <!-- \label{k122} -->
                                                                                        </div>
                                                                                    </div></div>

                                                                                <h2>Dimensio}

                                                                                    Lukijalla on todennäköisesti jonkinlainen kuva siitä, mitä dimensiolla tarkoitetaan. Avaruus \(\R^3\)on kolmiulotteinen eli sen dimensio on kolme. Avaruuden \(\R^2\)dimensio on kaksi samoin kuin kaikkien niiden avaruuden \(\R^3\)tasojen, jotka ovat aliavaruuksia. Avaruuden \(\R\)sekä suorien dimensio on puolestaan yksi.
                                                                                    Dimension määritellään täsmällisesti kannan avulla: avaruuden dimensio on sen kantavektorien lukumäärä.

                                                                                    Ennen dimension määrittelemistä tarvitaan eräs kantoja koskeva lause.

                                                                                    <!-- %Aliavaruudella voi olla useita eri kantoja, mutta jokaisessa niistä on yhtä monta vektoria. -->
                                                                                    <div class="lause"><h3>Lause</h3> <!-- \label{dimensioLause} -->
                                                                                        Aliavaruuden \(W\)jokaisessa kannassa on yhtä monta vektoria.


                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                            Oletetaan, että \(\kB=(\vv_1,\dots,\vv_j)\)ja \(\kC=(\vw_1,\dots,\vw_k)\)ovat molemmat aliavaruuden
                                                                                            \)W\)kantoja. Pyritään osoittamaan, että \(j = k\). Tehdään se osoittamalla, että muut vaihtoehdot \(j < k\)ja \(k < j\)johtavat ristiriitaan.

                                                                                            Oletetaan, että \(j < k\). Tarkastellaan yhtälöä
                                                                                            \begin{equation}
                                                                                            x_1\vw_1 + \dots + x_k\vw_k = \nv\,. <!-- \label{yhtalo} -->
                                                                                            \end{equation}
                                                                                            Koska \(\mathcal{B}\)on \(W\):n kanta, voidaan kaikki kannan \(\mathcal{C}\)vektorit kirjoittaa kannan \(\mathcal{B}\)vektorien lineaarikombinaatioina:
                                                                                            \begin{align*}
                                                                                            \vw_1 &= a_{11}\vv_1 + a_{12}\vv_2 +\dots + a_{1j}\vv_j \\
                                                                                            \vw_2 &= a_{21}\vv_1 + a_{22}\vv_2 +\dots + a_{2j}\vv_j \\
                                                                                            &\vdots \\
                                                                                            \vw_k &= a_{k1}\vv_1 + a_{k2}\vv_2 +\dots + a_{kj}\vv_j
                                                                                            \end{align*}
                                                                                            joillakin \(a_{11},\dots,a_{kj} \in \R\). Sijoittamalla nämä yhtälöön (\ref{yhtalo}) muodostuu yhtäpitävä yhtälö:
                                                                                            \begin{multline*}
                                                                                            x_1(a_{11}\vv_1 + a_{12}\vv_2 + \dots + a_{1j}\vv_j) \\
                                                                                            + x_2(a_{21}\vv_1 + a_{22}\vv_2 + \dots + a_{2j}\vv_j) \\
                                                                                            + \dots \\
                                                                                            + x_k(a_{k1}\vv_1 + a_{k2}\vv_2 +\dots + a_{kj}\vv_j) = \nv,
                                                                                            \end{multline*}
                                                                                            josta saadaan edelleen ryhmittelemällä
                                                                                            \begin{multline*}
                                                                                            (x_1a_{11} + x_2a_{21} + \dots + x_ka_{k1})\vv_1 \\
                                                                                            + (x_1a_{12} + x_2a_{22} + \dots + x_ka_{k2})\vv_2  \\
                                                                                            + \dots \\
                                                                                            + (x_1a_{1j} + x_2a_{2j} + \dots + x_ka_{kj})\vv_j = \nv.
                                                                                            \end{multline*}

                                                                                            Jono \(\mathcal{B} = (\vv_1, \dots, \vv_j)\)on kanta, joten se on vapaa. Siten edellinen yhtälö toteutuu, jos ja vain jos kaikki kertoimet ovat nollia:
                                                                                            \[
                                                                                            \left\{
                                                                                            \begin{array}{rcr}
                                                                                            x_1a_{11} + x_2a_{21} + \dots + x_ka_{k1} & = & 0 \\
                                                                                            x_1a_{12} + x_2a_{22} + \dots + x_ka_{k2} & = & 0 \\
                                                                                            \vdots\hspace{1.6cm} & & \vdots \\
                                                                                            x_1a_{1j} + x_2a_{2j} + \dots + x_ka_{kj} & = & 0 \\
                                                                                            \end{array}
                                                                                            \right.
                                                                                            \]
                                                                                            Kyseessä on homogeeninen yhtälöryhmä, jossa tuntemattomien määrä \(k\)on suurempi kuin yhtälöiden määrä \(j\). Lauseen \ref{homogLause} mukaan yhtälöryhmällä on muitakin ratkaisuja kuin \(x_1 = 0,\)\dots, \(x_k = 0\). Siis jono \(\mathcal{C} = (\vw_1, \dots, \vw_k)\)on sidottu. Tämä on ristiriita, sillä \(\kC\)on aliavaruuden \(W\)kanta.

                                                                                            Tapaus \(j > k\)käsitellään vastaavasti. Tällöinkin päädytään ristiriitaan. Täytyy siis päteä \(j=k\).
                                                                                        </div>

                                                                                        Voidaan osoittaa, että jokaisella avaruuden \(\R^n\)aliavaruudella on kanta. (Tämä todistetaan kurssin toisessa osassa.) Lisäksi edellä nähtiin, että jokaisessa kannassa on yhtä monta vektoria. Kantavektorien lukumäärää kutsutaan avaruuden dimensioksi.

                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                            Aliavaruuden \(W\)<strong>dimensio</strong><!-- \index{dimensio} --> \(\dim(W)\)on aliavaruuden \(W\)kannan
                                                                                            vektoreiden lukumäärä. Jos aliavaruuden dimensio on \(n\), sanotaan, että aliavaruus on
                                                                                            <strong>\)n\)-ulotteinen}.
                                                                                                }

                                                                                                <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                        Avaruuden \(\R^2\)dimensio on \(2\), sillä avaruudella on kanta \((\ve_1,\ve_2)\). Vastaavasti
                                                                                                        avaruuden \(\R^n\)dimensio on \(n\), sillä avaruuden
                                                                                                        luonnollisen kannan vektorien lukumäärä on \(n\).
                                                                                                    </div></div>

                                                                                                <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                        Määritetään avaruuden \(\R^3\)aliavaruuden \(W=\vir((1,3,-1),(0,2,1))\)dimensio. Vektorit \((1,3,-1)\)ja \((0,2,1)\)virittävät avaruuden \(W\). Lisäksi nämä kaksi vektoria ovat lineaarisesti riippumattomia, sillä ne eivät ole yhdensuuntaisia (ks. lause \ref{lause:vapausJaYhdensuuntaisuus}). Siten vektorit \((1,3,-1)\)ja \((0,2,1)\)muodostavat aliavaruuden \(W\)kannan. Koska kannassa on kaksi vektoria, aliavaruuden dimensio on kaksi.

                                                                                                        Huomaa, että aliavaruus \(W\)on taso.
                                                                                                    </div></div>

                                                                                                <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                        Määritetään avaruuden \(\R^3\)aliavaruuden
                                                                                                        \[W=\vir((1,3,-1),(-3,-9,3))\(\)
                                                                                                        dimensio. Vektorit \((1,3,-1)\)ja \((-3,-9,3)\)kylläkin virittävät avaruuden \(W\), mutta ne eivät muodosta aliavaruuden kantaa. Huomataan nimittäin, että \(3(1,3,-1)=(-3,-9,3)\), joten vektorit ovat yhdensuuntaisia ja siksi ne eivät lauseen \ref{lause:vapausJaYhdensuuntaisuus} mukaan ole lineaarisesti riippumattomia kuten kantavektorien pitäisi olla.

                                                                                                        Vaikuttaa siltä, että \(W\)on vektorin \((1,3,-1)\)virittämä aliavaruus eli suora. Osoitetaan tämä täsmällisesti. Ensinnäkin
                                                                                                        \begin{align*}
                                                                                                        W&=\vir((1,3,-1),(-3,-9,3))=\{a(1,3,-1)+b(-3,-9,3)\mid a,b \in \R\} \\
                                                                                                        &=\{a(1,3,-1)-3b(1,3,-1)\mid a,b \in \R\}=\{(a-3b)(1,3,-1) \mid a,b \in \R\}\\
                                                                                                        &\subset\{c(1,3,-1) \mid c \in \R\}= \vir((1,3,-1)).
                                                                                                        \end{align*}
                                                                                                        Toisaalta
                                                                                                        \begin{align*}
                                                                                                        \vir((1,3,-1))&=\{a(1,3,-1) \mid a \in \R\}=\{a(1,3,-1)+0(-3,-9,3) \mid a \in \R\} \\
                                                                                                        &\subset \vir((1,3,-1),(-3,-9,3))=W.
                                                                                                        \end{align*}
                                                                                                        Siis \(W=\vir((1,3,-1))\).

                                                                                                        Näin ollen aliavaruuden \(W\)kannan muodostaa vektori \((1,3,-1)\), joten \(\dim(W)=1\).
                                                                                                    </div></div>

                                                                                                <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                        Merkitään \(\vv_1 = (3,-1,5)\), \(\vv_2 = (2,1,3)\)ja \(\vv_3 = (0,-5,1)\). Määritetään aliavaruuden \(W = \vir(\vv_1, \vv_2, \vv_3)\)dimensio.

                                                                                                        Oletetaan, että \(\vu \in \R^3\). Selvitetään, mikä ehto vektorin \(\vu\)komponenttien pitää toteuttaa, jotta \(\vu\)on aliavaruudessa \(W\).
                                                                                                        Ratkaistaan yhtälö \(x_1\vv_1 + x_2\vv_2 + x_3\vv_3 = \vu\)eli yhtälö
                                                                                                        \[
                                                                                                        x_1(3,-1,5) + x_2(2,1,3) + x_3(0,-5,1) = (u_1,u_2,u_3).
                                                                                                        \]
                                                                                                        Sitä vastaa yhtälöryhmä
                                                                                                        \[
                                                                                                        \left\{
                                                                                                        \begin{aligned}
                                                                                                        3x_1 + 2x_2\hphantom{{}+5x_3}&=u_1 \\
                                                                                                        -x_1 + x_2-5x_3&=u_2 \\
                                                                                                        5x_1 + 3x_2+x_3&=u_3
                                                                                                        \end{aligned}
                                                                                                        \right.
                                                                                                        \]
                                                                                                        Yhtälöryhmän matriisi on
                                                                                                        \[
                                                                                                        \begin{bmatrix}[rrr|c]
                                                                                                        3&2&0&u_1\\
                                                                                                        -1&1&-5&u_2\\
                                                                                                        5&3&1&u_3
                                                                                                        \end{bmatrix},
                                                                                                        \]
                                                                                                        ja se saadaan alkeisrivitoimituksilla muutettua matriisiksi
                                                                                                        \[
                                                                                                        \begin{bmatrix}[rrr|c]
                                                                                                        1 & -1 & 5 & -u_2 \\
                                                                                                        0 & 1 & -3 & \frac{1}{5}(u_1+3u_2) \\
                                                                                                        0 & 0 & 0 & \frac{1}{5}(5u_3+u_2-8u_1)
                                                                                                        \end{bmatrix}.
                                                                                                        \]
                                                                                                        Yhtälöryhmällä yksikäsitteinen ratkaisu, jos ja vain jos matriisin alinta riviä vastaava yhtälö \(0=\frac{1}{5}(5u_3+u_2-8u_1)\)on tosi eli \(5u_3+u_2-8u_1 = 0\). Siten
                                                                                                        \[
                                                                                                        \begin{split}
                                                                                                        W &= \vir(\vv_1, \vv_2, \vv_3) \\
                                                                                                        &= \{(u_1,u_2,u_3) \in \R^3 \mid 5u_3+u_2-8u_1 = 0 \} \\
                                                                                                        &= \{(u_1,u_2,u_3) \in \R^3 \mid u_2=8u_1-5u_3 \} \\
                                                                                                        &= \{(u_1,8u_1-5u_3,u_3) \mid u_1,u_3 \in \R \} \\
                                                                                                        &= \{(u_1,8u_1,0)+(0,-5u_3,u_3) \mid u_1,u_3 \in \R \} \\
                                                                                                        &= \{u_1(1,8,0)+u_3(0,-5,1) \mid u_1,u_3 \in \R \} \\
                                                                                                        &= \vir\bigl((1,8,0),(0,-5,1)\bigr).
                                                                                                        \end{split}
                                                                                                        \]

                                                                                                        Nyt tiedetään, että vektorit \((1,8,0)\)ja \((0,-5,1)\)virittävät aliavaruuden. Lisäksi nämä kaksi vektoria ovat lineaarisesti riippumattomia, sillä ne eivät ole yhdensuuntaisia. Siispä jono \(((1,8,0), (0,-5,1))\)on avaruuden \(W\)kanta, ja \(\dim(W) = 2\).
                                                                                                        <!-- % -->
                                                                                                        <!-- %Lisäksi \((1,8,0) \nparallel (0,-5,1)\), joten lauseen \ref{sidottuLause} nojalla jono <!-- %\)((1,8,0), (0,-5,1))\)on vapaa. Näin ollen jono \(((1,8,0), (0,-5,1))\)on avaruuden \(W\)<!-- %kanta ja siten \(\dim(W) = 2\). -->
                                                                                                    </div></div>

                                                                                                <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> Edellisen esimerkin aliavaruudelle \(W\)voidaan löytää kanta myös toisella menetelmällä. Oletetaan nyt, että \(\vw=(w_1,w_2,w_3)\in W\). Tällöin yhtälö
                                                                                                        \begin{equation}<!-- \label{yhtalo:dimension_haku} -->
                                                                                                        x_1(3,-1,5) + x_2(2,1,3) + x_3(0,-5,1) = (w_1,w_2,w_3)
                                                                                                        \end{equation}
                                                                                                        pätee joillakin kertoimilla \(x_1,x_2,x_3\in\R\).
                                                                                                        Samalla tavalla kuin edellisessä esimerkissä yhtälöä vastaa matriisi
                                                                                                        \[
                                                                                                        \begin{bmatrix}[rrr|c]
                                                                                                        3 & 2 & 0 & w_1 \\
                                                                                                        -1 & 1 & -5 & w_2 \\
                                                                                                        5 & 3 & 1 & w_3
                                                                                                        \end{bmatrix}.
                                                                                                        \]
                                                                                                        Koska olemme olettaneet, että vektori \(\vw\)kuuluu aliavaruuteen \(W\), tiedämme, että yhtälöstä~\eqref{yhtalo:dimension_haku} saatavalla yhtälöryhmällä on varmasti ainakin yksi ratkaisu. Tämän vuoksi on samantekevää, mitä porrasmatriisiin tulee pystyviivan oikealle puolelle, ja voimme kiinnittää huomion yhtälön kertoimiin.
                                                                                                        <!-- %Kun tarkastellaan edellistä esimerkkiä, on ratkaisujen olemassaolon kannalta itse asiassa samantekevää, mitä lausekkeita pystyviivan oikealle puolelle tulee redusoitaessa matriisia porrasmatriisiksi. Viimeinen oikealla puolella oleva lauseke on nimittäin nimittäin jokin lukujen \(v_1\), \(v_2\)ja \(v_3\)lineaarikombinaatio, ja se voidaan aina saada nollaksi jollakin sopivalla valinnalla. Unohdetaan siis hetkeksi pystyviivan oikea puoli, ja keskitytään yhtälöryhmän kertoimiin. -->
                                                                                                        Nämä näyttävät porrasmatriisissa seuraavilta:
                                                                                                        \[
                                                                                                        \begin{bmatrix}[rrr]
                                                                                                        1 & -1 & 5 \\
                                                                                                        0 & 1 & -3 \\
                                                                                                        0 & 0 & 0
                                                                                                        \end{bmatrix}.
                                                                                                        \]

                                                                                                        <!-- %Jos nyt hyväksytään, että viimeinen rivi ei tuota ristiriitaa (kun valitaan \(v_1\), \(v_2\)ja \(v_3\)sopivasti), voidaan keskittää huomio itse ratkaisuihin. -->
                                                                                                        Porrasmatriisista huomataan, että kolmannessa sarakkeessa ei ole johtavaa alkiota. Muuttujan \(x_3\)arvo voidaan siis valita vapaasti, ja valinta määrää muuttujien \(x_1\)ja \(x_2\)arvot. Siispä yhtälössä~\eqref{yhtalo:dimension_haku} voi kerroin \(x_3\)saada minkä tahansa arvon, esimerkiksi arvon 0. Jokainen vektori \(\vw\in W\)voidaan täten ilmaista pelkästään vektorien \(\vv_1= (3,-1,5)\)ja \(\vv_2 = (2,1,3)\)lineaarikombinaationa. Koska nämä vektorit eivät ole yhdensuuntaisia, ne ovat lineaarisesti riippumattomat. Siten \((\vv_1,\vv_2)\)on aliavaruuden \(W\)kanta. Tämä kanta on eri kuin edellisessä esimerkissä saatu, mutta siinä on yhtä monta vektoria. Aliavaruuden \(W\)dimensio on siis 2.
                                                                                                    </div>
                                                                                                </div>
                                                                                        </div>
                                                                                        </section>
                                                                                        <section class="kappaleraja" id="9">
                                                                                            <div div class="kappaleraja-linis" id="Matriisit" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                                                                                                <h1>Matriisit</h1> <!-- \label{matriisitLuku} -->

                                                                                                Aiemmissa luvuissa matriiseja on käsitelty siinä määrin kuin on ollut tarpeellista yhtälönratkaisun kannalta.
                                                                                                Matriiseja käytetään kuitenkin myös muihin tarkoituksiin, ja siksi on hyödyllistä selvittää, minkälaisia ominaisuuksia matriiseilla itsellään on. Samalla saadaan joitakin uusia tapoja myös yhtälöryhmien ratkaisujen tutkimiseen.

                                                                                                Reaalialkioinen <strong>\(m\times n\)-matriisi</strong><!-- \index{matriisi} --> on reaalilukutaulukko, jossa on \(m\)
                                                                                                riviä ja \(n\)saraketta.
                                                                                                Esimerkiksi
                                                                                                \[\begin{equation*}
                                                                                                A=\begin{bmatrix}
                                                                                                a_{11} & a_{12} & \dots & a_{1n} \\
                                                                                                a_{21} & a_{22} & \dots & a_{2n} \\
                                                                                                \vdots & \vdots & & \vdots \\
                                                                                                a_{m1} & a_{m2} & \dots & a_{mn}
                                                                                                \end{bmatrix}
                                                                                                \begin{equation*}\]
                                                                                                on \(m\times n\)-matriisi. Voidaan myös sanoa, että matriisin \(A\)<strong>tyyppi</strong><!-- \index{tyyppi, matriisin} -->
                                                                                                on \(m\times n\). Kaikkien reaalikertoimisten \(m \times n\)-matriisien joukkoa
                                                                                                merkitään \(\R^{m \times n}\).
                                                                                                Matriisissa olevia lukuja kutsutaan matriisin <strong>alkioiksi</strong><!-- \index{alkio, matriisin} -->, ja
                                                                                                rivillä \(i\)sarakkeessa \(j\)olevaa alkiota merkitään
                                                                                                \)A(i,j)\).
                                                                                                <!-- %Matriisille \(A\)voidaan käyttää myös merkintää \(A=(a_{ij})\). -->
                                                                                                Esimerkiksi
                                                                                                \[\begin{equation*}
                                                                                                B=\begin{bmatrix}
                                                                                                \phantom{-}1 & 0 & \phantom{-}5 \\
                                                                                                -3 & 11 & \phantom{-}2 \\
                                                                                                \phantom{-}4 & 0 & \phantom{-}2 \\
                                                                                                \phantom{-}0 & \sqrt{2} & -6 \\
                                                                                                \end{bmatrix}
                                                                                                \begin{equation*}\]
                                                                                                on reaalikertoiminen \(4 \times 3\)-matriisi eli \(B \in \R^{4 \times 3}\).
                                                                                                Nähdään, että \(B(1,3)=5\)ja \(B(2,2)=11\).

                                                                                                <!-- % Samalla tavalla voidaan määritellä kompleksialkioisten matriisien joukot -->
                                                                                                <!-- % \(\C^{m\times n}\)</strong><!-- \index{Cmn@\(\C^{m\times n}\)}. Kaikki jatkossa esiteltävät -->
                                                                                                <!-- % ominaisuudet pätevät myös kompleksimatriiseille, vaikka tekstissä puhutaan vain -->
                                                                                                <!-- % reaalialkioisista matriiseista. -->

                                                                                                <h2>Matriisien laskutoimituksia}

                                                                                                    Matriiseille, kuten vektoreillekin, voidaan määritellä erilaisia laskutoimituksia. Osa niistä muistuttaa läheisesti vektorien vastaavia laskutoimituksia.

                                                                                                    <h3></h3>Matriisien yhteenlasku}

                                                                                                    Matriisien <strong>yhteenlasku</strong><!-- \index{yhteenlasku!matriisien} --> määritellään seuraavasti.
                                                                                                    Olkoot \(A,B\in\R^{m\times n}\). Matriisien \(A\)ja \(B\)summa saadaan laskemalla
                                                                                                    yhteen samoissa kohdissa olevat alkiot. Tuloksena on \(m\times n\)-matriisi
                                                                                                    \)A+B\), jolle pätee
                                                                                                    \[\begin{equation*}
                                                                                                    (A+B)(i,j)=A(i,j)+B(i,j)
                                                                                                    \begin{equation*}\]
                                                                                                    kaikilla \(i\in\{1,\dots,m\}\)ja \(j\in\{1,\dots,n\}\).
                                                                                                    Esimerkiksi
                                                                                                    \[\begin{equation*}
                                                                                                    \begin{bmatrix}
                                                                                                    1 & 2 \\ 3 & 4 \\ 5 & 6
                                                                                                    \end{bmatrix}
                                                                                                    +\begin{bmatrix}
                                                                                                    2 & -1 \\ 0 & \phantom{-}1 \\ 3 & \phantom{-}2
                                                                                                    \end{bmatrix}
                                                                                                    =\begin{bmatrix}
                                                                                                    1+2 & 2+(-1) \\ 3+0 & 4+1 \\ 5+3 & 6+2
                                                                                                    \end{bmatrix}
                                                                                                    =\begin{bmatrix}
                                                                                                    3 & 1 \\ 3 & 5 \\ 8 & 8
                                                                                                    \end{bmatrix}.
                                                                                                    \begin{equation*}\]

                                                                                                    <strong>Huom.</strong> Vain matriiseja, joilla on sama tyyppi, voidaan laskea yhteen.

                                                                                                    <h3></h3>Skalaarikertolasku}

                                                                                                    Minkä tahansa matriisin \(A\in\R^{m \times n}\)voi kertoa reaaliluvulla \(c\), ja
                                                                                                    tätä toimitusta kutsutaan <strong>skalaarikertolaskuksi</strong><!-- \index{skalaarikertolasku!matriisien} -->. Saatava tulos on \(m \times n\)-matriisi \(cA\), jota nimitetään matriisin \(A\)
                                                                                                    <strong>skalaarimonikerraksi</strong><!-- \index{skalaarimonikerta!matriisin} --> ja jolle pätee
                                                                                                    \[\begin{equation*}
                                                                                                    (cA)(i,j)=c\cdot A(i,j)
                                                                                                    \begin{equation*}\]
                                                                                                    kaikilla \(i\in\{1,\dots,m\}\)ja \(j\in\{1,\dots,n\}\).
                                                                                                    Esimerkiksi
                                                                                                    \[\begin{equation*}
                                                                                                    2\begin{bmatrix}
                                                                                                    2 & -1 \\ 0 & \phantom{-}1 \\ 3 & \phantom{-}2
                                                                                                    \end{bmatrix}
                                                                                                    =\begin{bmatrix}
                                                                                                    2\cdot 2 & 2\cdot(-1) \\ 2\cdot 0 & 2\cdot 1 \\ 2\cdot 3 & 2\cdot 2
                                                                                                    \end{bmatrix}
                                                                                                    =\begin{bmatrix}
                                                                                                    4 & -2 \\ 0 & \phantom{-}2 \\ 6 & \phantom{-}4
                                                                                                    \end{bmatrix}.
                                                                                                    \begin{equation*}\]
                                                                                                    Matriisia \((-1)A\)on tapana merkitä \(-A\). Matriisisummaa \(A+(-B)\)merkitään \(A-B\)ja sitä kutsutaan matriisien \(A\)ja \(B\)<strong>erotukseksi</strong><!-- \index{erotus!matriisien} -->.

                                                                                                    <h3></h3>Matriisikertolasku}

                                                                                                    Matriiseille voidaan määritellä myös <strong>matriisikertolasku</strong><!-- \index{matriisikertolasku} -->. Tämä
                                                                                                    laskutoimitus on hieman monimutkaisempi kuin edellä määritellyt eikä mitään vastaavaa ole olemassa vektoreille.

                                                                                                    Kaksi matriisia voidaan kertoa
                                                                                                    keskenään vain, jos ensimmäisessä on yhtä paljon sarakkeita kuin
                                                                                                    toisessa on rivejä. Olkoot siis \(A\in\R^{m\times n}\)ja \(B\in\R^{n\times
                                                                                                    p}\). Tällöin tulo \(AB\)on \(m\times p\)-matriisi, jolle pätee
                                                                                                    \begin{align*}
                                                                                                    (AB)(i,j)&=A(i,1)B(1,j)+A(i,2)B(2,j)+\cdots+A(i,n)B(n,j) \\
                                                                                                    &=\sum_{k=1}^n A(i,k)B(k,j)
                                                                                                    \end{align*}
                                                                                                    kaikilla \(i\in\{1,\dots,m\}\)ja \(j\in\{1,\dots,p\}\).\footnote{Merkintä \(\displaystyle{\sum_{k=1}^n c_k}\)
                                                                                                    tarkoittaa summaa \(c_1+c_2+\cdots+c_n\).}

                                                                                                    <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> <!-- \label{esimMatriisitulo} -->
                                                                                                            Lasketaan matriisien
                                                                                                            \[\begin{equation*}
                                                                                                            A=\begin{bmatrix}
                                                                                                            2 & -1 & 0 \\ 1 & \phantom{-}3 & 2
                                                                                                            \end{bmatrix}  \text{ja} 
                                                                                                            B=\begin{bmatrix}
                                                                                                            \phantom{-}1 & \phantom{-}2 \\ -2 & -1 \\ \phantom{-}0 & \phantom{-}1
                                                                                                            \end{bmatrix}
                                                                                                            \begin{equation*}\]
                                                                                                            tulo.
                                                                                                            Koska matriisissa \(A\)on kolme saraketta (tyyppi \(2\times 3\() ja matriisissa \(B\)
                                                                                                            on vastaavasti kolme riviä (tyyppi \(3 \times 2\(), matriisit
                                                                                                            voidaan kertoa keskenään. Tulosmatriisi on tyyppiä \(2\times 2\).
                                                                                                            Määritelmän mukaan
                                                                                                            \begin{align*}
                                                                                                            AB & =\begin{bmatrix}
                                                                                                            2 & -1 & 0 \\ 1 & \phantom{-}3 & 2
                                                                                                            \end{bmatrix}\begin{bmatrix}
                                                                                                            \phantom{-}1 & \phantom{-}2 \\ -2 & -1 \\ \phantom{-}0 & \phantom{-}1
                                                                                                            \end{bmatrix} \\
                                                                                                            & =\begin{bmatrix}
                                                                                                            2\cdot 1+(-1)\cdot(-2)+0\cdot 0 & 2\cdot 2+(-1)\cdot(-1)+0\cdot 1 \\
                                                                                                            1\cdot 1+3\cdot(-2)+2\cdot 0 & 1\cdot 2+3\cdot(-1)+2\cdot 1
                                                                                                            \end{bmatrix} \\
                                                                                                            &=\begin{bmatrix}
                                                                                                            \phantom{-}4 & 5 \\ -5 & 1
                                                                                                            \end{bmatrix}.
                                                                                                            \end{align*}
                                                                                                        </div></div>

                                                                                                    <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> <!-- \label{esimMatriisituloEiVaihdannainen} -->
                                                                                                            Matriisikertolasku ei ole vaihdannainen operaatio eli tulon tekijöiden
                                                                                                            järjestystä ei voi vaihtaa. Tarkastellaan vaikkapa matriiseja
                                                                                                            \[\begin{equation*}
                                                                                                            A=
                                                                                                            \begin{bmatrix}2 & 1 \\ 1 &
                                                                                                            2\end{bmatrix}
                                                                                                            \text{ja} 
                                                                                                            B=\begin{bmatrix}\phantom{-}0 & 3 \\ -4 &
                                                                                                            1\end{bmatrix}.
                                                                                                            \begin{equation*}\]
                                                                                                            Laskemalla tulo molemmin päin huomataan, että
                                                                                                            \[\begin{equation*}
                                                                                                            AB=
                                                                                                            \begin{bmatrix}
                                                                                                            -4 & 7 \\
                                                                                                            -8 & 5
                                                                                                            \end{bmatrix}
                                                                                                            \text{mutta} 
                                                                                                            BA=
                                                                                                            \begin{bmatrix}
                                                                                                            \phantom{-}3 & \phantom{-}6 \\
                                                                                                            -7 & -2
                                                                                                            \end{bmatrix}.
                                                                                                            \begin{equation*}\]
                                                                                                            Siten \(AB \neq BA\).
                                                                                                        </div></div>

                                                                                                    Oletetaan, että \(A\)on \(n \times n\)-matriisi ja \(k \in \{1,2,\dots\}\). Tällöin voidaan matriisitulon avulla määritellä <strong>matriisipotenssi</strong><!-- \index{matriisipotenssi} -->
                                                                                                    \[
                                                                                                    A^k=\underbrace{AA\cdots A}_{k\text{ kpl}}.
                                                                                                    \]

                                                                                                    <h2>Erityisiä matriiseja}

                                                                                                        Matriiseja, joiden kaikki alkiot ovat nollia, eli jotka ovat muotoa
                                                                                                        \[
                                                                                                        O_{m\times n}=
                                                                                                        \begin{bmatrix}
                                                                                                        0 & 0 & \cdots & 0 \\
                                                                                                        0 & 0 & \cdots & 0 \\
                                                                                                        \vdots & \vdots & & \vdots \\
                                                                                                        0 & 0 & \cdots & 0
                                                                                                        \end{bmatrix} \in \R^{m \times n},
                                                                                                        \]
                                                                                                        kutsutaan <strong>nollamatriiseiksi</strong><!-- \index{nollamatriisi} -->.
                                                                                                        <strong>Ykkösmatriiseja</strong><!-- \index{ykkösmatriisi} --> puolestaan ovat matriisit
                                                                                                        \[
                                                                                                        I_n=\begin{bmatrix}
                                                                                                        1 & 0 & \cdots & 0 \\
                                                                                                        0 & 1 & & \vdots \\
                                                                                                        \vdots & & \ddots & 0 \\
                                                                                                        0 & \cdots & 0 & 1
                                                                                                        \end{bmatrix}
                                                                                                        \in\R^{n\times n}.
                                                                                                        \]
                                                                                                        Ykkösmatriiseja kutsutaan usein myös <strong>yksikkömatriiseiksi}.


                                                                                                            <strong>Huom. 1.} Nollamatriisi voi olla mitä tahansa tyyppiä. Sen sijaan yksikkömatriisissa on aina yhtä paljon rivejä ja sarakkeita.

                                                                                                                <strong>Huom. 2.} Jos matriisien tyypeistä ei ole epäselvyyttä, saatetaan merkitä yksinkertaisemmin \(O_{m\times n}=O\)ja \(I_n=I\).


                                                                                                                    Ei ole vaikea nähdä, että nollamatriisit käyttäytyvät matriisien yhteenlaskun suhteen samalla tavalla kuin nolla lukujen yhteenlaskussa (tai nollavektori vektorien yhteenlaskussa): sellaisen lisääminen toiseen samantyyppiseen matriisiin ei muuta tuota toista matriisia mitenkään. Samalla tavoin ykkösmatriisit käyttäytyvät matriisikertolaskussa aivan kuten reaaliluku 1 tavallisessa kertolaskussa. Kaikilla \(A\in\R^{m \times n}\)pätee nimittäin
                                                                                                                    \[\begin{equation*}
                                                                                                                    I_m A=A  \text{ja}  A I_n=A.
                                                                                                                    \begin{equation*}\]
                                                                                                                    Eri puolilta kerrottaessa on matriisikertolaskun rajoituksen vuoksi käytettävä eri kokoista ykkösmatriisia.

                                                                                                                    <strong>Neliömatriisi</strong><!-- \index{neliömatriisi} --> on matriisi, jossa on yhtä monta riviä
                                                                                                                    ja saraketta. Esimerkiksi ykkösmatriisit ovat neliömatriiseja.

                                                                                                                    Neliömatriisin alkio on <strong>lävistäjällä} eli <strong>diagonaalilla</strong><!-- \index{lävistäjä --><!-- \index{diagonaali} -->, jos
                                                                                                                        alkion rivin ja sarakkeen numerot ovat samat. Matriisi, jonka kaikki nollasta
                                                                                                                        poikkeavat alkiot ovat lävistäjällä, on
                                                                                                                        <strong>lävistäjämatriisi</strong><!-- \index{lävistäjämatriisi} -->. Lävistäjämatriisi, jonka
                                                                                                                        kaikki lävistäjäalkiot ovat samoja, on puolestaan
                                                                                                                        <strong>skalaarimatriisi</strong><!-- \index{skalaarimatriisi} -->. Skalaarimatriisit ovat
                                                                                                                        ykkösmatriisin skalaarimonikertoja. Esimerkiksi
                                                                                                                        \[
                                                                                                                        \begin{bmatrix}
                                                                                                                        2 & \phantom{-}0 & 0 & 0 \\
                                                                                                                        0 & -1 & 0 & 0\\
                                                                                                                        0 & \phantom{-}0 & 0 & 0 \\
                                                                                                                        0 & \phantom{-}0 & 0 & 15
                                                                                                                        \end{bmatrix}
                                                                                                                        \]
                                                                                                                        on lävistäjämatriisi ja
                                                                                                                        \[
                                                                                                                        \begin{bmatrix}
                                                                                                                        2 & 0 & 0 \\
                                                                                                                        0 & 2 & 0 \\
                                                                                                                        0 & 0 & 2
                                                                                                                        \end{bmatrix}
                                                                                                                        =2I_3
                                                                                                                        \]
                                                                                                                        on skalaarimatriisi.

                                                                                                                        <h2>Matriisien laskusääntöjä}

                                                                                                                            Matriisien laskutoimitukset noudattavat tiettyjä sääntöjä, jotka monessa kohdassa muistuttavat lukujen laskusääntöjä.

                                                                                                                            <div class="lause"><h3>Lause</h3><!-- \label{matriisienLaskusaantojaLause} -->
                                                                                                                                Seuraavat säännöt pätevät
                                                                                                                                matriiseille \(A\), \(B\)ja \(C\)sekä reaaliluvuille \(a\)ja \(b\), jos laskutoimitukset on määritelty:
                                                                                                                                <ol><!-- \begin{aakkosta*} -->
                                                                                                                                    <li> \(A+B=B+A\)
                                                                                                                                    <li> \(A+(B+C)=(A+B)+C\)
                                                                                                                                    <li> \(A(BC)=(AB)C\)
                                                                                                                                    <li> \(A(B+C)=AB+AC\)
                                                                                                                                    <li> \((A+B)C=AC+BC\)
                                                                                                                                    <li> \((ab)A=a(bA)\)
                                                                                                                                    <li> \(a(AB)=(aA)B=A(aB)\).
                                                                                                                                </ol><!-- \end{aakkosta*} -->


                                                                                                                                <strong>Huom.</strong> Kuten aiemmin on jo mainittu, yleisessä tapauksessa \(AB\neq BA\), eli tulon vaihdannaisuus ei päde matriiseilla. Myöskään tulon nollasääntö ei päde matriseilla: kahden matriisin tulo voi olla nollamatriisi, vaikka kumpikaan tulon tekijöistä ei ole nollamatriisi.

                                                                                                                                <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                    Osoitetaan esimerkin vuoksi kohta d). Muiden kohtien tarkistaminen jätetään
                                                                                                                                    lukijalle.

                                                                                                                                    Oletetaan, että \(A \in \R^{m \times n}\)ja \(B,C \in \R^{n \times p}\). Nyt
                                                                                                                                    \)A(B+C)\)ja \(AB+AC\)ovat molemmat \(m \times p\)-matriiseja. On osoitettava, että
                                                                                                                                    kyseisten matriisien alkiot ovat samoja. Olkoot sitä varten \(i \in \{1,2,\dots,m\}\)ja \(j
                                                                                                                                    \in \{1,2,\dots,p\}\). Nähdään, että
                                                                                                                                    \begin{align*}
                                                                                                                                    \bigl(A(B+C)\bigr)(i,j)&=\sum_{k=1}^n A(i,k)\cdot (B+C)(k,j) \\
                                                                                                                                    & =\sum_{k=1}^n A(i,k) \bigl(B(k,j)+C(k,j)\bigr) \\
                                                                                                                                    & =\sum_{k=1}^n \bigl(A(i,k)B(k,j)+A(i,k)C(k,j)\bigr) \\
                                                                                                                                    & =\sum_{k=1}^n A(i,k)B(k,j)+\sum_{k=1}^nA(i,k)C(k,j) \\
                                                                                                                                    & =(AB)(i,j)+(AC)(i,j) \\
                                                                                                                                    & =(AB+AC)(i,j).
                                                                                                                                    \end{align*}
                                                                                                                                    Koska matriisit \(A(B+C)\)ja \(AB+AC\)ovat samaa tyyppiä ja niillä on täsmälleen
                                                                                                                                    samat alkiot, pätee \(A(B+C)=AB+AC\).
                                                                                                                                </div>

                                                                                                                                <h2>Matriisin transpoosi}

                                                                                                                                    <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                        Oletetaan, että \(A\)on \(m \times n\)-matriisi. Sen <strong>transpoosi</strong><!-- \index{transpoosi} --> \(\tp{A}\)on \(n \times m\)-matriisi, joka saadaan vaihtamalla matriisin \(A\)rivit ja sarakkeet keskenään.
                                                                                                                                        }

                                                                                                                                        Esimerkiksi matriisin
                                                                                                                                        \[
                                                                                                                                        A = \begin{bmatrix}
                                                                                                                                        1 & 3 & 2 \\
                                                                                                                                        5 & 0 & 1 \\
                                                                                                                                        \end{bmatrix}
                                                                                                                                        \]
                                                                                                                                        transpoosi on
                                                                                                                                        \[
                                                                                                                                        \tp{A} = \begin{bmatrix}
                                                                                                                                        1 & 5 \\
                                                                                                                                        3 & 0 \\
                                                                                                                                        2 & 1 \\
                                                                                                                                        \end{bmatrix}.
                                                                                                                                        \]

                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                            Neliömatriisin \(A\)sanotaan olevan <strong>symmetrinen</strong><!-- \index{symmetrinen} -->, jos \(\tp{A} = A\).
                                                                                                                                            Neliömatriisin \(A\)sanotaan olevan <strong>antisymmetrinen</strong><!-- \index{antisymmetrinen} -->, jos \(\tp{A} = -A\).
                                                                                                                                            }

                                                                                                                                            <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                    Merkitään
                                                                                                                                                    \[
                                                                                                                                                    B = \begin{bmatrix}
                                                                                                                                                    1&4&5 \\
                                                                                                                                                    4&2&6 \\
                                                                                                                                                    5&6&0
                                                                                                                                                    \end{bmatrix}
                                                                                                                                                    \text{ja} 
                                                                                                                                                    C = \begin{bmatrix}
                                                                                                                                                    0&4&-5 \\
                                                                                                                                                    -4&0&-6 \\
                                                                                                                                                    5&6&0
                                                                                                                                                    \end{bmatrix}.
                                                                                                                                                    \]
                                                                                                                                                    Tällöin
                                                                                                                                                    \[
                                                                                                                                                    \tp{B} = \begin{bmatrix}
                                                                                                                                                    1&4&5 \\
                                                                                                                                                    4&2&6 \\
                                                                                                                                                    5&6&0
                                                                                                                                                    \end{bmatrix}
                                                                                                                                                    = B  \text{ja} 
                                                                                                                                                    \tp{C} = \begin{bmatrix}
                                                                                                                                                    0&-4&5 \\
                                                                                                                                                    4&0&6 \\
                                                                                                                                                    -5&-6&0
                                                                                                                                                    \end{bmatrix} = -C.
                                                                                                                                                    \]
                                                                                                                                                    Siis \(B\)on symmetrinen ja \(C\)on antisymmetrinen.
                                                                                                                                                </div></div>

                                                                                                                                            Transpoosioperaation käyttäytymistä matriisien laskutoimitusten kanssa valottaa seuraava lause.

                                                                                                                                            <div class="lause"><h3>Lause</h3> <!-- \label{transpoosiLause} -->
                                                                                                                                                Seuraavat säännöt pätevät
                                                                                                                                                matriiseille \(A\)ja \(B\)sekä reaaliluvulle \(t\), jos laskutoimitukset on määritelty (ts. matriisit ovat sopivaa tyyppiä):
                                                                                                                                                <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                    <li> \(\tp{(\tp{A})}=A\)
                                                                                                                                                    <li> \(\tp{(A+B)}=\tp{A}+\tp{B}\)
                                                                                                                                                    <li> \(\tp{(AB)}=\tp{B}\tp{A}\)<!-- \label{item:tulonTranspoosi} -->
                                                                                                                                                    <li> \(\tp{(tA)} = t(\tp{A})\).
                                                                                                                                                </ol><!-- \end{aakkosta*} -->


                                                                                                                                                <strong>Huom.</strong> Erityisesti kannattaa painaa mieleen tulon tekijöiden järjestyksen vaihtuminen kohdassa~\ref{item:tulonTranspoosi}.

                                                                                                                                                <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                    Osoitetaan todeksi kohta~\ref{item:tulonTranspoosi} ja jätetään loput kohdat lukijalle.
                                                                                                                                                    Olkoot \(A \in \R^{m \times n}\)ja \(B \in \R^{n \times p}\). Nyt
                                                                                                                                                    sekä \(\tp{(AB)}\)että \(\tp{B}\tp{A}\)ovat molemmat \(p \times m\)-matriiseja. On osoitettava, että
                                                                                                                                                    kyseisten matriisien alkiot ovat samoja. Olkoot \(i\in\{1,2,\dots,p\}\)ja \(j\in\{1,2,\dots,m\}\). Nähdään, että
                                                                                                                                                    \begin{align*}
                                                                                                                                                    \tp{(AB)}(i,j) & =\bigl(AB\bigr)(j,i)=\sum_{k=1}^n A(j,k)\cdot B(k,i)
                                                                                                                                                    =\sum_{k=1}^n\tp{A}(k,j)\cdot\tp{B}(i,k) \\
                                                                                                                                                    & =\sum_{k=1}^n\tp{B}(i,k)\cdot\tp{A}(k,j)=(\tp{B}\tp{A})(i,j).
                                                                                                                                                    \end{align*}
                                                                                                                                                    Siten \(\tp{(AB)}=\tp{B}\tp{A}\).
                                                                                                                                                </div>

                                                                                                                                                <h2>Käänteismatriisi}

                                                                                                                                                    Matriiseille ei ole määritelty jakolaskua. Joissakin tapauksissa tämä puute voidaan korjata käyttämällä niin sanottuja käänteismatriiseja, jotka toimivat samalla tavalla kuin käänteisluvut tavallisten lukujen kertolaskussa. Toisin sanoen käänteismatriisilla kertominen ajaa saman asian kuin jakaminen. Pian tullaan kuitenkin valitettavasti huomaamaan, että kaikilla matriiseilla ei ole käänteismatriisia. Kaiken lisäksi on kätevintä rajoittua tarkastelemaan vain neliömatriiseja.

                                                                                                                                                    <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                        Olkoon \(A\)neliömatriisi. Jos on olemassa saman tyyppinen neliömatriisi \(B\), jolle pätee
                                                                                                                                                        \[
                                                                                                                                                        AB=I  \text{ja}  BA=I,
                                                                                                                                                        \]
                                                                                                                                                        sanotaan, että \(A\)on <strong>kääntyvä</strong><!-- \index{kääntyvä matriisi} --> ja \(B\)on matriisin \(A\)
                                                                                                                                                        <strong>käänteismatriisi</strong><!-- \index{käänteismatriisi} -->.
                                                                                                                                                        }

                                                                                                                                                        Joissakin lähteissä kääntyviä matriiseja kutsutaan säännöllisiksi matriiseiksi. Sellaisia matriiseja, joilla ei ole käänteismatriisia, kutsutaan toisinaan singulaarisiksi.

                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"><!-- \label{esimKäänteismatriisi} -->
                                                                                                                                                                Osoitetaan, että matriisin
                                                                                                                                                                \[
                                                                                                                                                                A=\begin{bmatrix}
                                                                                                                                                                1 & -1 & 0 \\
                                                                                                                                                                0 & \phantom{-}2 & 1 \\
                                                                                                                                                                1 & \phantom{-}0 & 0
                                                                                                                                                                \end{bmatrix}\]
                                                                                                                                                                käänteismatriisi on
                                                                                                                                                                \[
                                                                                                                                                                B=\begin{bmatrix}
                                                                                                                                                                \phantom{-}0 & 0 & \phantom{-}1 \\
                                                                                                                                                                -1 & 0 & \phantom{-}1 \\
                                                                                                                                                                \phantom{-}2 & 1 & -2
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                \]
                                                                                                                                                                laskemalla määritelmän vaatimat kertolaskut:
                                                                                                                                                                \[
                                                                                                                                                                AB=
                                                                                                                                                                \begin{bmatrix}
                                                                                                                                                                1 & -1 & 0 \\
                                                                                                                                                                0 & \phantom{-}2 & 1 \\
                                                                                                                                                                1 & \phantom{-}0 & 0
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                \begin{bmatrix}
                                                                                                                                                                \phantom{-}0 & 0 & \phantom{-}1 \\
                                                                                                                                                                -1 & 0 & \phantom{-}1 \\
                                                                                                                                                                \phantom{-}2 & 1 & -2
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                =\begin{bmatrix}
                                                                                                                                                                1 & 0 & 0\\
                                                                                                                                                                0 & 1 & 0 \\
                                                                                                                                                                0 & 0 & 1
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                \]
                                                                                                                                                                ja
                                                                                                                                                                \[
                                                                                                                                                                BA=
                                                                                                                                                                \begin{bmatrix}
                                                                                                                                                                \phantom{-}0 & 0 & \phantom{-}1 \\
                                                                                                                                                                -1 & 0 & \phantom{-}1 \\
                                                                                                                                                                \phantom{-}2 & 1 & -2
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                \begin{bmatrix}
                                                                                                                                                                1 & -1 & 0 \\
                                                                                                                                                                0 & \phantom{-}2 & 1 \\
                                                                                                                                                                1 & \phantom{-}0 & 0
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                =\begin{bmatrix}
                                                                                                                                                                1 & 0 & 0\\
                                                                                                                                                                0 & 1 & 0 \\
                                                                                                                                                                0 & 0 & 1
                                                                                                                                                                \end{bmatrix}.
                                                                                                                                                                \]
                                                                                                                                                                Koska \(AB=I\)ja \(BA=I\), matriisi \(B\)on matriisin \(A\)käänteismatriisi.
                                                                                                                                                            </div></div>

                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                Lähestkään kaikilla matriiseilla ei ole käänteismatrisia.
                                                                                                                                                                Osoitetaan, että vaikkapa matriisilla
                                                                                                                                                                \[
                                                                                                                                                                A=\begin{bmatrix}
                                                                                                                                                                1 & 0 \\
                                                                                                                                                                1 & 0 
                                                                                                                                                                \end{bmatrix}\]
                                                                                                                                                                ei ole käänteismatriisia.
                                                                                                                                                                Oletetaan vastoin väitettä, että 
                                                                                                                                                                \[
                                                                                                                                                                B=\begin{bmatrix}
                                                                                                                                                                a&b\\
                                                                                                                                                                c&d
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                \]
                                                                                                                                                                on matriisin \(A\)käänteismatriisi.
                                                                                                                                                                Nyt \(AB=I\)eli
                                                                                                                                                                \[
                                                                                                                                                                \begin{bmatrix}
                                                                                                                                                                1 & 0 \\
                                                                                                                                                                1 & 0 
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                \begin{bmatrix}
                                                                                                                                                                a&b\\
                                                                                                                                                                c&d
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                =\begin{bmatrix}
                                                                                                                                                                1 & 0\\
                                                                                                                                                                0 & 1\\
                                                                                                                                                                \end{bmatrix}.
                                                                                                                                                                \]
                                                                                                                                                                Laskemalla yhtälön vasemmalla puolella oleva matrisiitulo, saadaan
                                                                                                                                                                \[
                                                                                                                                                                \begin{bmatrix}
                                                                                                                                                                a & b \\
                                                                                                                                                                a & b 
                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                =\begin{bmatrix}
                                                                                                                                                                1 & 0\\
                                                                                                                                                                0 & 1\\
                                                                                                                                                                \end{bmatrix}.
                                                                                                                                                                \]
                                                                                                                                                                Nyt matriisien oikeanpuoleisista sarakkeista nähdään, että \(a=0\)ja toisaalta \(a=1\).
                                                                                                                                                                Päädytään siis ristiriitaan. Näin ollen matriisilla \(A\)ei ole käänteismatriisia. 
                                                                                                                                                            </div></div>

                                                                                                                                                        <div class="lause"><h3>Lause</h3>
                                                                                                                                                            Matriisilla on korkeintaan yksi käänteismatriisi.


                                                                                                                                                            <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                Oletetaan, että matriisilla \(A\)on käänteismatriisit \(B\)ja \(B'\). Nyt
                                                                                                                                                                \[
                                                                                                                                                                B=BI=B(AB')=(BA)B'=IB'=B'.
                                                                                                                                                                \]
                                                                                                                                                                Yllä olevan yhtälöketjun perusteella \(B\)ja \(B'\)ovat välttämättä sama matriisi. Näin ollen \(A\):n käänteismatriiseja ei voi olla enempää kuin yksi.
                                                                                                                                                            </div>

                                                                                                                                                            Jos matriisi \(A\)on kääntyvä, sen käänteismatriisille käytetään merkintää \(A^{-1}\). Huomaa, että merkintää \(A^{-1}\)ei voi käyttää ennen kuin on varmistanut, että matriisi \(A\)todella on kääntyvä.
                                                                                                                                                            Seuraava lause auttaa joidenkin matriisien käänteismatriisien löytämisessä.

                                                                                                                                                            <div class="lause"><h3>Lause</h3><!-- \label{joitakinKaanteismatriisejaLause} -->
                                                                                                                                                                Oletetaan, että matriisit \(A\)ja \(B\)ovat kääntyviä. Tällöin myös matriisit \(A^{-1}\), \(AB\)ja \(\tp{A}\)ovat kääntyviä, ja niiden käänteismatriisit ovat seuraavat:
                                                                                                                                                                <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                    <li> \((A^{-1})^{-1} = A\)
                                                                                                                                                                    <li> \((\tp{A})^{-1} = \tp{(A^{-1})}\)
                                                                                                                                                                    <li> \((AB)^{-1} = B^{-1}A^{-1}\).
                                                                                                                                                                </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                    Lauseen matriisit osoitetaan kääntyviksi näyttämällä kussakin tapauksessa, että väitetty käänteismatriisi todella on matriisin käänteismatriisi.

                                                                                                                                                                    a) Käänteismatriisin määritelmän mukaan \(AA^{-1}=I\)ja \(A^{-1}A=I\). Tämä tarkoittaa saman määritelmän mukaan myös sitä, että \(A\)on matriisin \(A^{-1}\)käänteismatriisi. Siispä \(A^{-1}\)on kääntyvä ja voidaan lisäksi merkitä \((A^{-1})^{-1}=A\).
                                                                                                                                                                    <!-- % Osoitetaan matriisi \(A^{-1}\)kääntyväksi näyttämällä, että sen käänteismatriisi on \(A\). Koska \(A^{-1}A=I\)ja \(AA^{-1}=I\), on \(A\)matriisin \(A^{-1}\)käänteismatriisi eli \((A^{-1})^{-1} = A\) -->.

                                                                                                                                                                    b) Osoitetaan, että matriisin \(\tp{A}\)käänteismatriisi on \(\tp{(A^{-1})}\). Lauseen~\ref{transpoosiLause} nojalla pätee
                                                                                                                                                                    \[
                                                                                                                                                                    \tp{A}\tp{(A^{-1})}=\tp{(A^{-1}A)}=\tp{I}=I.
                                                                                                                                                                    \]
                                                                                                                                                                    Samalla tavalla osoitetaan, että \(\tp{(A^{-1})}\tp{A}=I\). Siten \(\tp{(A^{-1})}\)on matriisin \(\tp{A}\)käänteismatriisi. Tästä seuraa myös, että matriisi \(\tp{A}\)on kääntyvä.

                                                                                                                                                                    c) Matriisia \(AB\)koskevan väitteen todistaminen jätetään harjoitustehtäväksi.
                                                                                                                                                                </div>

                                                                                                                                                                <h3>\(2\times 2\)-matriisin käänteismatriisi</h3>
                                                                                                                                                                <!-- %TODO: todistus olisi yksinkertaisempi (ja ehkä myös valaisevampi), jos siinä käytettäisiin matriisien ja yhtälöryhmien yhteyttä. seuraava luku on kuitenkin jo niin raskas, ettei todistusta mielellään siirtäisi sinne. voisi myös kuvitella teettävänsä todistuksen myöhemmin harjoitustehtävänä (sen voisi silloin mainita myöhemmässä luvussa). toki nämä tekniset laskut ovat tässäkin tavallaan opettavaisia (opettavat näkemään tarvittaessa vaivaa) -->

                                                                                                                                                                Matriiseille, joiden tyyppi on \(2\times 2\), on olemassa erityinen kaava käänteismatriisin löytämiseksi.

                                                                                                                                                                <div class="lause"><h3>Lause</h3> <!-- \label{2x2KaantyvaLause} -->
                                                                                                                                                                    Matriisi
                                                                                                                                                                    \[
                                                                                                                                                                    A=\begin{bmatrix}
                                                                                                                                                                    a & b\\
                                                                                                                                                                    c & d
                                                                                                                                                                    \end{bmatrix}
                                                                                                                                                                    \]
                                                                                                                                                                    on kääntyvä, jos ja vain jos \(ad-bc \neq 0\). Jos matriisi \(A\)on kääntyvä, sen käänteismatriisi on
                                                                                                                                                                    \[
                                                                                                                                                                    \frac{1}{ad-bc}
                                                                                                                                                                    \begin{bmatrix}[rr]
                                                                                                                                                                    d & -b\\
                                                                                                                                                                    -c & a
                                                                                                                                                                    \end{bmatrix}.
                                                                                                                                                                    \]


                                                                                                                                                                    <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                        Oletetaan, että \(ad-bc \neq 0\). Merkitään
                                                                                                                                                                        \[
                                                                                                                                                                        B=\frac{1}{ad-bc}
                                                                                                                                                                        \begin{bmatrix}[rr]
                                                                                                                                                                        d & -b\\
                                                                                                                                                                        -c & a
                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                        \]
                                                                                                                                                                        Laskemalla voidaan todeta, että \(AB=I\)ja \(BA=I\). Siten \(B\)on matriisin \(A\)
                                                                                                                                                                        käänteismatriisi ja \(A\)on kääntyvä.

                                                                                                                                                                        Oletetaan sitten, että \(ad-bc=0\)ja osoitetaan, että matriisi \(A\)ei tällöin ole kääntyvä. Nyt on tutkittavana kaksi eri tapausta: joko
                                                                                                                                                                        \)a=0\)tai \(a \neq 0\). Jos \(a=0\), niin oletuksesta seuraa, että \(bc=0\). Siten joko \(b=0\)tai \(c=0\).
                                                                                                                                                                        Tällöin
                                                                                                                                                                        \[
                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                        0 & 0\\
                                                                                                                                                                        c & d
                                                                                                                                                                        \end{bmatrix}  \text{tai} 
                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                        0 & b\\
                                                                                                                                                                        0 & d
                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                        \]
                                                                                                                                                                        Kummassakaan tapauksessa ei ole olemassa matriisia \(B\), jolle pätee
                                                                                                                                                                        \)AB=I\). Tuloon \(AB\)tulee nimittäin välttämättä nollarivi tai nollasarake.
                                                                                                                                                                        Siten \(A\)ei ole kääntyvä.

                                                                                                                                                                        Tutkitaan sitten tapaus \(a \neq 0\). Nyt \(d=bc/a\)ja
                                                                                                                                                                        \[
                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                        a & b\\
                                                                                                                                                                        c & bc/a
                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                        \]
                                                                                                                                                                        Oletetaan, että on olemassa sellainen matriisi
                                                                                                                                                                        \[
                                                                                                                                                                        B=\begin{bmatrix}
                                                                                                                                                                        x & y\\
                                                                                                                                                                        z & w
                                                                                                                                                                        \end{bmatrix},<!-- % \in \R^{2 \times 2}, -->
                                                                                                                                                                        \]
                                                                                                                                                                        että \(AB=I\). Tällöin
                                                                                                                                                                        \[
                                                                                                                                                                        AB=\begin{bmatrix}
                                                                                                                                                                        a & b\\
                                                                                                                                                                        c & bc/a
                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                        x & y\\
                                                                                                                                                                        z & w
                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                        =\begin{bmatrix}
                                                                                                                                                                        ax+bz & ay+bw\\
                                                                                                                                                                        cx+bcz/a & cy+bcw/a
                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                        =\begin{bmatrix}
                                                                                                                                                                        1 & 0\\
                                                                                                                                                                        0 & 1
                                                                                                                                                                        \end{bmatrix},
                                                                                                                                                                        \]
                                                                                                                                                                        eli
                                                                                                                                                                        \[\left\{
                                                                                                                                                                        \begin{aligned}
                                                                                                                                                                        ax+bz & =1 \\
                                                                                                                                                                        ay+bw & =0 \\
                                                                                                                                                                        cx+bcz/a & =0 \\
                                                                                                                                                                        cy+bcw/a & =1.
                                                                                                                                                                        \end{aligned}
                                                                                                                                                                        \right.
                                                                                                                                                                        \]
                                                                                                                                                                        Kolmannen yhtälön perusteella \(c(x+bz/a)=0\). Jos \(c=0\), päädytään samankaltaiseen
                                                                                                                                                                        tilanteeseen kuin silloin, kun \(a=0\). Siten voidaan olettaa, että \(c \neq 0\). Tällöin
                                                                                                                                                                        täytyy päteä \(x+bz/a=0\)eli \(x=-bz/a\). Toisaalta ensimmäisen yhtälön perusteella
                                                                                                                                                                        \(x=(1-bz)/a\). Nyt \(-bz=1-bz\), joten \(1=0\). Tämä on mahdotonta. Siten
                                                                                                                                                                        matriisilla \(A\)ei ole käänteismatriisia.
                                                                                                                                                                    </div>

                                                                                                                                                                    Suurempien matriisien käänteismatriisien laskemiseksi ei ole yhtä helppoa kaavaa. Käänteismatriisin määrittämistä käsitellään lisää luvussa~alla <!-- \ref{k-->aanteismatrMaarLuku}.

                                                                                                                                                                    <!-- %Käänteismatriisin määritelmää käyttämällä voidaan testata, onko annettu matriisi toisen käänteismatriisi vai ei. Jos valmista ehdokasta ei ole tarjolla, käänteismatriisin selvittämiseksi on käytettävä muita keinoja. Näitä käsitellään luvussa~alla <!-- \ref{k-->aanteismatrMaarLuku}. -->

                                                                                                                                                                    <h2>Sarakevektorit</h2>

                                                                                                                                                                    Usein avaruuden \(\R^n\)vektori \((v_1,v_2,\dots,v_n)\)samastetaan matriisin
                                                                                                                                                                    \[
                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                    v_1 \\
                                                                                                                                                                    v_2 \\
                                                                                                                                                                    \vdots \\
                                                                                                                                                                    v_n
                                                                                                                                                                    \end{bmatrix} \in \R^{n \times 1}
                                                                                                                                                                    \]
                                                                                                                                                                    kanssa.
                                                                                                                                                                    Joukon \(\R^{n \times 1}\)matriiseja kutsutaan <strong>sarakevektoreiksi</strong><!-- \index{sarakevektori} -->.
                                                                                                                                                                    Kun avaruuden \(\R^n\)vektoreita ajatellaan sarakevektoreina, voi niitä kertoa
                                                                                                                                                                    matriiseilla: jos \(A \in \R^{m \times n}\)ja
                                                                                                                                                                    \(\vv \in \R^n\), on tulo \(A\vv\)määritelty, kun \(\vv\)tulkitaan joukon \(\R^{n
                                                                                                                                                                    \times 1}\)alkioksi.

                                                                                                                                                                    <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"><!-- \label{esimVektorinJaMatriisinTulo} -->
                                                                                                                                                                            Matriisin
                                                                                                                                                                            \[
                                                                                                                                                                            A=\begin{bmatrix}
                                                                                                                                                                            \phantom{-}2 & 4 \\
                                                                                                                                                                            -1 & 0 \\
                                                                                                                                                                            -2 & 1
                                                                                                                                                                            \end{bmatrix}
                                                                                                                                                                            \]
                                                                                                                                                                            ja vektorin \(\vv=(-5,3)\)tulo on
                                                                                                                                                                            \[A\vv=
                                                                                                                                                                            \begin{bmatrix}
                                                                                                                                                                            \phantom{-}2 & 4 \\
                                                                                                                                                                            -1 & 0 \\
                                                                                                                                                                            -2 & 1
                                                                                                                                                                            \end{bmatrix}
                                                                                                                                                                            \begin{bmatrix}
                                                                                                                                                                            -5 \\
                                                                                                                                                                            \phantom{-}3
                                                                                                                                                                            \end{bmatrix}
                                                                                                                                                                            =
                                                                                                                                                                            \begin{bmatrix}
                                                                                                                                                                            2 \\
                                                                                                                                                                            5 \\
                                                                                                                                                                            13
                                                                                                                                                                            \end{bmatrix}.
                                                                                                                                                                            \]
                                                                                                                                                                            Tämä sarakevektori voidaan samastaa vektorin \((2,5,13)\)kanssa.
                                                                                                                                                                            <!-- %Vaihtoehtoisesti vektori \((v_1,v_2,\dots,v_n) \in \R^n\)voidaan samastaa matriisin \([v_1,v_2 \dots ,v_n] \in <!-- %\R^{1 \times n}\)kanssa. voidaan avaruuden \(\R^n\)kanssa. Jos nyt \(A \in \R^{n \times m}\)ja \(\vv \in \R^n\),  <!-- %niin tulo \(\vv A\)on määritelty. -->
                                                                                                                                                                        </div></div>
                                                                                                                                                                    <!-- %Tässä tekstissä avaruuden \(\R^n\)vektoreita ajatellaan sarakevektoreina silloin, kun vektoreita on tarpeen <!-- %ajatella matriiseina. -->
                                                                                                                                                                </div>
                                                                                                                                                                </section>
                                                                                                                                                                <
                                                                                                                                                                Tässä luvussa esitellään uusi tapa kirjoittaa lineaarinen yhtälöryhmä matriisien avulla käyttäen hyväksi matriisikertolaskua sekä sarakevektoreita. Pilkotaan sitä varten yhtälöryhmän
                                                                                                                                                                \begin{equation}<!-- \label{yhtalo:yhtaloryhma} -->
                                                                                                                                                                \left\{
                                                                                                                                                                \begin{array}{ccc}
                                                                                                                                                                a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n & = & b_1 \\
                                                                                                                                                                a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n & = & b_2 \\
                                                                                                                                                                \vdots & & \vdots \\
                                                                                                                                                                a_{m1}x_1+a_{m2}x_2+\cdots+a_{mn}x_n & = & b_m
                                                                                                                                                                \end{array}\right.
                                                                                                                                                                \end{equation}
                                                                                                                                                                eri osat omiksi matriiseikseen. Ensinnäkin yhtälöryhmän~\eqref{yhtalo:yhtaloryhma}
                                                                                                                                                                <strong>kerroinmatriisiksi} kutsutaan matriisia
                                                                                                                                                                    \[
                                                                                                                                                                    A=
                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                    a_{11} & a_{12} & \cdots & a_{1n} \\
                                                                                                                                                                    a_{21} & a_{22} & \cdots & a_{2n} \\
                                                                                                                                                                    \vdots & & & \vdots \\
                                                                                                                                                                    a_{m1} & a_{m2} & \cdots & a_{mn} \\
                                                                                                                                                                    \end{bmatrix}.
                                                                                                                                                                    \]
                                                                                                                                                                    Kerroinmatriisi sisältää siis yhtälöryhmän kertoimet järjestyksessä. Kerätään vielä muuttujat ja vakiot omiksi matriiseikseen:
                                                                                                                                                                    \[
                                                                                                                                                                    \vx=
                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                    x_1 \\
                                                                                                                                                                    x_2 \\
                                                                                                                                                                    \vdots \\
                                                                                                                                                                    x_n  \\
                                                                                                                                                                    \end{bmatrix}  \text{ja} 
                                                                                                                                                                    \vb=
                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                    b_1 \\
                                                                                                                                                                    b_2 \\
                                                                                                                                                                    \vdots \\
                                                                                                                                                                    b_m  \\
                                                                                                                                                                    \end{bmatrix}.
                                                                                                                                                                    \]
                                                                                                                                                                    Kaikki tuntemattomat ovat sarakevektorissa \(\vx\)ja kaikki vakiot sarakevektorissa \(\vb\).

                                                                                                                                                                    Nyt yhtälöryhmä~\eqref{yhtalo:yhtaloryhma} voidaan kirjoittaa matriisien avulla.
                                                                                                                                                                    Huomataan nimittäin, että
                                                                                                                                                                    \[
                                                                                                                                                                    A\vx=\begin{bmatrix}
                                                                                                                                                                    a_{11}x_1+a_{12}x_2+\dots+a_{1n}x_n \\
                                                                                                                                                                    a_{21}x_1+a_{22}x_2+\dots+a_{2n}x_n \\
                                                                                                                                                                    \vdots\\
                                                                                                                                                                    a_{m1}x_1+a_{m2}x_2+\dots+a_{mn}x_n
                                                                                                                                                                    \end{bmatrix}.
                                                                                                                                                                    \]
                                                                                                                                                                    Sarakevektorin \(A\vx\)alkiot vastaavat yhtälöryhmän~\eqref{yhtalo:yhtaloryhma} yhtälöiden vasempia puolia. Koska sarakevektori \(\vb\)sisältää yhtälöiden oikeat puolet samassa järjestyksessä, yhtälöryhmä voidaan kirjoittaa muodossa \(A\vx=\vb\)eli
                                                                                                                                                                    \[
                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                    a_{11}x_1+a_{12}x_2+\dots+a_{1n}x_n \\
                                                                                                                                                                    a_{21}x_1+a_{22}x_2+\dots+a_{2n}x_n \\
                                                                                                                                                                    \vdots\\
                                                                                                                                                                    a_{m1}x_1+a_{m2}x_2+\dots+a_{mn}x_n
                                                                                                                                                                    \end{bmatrix}
                                                                                                                                                                    =\begin{bmatrix}
                                                                                                                                                                    b_1 \\
                                                                                                                                                                    b_2 \\
                                                                                                                                                                    \vdots \\
                                                                                                                                                                    b_m  \\
                                                                                                                                                                    \end{bmatrix}.
                                                                                                                                                                    \]

                                                                                                                                                                    Kerroinmatriisin kääntyvyys vaikuttaa nyt merkittävästi yhtälöryhmän ratkaisuihin.

                                                                                                                                                                    <div class="lause">
                                                                                                                                                                        <h3>Lause</h3> <!-- \label{kaantMatrYhtaloLause} -->
                                                                                                                                                                        Jos matriisi \(A\in\R^{n\times n}\)on kääntyvä ja \(\vb\in\R^n\), yhtälöllä \(A\vx=\vb\)on täsmälleen
                                                                                                                                                                        yksi ratkaisu, ja se on \(\vx=A^{-1}\vb\).


                                                                                                                                                                        <div class="todistus drop">
                                                                                                                                                                            <h4 class="otsikko">Todistus</h4>
                                                                                                                                                                            Oletetaan, että matriisi \(A\)on kääntyvä. Todistuksessa on kaksi osaa. On osoitettava, että \(A^{-1}\vb\)on yhtälön ratkaisu ja että muita ratkaisuja ei ole.

                                                                                                                                                                            Osoitetaan ensin, että \(A^{-1}\vb\)on yhtälön ratkaisu sijoittamalla se yhtälön vasemmalle puolelle vektorin \(\vx\)paikalle:
                                                                                                                                                                            \[
                                                                                                                                                                            A(A^{-1}\vb)=(AA^{-1})\vb=I\vb=\vb.
                                                                                                                                                                            \]
                                                                                                                                                                            Koska tuloksena oli yhtälön oikea puoli, esitetty ratkaisu toteuttaa yhtälön.

                                                                                                                                                                            Osoitetaan sitten, ettei muita ratkaisuja ole. Oletetaan, että \(\vy\)on jokin (toinen) ratkaisu. Tällöin \(A\vy=\vb\). Kerrotaan yhtälön molemmat puolet vasemmalta matriisilla \(A^{-1}\), jolloin saadaan
                                                                                                                                                                            \[
                                                                                                                                                                            A^{-1}A\vy=A^{-1}\vb.
                                                                                                                                                                            \]
                                                                                                                                                                            Koska \(A^{-1}A=I\), edellinen yhtälö sievenee muotoon \(\vy=A^{-1}\vb\). Kysymyksessä on siis sama ratkaisu kuin edellä.
                                                                                                                                                                            Siten ratkaisuja on vain yksi ja se on \(A^{-1}\vb\).
                                                                                                                                                                        </div>

                                                                                                                                                                        <strong>Huom.</strong> Todistuksessa tarvittiin käänteismatriisin kumpaakin ominaisuutta: \(AA^{-1}=I\)ja \(A^{-1}A=I\).

                                                                                                                                                                        <h2>Alkeismatriisit</h2>

                                                                                                                                                                        Myös alkeisrivitoimitukset voi ilmaista matriisikertolaskun
                                                                                                                                                                        avulla. Osoittautuu, että jos matriisia kerrotaan niin kutsutulla
                                                                                                                                                                        alkeismatriisilla, tullaan matriisille tehneeksi jokin alkeisrivitoimitus. Tästä havainnosta tulee olemaan hyötyä kääntyvien matriisien käsittelyssä.

                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                            Matriisi on <strong>alkeismatriisi</strong><!-- \index{alkeismatriisi} -->, jos se on saatu ykkösmatriisista yhdellä
                                                                                                                                                                            alkeisrivitoimituksella.
                                                                                                                                                                            }

                                                                                                                                                                            Esimerkiksi seuraavat matriisit ovat alkeismatriiseja:
                                                                                                                                                                            \[
                                                                                                                                                                            E_1=\begin{bmatrix}
                                                                                                                                                                            1 & 0 & \phantom{-}0 & 0 \\
                                                                                                                                                                            0 & 1 & \phantom{-}0 & 0\\
                                                                                                                                                                            0 & 0 & -\frac{1}{2} & 0 \\
                                                                                                                                                                            0 & 0 & \phantom{-}0 & 1
                                                                                                                                                                            \end{bmatrix},  
                                                                                                                                                                            E_2=\begin{bmatrix}
                                                                                                                                                                            1 & 0 & 0 & 0 \\
                                                                                                                                                                            0 & 0 & 0 & 1\\
                                                                                                                                                                            0 & 0 & 1 & 0\\
                                                                                                                                                                            0 & 1 & 0 & 0
                                                                                                                                                                            \end{bmatrix},  
                                                                                                                                                                            E_3=\begin{bmatrix}
                                                                                                                                                                            1 & 0 & 0 & 0 \\
                                                                                                                                                                            0 & 1 & 0 & 0\\
                                                                                                                                                                            3 & 0 & 1 & 0 \\
                                                                                                                                                                            0 & 0 & 0 & 1
                                                                                                                                                                            \end{bmatrix}.
                                                                                                                                                                            \]
                                                                                                                                                                            Nämä alkeismatriisit on saatu ykkösmatriisista tekemällä sille alkeisrivitoimitukset
                                                                                                                                                                            \)-\frac{1}{2}R_3\), \(R_2 \leftrightarrow R_4\)ja \(R_3+3R_1\).

                                                                                                                                                                            <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                    Osoittautuu, että alkeismatriiseilla kertominen vastaa alkeisrivitoimitusten
                                                                                                                                                                                    tekemistä.  Tutkitaan tätä edellisen esimerkin alkeismatriisien ja matriisin
                                                                                                                                                                                    \[
                                                                                                                                                                                    A=\begin{bmatrix}
                                                                                                                                                                                    a_{11} & a_{12} & a_{13} \\
                                                                                                                                                                                    a_{21} & a_{22} & a_{23} \\
                                                                                                                                                                                    a_{31} & a_{32} & a_{33} \\
                                                                                                                                                                                    a_{41} & a_{42} & a_{43}
                                                                                                                                                                                    \end{bmatrix}
                                                                                                                                                                                    \]
                                                                                                                                                                                    avulla. Laskemalla nähdään, että
                                                                                                                                                                                    \begin{align*}
                                                                                                                                                                                    E_1A&=\begin{bmatrix}[rrrr]
                                                                                                                                                                                    1 & 0 & 0 & 0 \\
                                                                                                                                                                                    0 & 1 & 0 & 0\\
                                                                                                                                                                                    0 & 0 & \boldsymbol{-\frac{1}{2}} & 0 \\
                                                                                                                                                                                    0 & 0 & 0 & 1
                                                                                                                                                                                    \end{bmatrix}
                                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                                    a_{11} & a_{12} & a_{13} \\
                                                                                                                                                                                    a_{21} & a_{22} & a_{23} \\
                                                                                                                                                                                    a_{31} & a_{32} & a_{33} \\
                                                                                                                                                                                    a_{41} & a_{42} & a_{43}
                                                                                                                                                                                    \end{bmatrix}
                                                                                                                                                                                    =
                                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                                    a_{11} & a_{12} & a_{13} & \\
                                                                                                                                                                                    a_{21} & a_{22} & a_{23} & \\
                                                                                                                                                                                    \boldsymbol{-\frac{1}{2}}a_{31} & \boldsymbol{-\frac{1}{2}}a_{32} & \boldsymbol{-\frac{1}{2}}a_{33} \\
                                                                                                                                                                                    a_{41} & a_{42} & a_{43}
                                                                                                                                                                                    \end{bmatrix}, \\
                                                                                                                                                                                    E_2A&=\begin{bmatrix}[rrrr]
                                                                                                                                                                                    1 & 0 & 0 & 0 \\
                                                                                                                                                                                    0 & 0 & 0 & \boldsymbol{1}\\
                                                                                                                                                                                    0 & 0 & 1 & 0\\
                                                                                                                                                                                    0 & \boldsymbol{1} & 0 & 0
                                                                                                                                                                                    \end{bmatrix}
                                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                                    a_{11} & a_{12} & a_{13} \\
                                                                                                                                                                                    \boldsymbol{a_{21}} & \boldsymbol{a_{22}} & \boldsymbol{a_{23}} \\
                                                                                                                                                                                    a_{31} & a_{32} & a_{33} \\
                                                                                                                                                                                    \boldsymbol{a_{41}} & \boldsymbol{a_{42}} & \boldsymbol{a_{43}}
                                                                                                                                                                                    \end{bmatrix}=
                                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                                    a_{11} & a_{12} & a_{13} \\
                                                                                                                                                                                    \boldsymbol{a_{41}} & \boldsymbol{a_{42}} & \boldsymbol{a_{43}} \\
                                                                                                                                                                                    a_{31} & a_{32} & a_{33} \\
                                                                                                                                                                                    \boldsymbol{a_{21}} & \boldsymbol{a_{22}} & \boldsymbol{a_{23}}
                                                                                                                                                                                    \end{bmatrix}  \text{ja} \\
                                                                                                                                                                                    E_3A & =\begin{bmatrix}
                                                                                                                                                                                    1 & 0 & 0 & 0 \\
                                                                                                                                                                                    0 & 1 & 0 & 0\\
                                                                                                                                                                                    \boldsymbol{3} & 0 & 1 & 0 \\
                                                                                                                                                                                    0 & 0 & 0 & 1
                                                                                                                                                                                    \end{bmatrix}
                                                                                                                                                                                    \begin{bmatrix}
                                                                                                                                                                                    a_{11} & a_{12} & a_{13} \\
                                                                                                                                                                                    a_{21} & a_{22} & a_{23} \\
                                                                                                                                                                                    a_{31} & a_{32} & a_{33} \\
                                                                                                                                                                                    a_{41} & a_{42} & a_{43}
                                                                                                                                                                                    \end{bmatrix}
                                                                                                                                                                                    = \begin{bmatrix}
                                                                                                                                                                                    a_{11} & a_{12} & a_{13} \\
                                                                                                                                                                                    a_{21} & a_{22} & a_{23} \\
                                                                                                                                                                                    \boldsymbol{3a_{11}}+a_{31} & \boldsymbol{3a_{12}}+a_{32} & \boldsymbol{3a_{13}}+a_{33} \\
                                                                                                                                                                                    a_{41} & a_{42} & a_{43}
                                                                                                                                                                                    \end{bmatrix}.
                                                                                                                                                                                    \end{align*}
                                                                                                                                                                                    Huomataan, että jokaisella alkeismatriisilla kerrottaessa matriisille
                                                                                                                                                                                    \)A\)tullaan tehneeksi sama alkeisrivioperaatio, jonka avulla alkeismatriisi
                                                                                                                                                                                    muodostettiin.
                                                                                                                                                                                </div></div>

                                                                                                                                                                            Yksittäinen esimerkki ei takaa, että alkeismatriisilla kertominen vastaa aina
                                                                                                                                                                            alkeisrivitoimituksen tekemistä. Esimerkin perusteella voi kuitenkin ymmärtää,
                                                                                                                                                                            miksi näin on. Yleisen tapauksen todistaminen ei ole vaikeaa, mutta se on kuitenkin melko työlästä, joten tyydytään mainitsemaan tulos ilman todistusta.

                                                                                                                                                                            \begin{lemma}
                                                                                                                                                                            Oletetaan, että \(A \in \R^{n \times m}\).
                                                                                                                                                                            Olkoon \(E\)alkeismatriisi, joka saadaan tekemällä jokin alkeisrivitoimitus
                                                                                                                                                                            ykkösmatriisille \(I_n\). Jos matriisille \(A\)tehdään sama alkeisrivitoimitus,
                                                                                                                                                                            tuloksena on matriisi \(EA\).
                                                                                                                                                                            \end{lemma}

                                                                                                                                                                            <strong>Huom.</strong> Lemma tarkoittaa apulausetta. Se on siis pieni tulos, jota voidaan käyttää hyväksi tärkeämpien lauseiden todistamisessa.

                                                                                                                                                                            <div class="lause"><h3>Lause</h3><!-- \label{alkeismatriisiKaantyvaLause} -->
                                                                                                                                                                                Alkeismatriisit ovat kääntyviä, ja alkeismatriisin käänteismatriisi on myös alkeismatriisi.


                                                                                                                                                                                <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                    Myöskään tämän tuloksen tarkkaa todistusta ei esitetä tässä. Käydään kuitenkin läpi todistuksen
                                                                                                                                                                                    idea.

                                                                                                                                                                                    Jokainen alkeisrivitoimitus voidaan peruuttaa toisella alkeisrivitoimituksella kuten kohta nähdään. Kutsutaan tätä alkeisrivitoimitusta alkuperäisen alkeisrivitoimituksen <strong>käänteistoimitukseksi}.

                                                                                                                                                                                        Oletetaan, että \(a,b \in \R\)ja \(a \neq 0\). Jos matriisille tehdään alkeisrivitoimitus \(R_i \leftrightarrow R_j\), päästään takaisin alkutilanteeseen tekemällä sama alkeisrivitoimitus uudelleen. Alkeisrivitoimitus \(R_i \leftrightarrow R_j\)on siis itsensä käänteistoimitus. Alkeisrivitoimituksen \(aR_i\)käänteistoimitus on puolestaan \(\frac{1}{a}R_i\), ja alkeisrivitoimituksen \(R_i+bR_j\)käänteistoimitus on \(R_i-bR_j\).

                                                                                                                                                                                        <!-- %Lemman \ref{riviekvLemma} todistuksessa on todettu, että jokaisella --> <!-- %alkeisrivitoimituksella on niin kutsuttu käänteistoimitus, joka -->
                                                                                                                                                                                        <!-- %kumoaa kyseisen alkeisrivitoimituksen. Alkeisrivitoimitus \(R_i \leftrightarrow R_j\)on oma <!-- %käänteistoimituksensa, alkeisrivitoimituksen \(aR_i\)(\(a \in \R \setminus \{0\}\() <!-- %käänteistoimitus on \(\frac{1}{a}R_i\)ja alkeisrivitoimituksen \(R_i+bR_j\)(\(b \in \R\() <!-- %käänteistoimitus on \(R_i-bR_j\). -->

                                                                                                                                                                                        Alkeismatriisin käänteismatriisi saadaan aina käänteistoimitusta vastaavasta alkeismatriisista. Alkeisrivitoimitusta \(R_i \leftrightarrow R_j\)vastaava alkeismatriisi on oma käänteismatriisinsa, alkeisrivitoimitusta \(aR_i\)vastaavan alkeismatriisin käänteismatriisi on alkeisrivitoimitusta \(\frac{1}{a}R_i\)vastaava alkeismatriisi ja niin edelleen. Alkeisrivitoimituksen tekeminen vastaa nimittäin edellisen lemman nojalla alkeismatriisilla kertomista. Esimerkiksi alkeisrivitoimitukset \(aR_i\)ja \(\frac{1}{a}R_i\)peräkkäin suoritettuina eivät tee matriisille mitään. Siten niitä vastaavien alkeismatriisien tulo on ykkösmatriisi, jolla kertominen ei tee matriisille mitään.
                                                                                                                                                                                        \begin{comment}
                                                                                                                                                                                        Olkoon \(E\)alkeismatriisi, joka on saatu vaikkapa alkeisrivitoimituksesta
                                                                                                                                                                                        \)aR_i\), ja \(F\)alkeismatriisi, joka on saatu alkeisrivitoimituksesta
                                                                                                                                                                                        \(\frac{1}{a}R_i\). Oletetaan, että \(A\)on jokin kääntyvä matriisi.
                                                                                                                                                                                        Kun alkeisrivitoimitukset \(aR_i\)ja \(\frac{1}{a}R_i\)tehdään peräkkäin
                                                                                                                                                                                        matriisille \(A\), ei tapahdu mitään. Toisin sanoen \(FEA=A\). Kun tämä yhtälö
                                                                                                                                                                                        kerrotaan matriisilla \(A^{-1}\), saadaan \(FE=I\). Yhtä lailla \(E\)ja \(F\)kumoavat
                                                                                                                                                                                        toisensa, jos ne tehdään päinvastaisessa järjestyksessä: \(EFA=A\). Tästä seuraa,
                                                                                                                                                                                        että \(EF=I\). Siten \(F\)on matriisin \(E\)käänteismatriisi.

                                                                                                                                                                                        Todistus ei käyttänyt mitenkään hyväksi sitä, että \(E\)vastaa juuri
                                                                                                                                                                                        alkeisrivioperaatiota \(aR_i\). Tarvittiin ainoastaan tietoa siitä, että on
                                                                                                                                                                                        olemassa jokin toinen alkeisrivitoimitus, joka kumoaa alkuperäisen
                                                                                                                                                                                        alkeisrivitoimituksen. Siten jokaisella alkeismatriisilla on käänteismatriisi,
                                                                                                                                                                                        joka myöskin on alkeismatriisi.
                                                                                                                                                                                        \end{comment}
                                                                                                                                                                                </div>

                                                                                                                                                                                <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                        Etsitään alkeismatriisin
                                                                                                                                                                                        \[
                                                                                                                                                                                        E=\begin{bmatrix}
                                                                                                                                                                                        1 & 0 & 0 & 0 \\
                                                                                                                                                                                        0 & 1 & 0 & 0\\
                                                                                                                                                                                        3 & 0 & 1 & 0 \\
                                                                                                                                                                                        0 & 0 & 0 & 1
                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                        \]
                                                                                                                                                                                        käänteismatriisi. Matriisi vastaa alkeisrivitoimitusta \(R_3+3R_1\). Tämän
                                                                                                                                                                                        alkeisrivitoimituksen voi kumota tekemällä alkeisrivitoimituksen \(R_3-3R_1\).
                                                                                                                                                                                        Sitä vastaava alkeismatriisi on
                                                                                                                                                                                        \[
                                                                                                                                                                                        F=\begin{bmatrix}
                                                                                                                                                                                        \phantom{-}1 & 0 & 0 & 0 \\
                                                                                                                                                                                        \phantom{-}0 & 1 & 0 & 0\\
                                                                                                                                                                                        -3 & 0 & 1 & 0 \\
                                                                                                                                                                                        \phantom{-}0 & 0 & 0 & 1
                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                        \]
                                                                                                                                                                                        Laskemalla voi vielä varmistaa, että \(EF=I\)ja \(FE=I\). Siis \(E^{-1}=F\).
                                                                                                                                                                                    </div></div>

                                                                                                                                                                                Lauseessa~alla <!-- \ref{k-->aantMatrYhtaloLause} todettiin jo kääntyvien matriisien merkitys yhtälöryhmän ratkaisun kannalta. Nyt tuota tulosta voidaan täydentää tarkastelemalla lisäksi alkeisrivioperaatioita ja niitä vastaavia alkeismatriiseja.

                                                                                                                                                                                <div class="lause"><h3>Lause</h3> <!-- \label{kaanteismatriisiLause} -->
                                                                                                                                                                                    Oletetaan, että \(A\)on \(n \times n\)-neliömatriisi.
                                                                                                                                                                                    Seuraavat ehdot ovat yhtäpitäviä:
                                                                                                                                                                                    <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                        <li> Matriisi \(A\)on kääntyvä.
                                                                                                                                                                                        <li> Yhtälöllä \(A\vx=\vb\)on täsmälleen yksi ratkaisu kaikilla \(\vb \in
                                                                                                                                                                                            \R^n\).
                                                                                                                                                                                        <li> Yhtälöllä \(A\vx=\nv\)on vain triviaali ratkaisu \(\vx=\nv\).
                                                                                                                                                                                        <li> Matriisi \(A\)on riviekvivalentti ykkösmatriisin kanssa.
                                                                                                                                                                                        <li> Matriisi \(A\)on alkeismatriisien tulo.
                                                                                                                                                                                        <li> Matriisi \(A\)ei ole riviekvivalentti minkään nollarivin sisältävän matriisin kanssa.
                                                                                                                                                                                    </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                                    <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                        Osoitetaan väite todistamalla seuraavat päättelyketjut:
                                                                                                                                                                                        \[
                                                                                                                                                                                        \text{a)} \Rightarrow \text{b)} \Rightarrow \text{c)} \Rightarrow \text{d)} \Rightarrow \text{e)} \Rightarrow \text{a)}
                                                                                                                                                                                        \text{ja} 
                                                                                                                                                                                        \text{d)} \Rightarrow \text{f)} \Rightarrow \text{d)}.
                                                                                                                                                                                        \]
                                                                                                                                                                                        Tämän jälkeen tiedetään, että jokainen lauseen kohta on yhtäpitävä toisten kohtien kanssa.

                                                                                                                                                                                        a) \(\Rightarrow\)b): Väite on osoitettu lauseessa alla <!-- \ref{k-->aantMatrYhtaloLause}.

                                                                                                                                                                                        b) \(\Rightarrow\)c):
                                                                                                                                                                                        Oletetaan, että yhtälöllä \(A\vx=\vb\)on täsmälleen yksi ratkaisu kaikilla \(\vb \in
                                                                                                                                                                                        \R^n\). Tämä pätee myös, jos \(\vb=\nv\). Toisaalta yhtälöllä \(A\vx=\nv\)on aina ratkaisu \(\vx=\nv\). Siten \(\vx=\nv\)on ainoa ratkaisu.

                                                                                                                                                                                        c) \(\Rightarrow\)d): Oletetaan, että yhtälöllä \(A\vx=\nv\)on vain ratkaisu
                                                                                                                                                                                        \(\vx=\nv\). Merkitään \(A(i,j)=a_{ij}\)kaikilla \(i,j \in \{1,2,\dots,n\}\). Yhtälöä \(A\vx=\nv\)
                                                                                                                                                                                        vastaava lineaarinen yhtälöryhmä on
                                                                                                                                                                                        \[
                                                                                                                                                                                        \left\{
                                                                                                                                                                                        \begin{array}{ccc}
                                                                                                                                                                                        a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n & = & 0 \\
                                                                                                                                                                                        a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n & = & 0 \\
                                                                                                                                                                                        \vdots & & \vdots \\
                                                                                                                                                                                        a_{n1}x_1+a_{n2}x_2+\cdots+a_{nn}x_n & = & 0
                                                                                                                                                                                        \end{array}
                                                                                                                                                                                        \right.
                                                                                                                                                                                        \]
                                                                                                                                                                                        Yhtälöryhmässä on sama määrä yhtälöitä ja tuntemattomia. Koska yhtälöryhmällä on täsmälleen yksi ratkaisu \(\vx=\nv\), se on ekvivalentti yhtälöryhmän
                                                                                                                                                                                        \[\begin{equation*}
                                                                                                                                                                                        \left\{
                                                                                                                                                                                        \begin{aligned}
                                                                                                                                                                                        x_1 & =0 \\
                                                                                                                                                                                        x_2 & =0 \\
                                                                                                                                                                                        \vdots & \\
                                                                                                                                                                                        x_n & =0
                                                                                                                                                                                        \end{aligned}
                                                                                                                                                                                        \right.
                                                                                                                                                                                        \begin{equation*}\]
                                                                                                                                                                                        kanssa. Tämä tarkoittaa, että matriisi \(A\)saadaan alkeisrivitoimituksilla
                                                                                                                                                                                        muutettua ykkösmatriisiksi. Toisin sanottuna \(A\)on riviekvivalentti ykkösmatriisin kanssa.

                                                                                                                                                                                        d) \(\Rightarrow\)e): Oletetaan, että matriisi \(A\)on riviekvivalentti ykkösmatriisin kanssa. Tällöin lemman~1.4 perusteella on olemassa alkeismatriisit \(E_1,\dots,E_k\), joilla kertomalla matriisista \(A\)saadaan ykkösmatriisi. Pätee siis
                                                                                                                                                                                        \[
                                                                                                                                                                                        E_k \cdots E_1A=I.
                                                                                                                                                                                        \]
                                                                                                                                                                                        Kun yhtälön molemmat puolet kerrotaan vasemmalta matriisilla \(E_k^{-1}\), saadaan
                                                                                                                                                                                        uusi yhtälö \(E_{k-1} \cdots E_1A=E_k^{-1}.\)Kun tämän yhtälön vasemmat puolet kerrotaan puolestaan matriisilla \(E_{k-1}^{-1}\), saadaan \(E_{k-2} \cdots E_1A=E_{k-1}^{-1}E_k^{-1}\). Jatkamalla samaan tapaan päädytään yhtälöön
                                                                                                                                                                                        \[
                                                                                                                                                                                        A=E_1^{-1} \cdots E_{k-1}^{-1}E_k^{-1}.
                                                                                                                                                                                        \]
                                                                                                                                                                                        Koska alkeismatriisin käänteismatriisi on myös alkeismatriisi, on väite todistettu.

                                                                                                                                                                                        e) \(\Rightarrow\)a): Oletetaan, että \(A=E_1 \cdots E_k\), missä \(E_1, \dots ,E_k\)ovat alkeismatriiseja. Merkitään \(B=E_k^{-1} \cdots E_1^{-1}\). Nyt
                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                        AB & =(E_1 \cdots E_k)(E_k^{-1} \cdots E_1^{-1}) \\
                                                                                                                                                                                        & =E_1 \cdots (E_kE_k^{-1}) \cdots E_1^{-1} \\
                                                                                                                                                                                        & =E_1 \cdots E_{k-1}IE_{k-1}^{-1} \cdots E_1^{-1} \\
                                                                                                                                                                                        & \hspace{3em} \vdots \\
                                                                                                                                                                                        & =E_1 E_1^{-1}=I.
                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                        Siispä \(AB=I\). Samalla tavalla nähdään, että \(BA=I\). Siten \(B\)on matriisin \(A\)käänteismatriisi ja \(A\)on kääntyvä.

                                                                                                                                                                                        d) \(\Rightarrow\)f): Oletetaan, että \(A\)on riviekvivalentti ykkösmatriisin kanssa. Tehdään lisäksi vastaoletus, että \(A\)on riviekvivalentti jonkin matriisin \(B\)kanssa, joka sisältää nollarivin. Tällöin matriisiyhtälöitä \(A\vx=\nv\), \(I\vx=\nv\)ja \(B\vx=\nv\)vastaavilla yhtälöryhmillä on kaikilla samat ratkaisut.

                                                                                                                                                                                        Matriisi \(B\)sisältää nollarivin, joten joltakin sen riviltä puuttuu johtava alkio. Koska \(B\)sisältää yhtä monta riviä kuin saraketta, myös jostakin sen sarakkeesta puuttuu johtava alkio. Täten yhtälöryhmällä \(B\vx=\nv\)on vapaa muuttuja ja ratkaisuja on ääretön määrä. Kuitenkin yhtälöllä \(I\vx=\nv\)on vain yksi ratkaisu: \(\vx=\nv\). Tämä on ristiriita, joten vastaoletus on väärä ja \(A\)ei ole riviekvivalentti nollarivin sisältävän matriisin kanssa.

                                                                                                                                                                                        f) \(\Rightarrow\)d): Oletetaan, että \(A\)ei ole riviekvivalentti minkään nollarivin sisältävän matriisin kanssa. Olkoon \(B\)redusoitu porrasmatriisi, joka on riviekvivalentti \(A\):n kanssa. Oletuksen mukaan \(B\)ei sisällä nollarivejä, joten sen jokaisella rivillä on johtava alkio. Koska \(B\)on neliömatriisi, myös sen jokaisessa sarakkeessa on johtava alkio. Tällöin \(B\)on itse asiassa ykkösmatriisi, joten \(A\)on riviekvivalentti ykkösmatriisin kanssa.
                                                                                                                                                                                    </div>

                                                                                                                                                                                    <h2>Käänteismatriisin määrittäminen} <!-- \label{kaanteismatrMaarLuku} -->

                                                                                                                                                                                        Muuttamalla neliömatriisi redusoiduksi porrasmatriisiksi voidaan nähdä, onko matriisi kääntyvä.
                                                                                                                                                                                        Jos nimittäin matriisi \(A\)onnistutaan muuttamaan alkeisrivitoimituksilla ykkösmatriisiksi, niin \(A\)on lauseen~alla <!-- \ref{k-->aanteismatriisiLause} nojalla kääntyvä eli sillä on käänteismatriisi \(A^{-1}\). Muussa tapauksessa \(A\)ei ole kääntyvä.

                                                                                                                                                                                        Jos matriisi on kääntyvä, käytetyistä alkeisrivi\-toimituksista saadaan myös selville, mikä  käänteismatriisi on. Oletetaan, että matriisi \(A\)on muutettu ykkösmatriisiksi alkeisrivitoimituksilla, joita vastaavat alkeismatriisit \(E_1, \dots, E_k\). Nyt
                                                                                                                                                                                        \[
                                                                                                                                                                                        E_k\cdots E_1A = I.
                                                                                                                                                                                        \]
                                                                                                                                                                                        Tällöin käänteismatriisille pätee
                                                                                                                                                                                        \[
                                                                                                                                                                                        \begin{split}
                                                                                                                                                                                        A^{-1} &= IA^{-1} = (E_k\cdots E_1A)A^{-1} = E_k\cdots E_1(AA^{-1}) \\
                                                                                                                                                                                        &= E_k\cdots E_1 I.
                                                                                                                                                                                        \end{split}
                                                                                                                                                                                        \]
                                                                                                                                                                                        Tämä tarkoittaa, että tekemällä ykkösmatriisille \(I\)samat alkeisrivitoimitukset kuin tehtiin alunperin matriisille \(A\)päädytään käänteismatriisiin \(A^{-1}\).

                                                                                                                                                                                        Matriisin \(A\)kääntyvyyden selvittäminen ja käänteismatriisin etsiminen voidaan tehdä yhtä aikaa. Yhdistetään matriisit \(A\)ja \(I\)matriisiksi \([A \mid I\,]\). Tehdään tälle matriisille alkeisrivitoimituksia, joilla  \(A\)muutetaan redusoiduksi porrasmatriisiksi. <!-- %Jos matriisin \(A\)kohdalle ilmestyy nollarivi, voidaan lemman \ref{nollariviLemma} nojalla <!-- %todeta, että matriisi \(A\)ei ole riviekvivalentti ykkösmatriisin kanssa eikä siten ole --> <!-- %kääntyvä. -->
                                                                                                                                                                                        Jos matriisi \(A\)saadaan muutettua alkeisrivitoimitusten avulla  ykkösmatriisiksi, on \(A\)kääntyvä. Kuten edellä todettiin, samat alkeisrivitoimitukset muuttavat ykkösmatriisin \(I\)matriisin \(A\)käänteismatriisiksi \(A^{-1}\). Siis
                                                                                                                                                                                        \[
                                                                                                                                                                                        [A \mid I]  \leadsto  [I \mid A^{-1}].
                                                                                                                                                                                        \]

                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                Tutkitaan, onko matriisilla
                                                                                                                                                                                                \[
                                                                                                                                                                                                A=\begin{bmatrix}
                                                                                                                                                                                                2 & 4 & -2 \\
                                                                                                                                                                                                0 & 0 & \phantom{-}1 \\
                                                                                                                                                                                                1 & 0 & \phantom{-}4
                                                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                                                \]
                                                                                                                                                                                                käänteismatriisi.
                                                                                                                                                                                                Muokataan yhdistettyä matriisia
                                                                                                                                                                                                \[
                                                                                                                                                                                                \begin{bmatrix}[rrr|ccc]
                                                                                                                                                                                                2 & 4 & -2 & 1 & 0 & 0\\
                                                                                                                                                                                                0 & 0 & 1 & 0 & 1 & 0\\
                                                                                                                                                                                                1 & 0 & 4 & 0 & 0 & 1
                                                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                                                \]
                                                                                                                                                                                                alkeisrivitoimituksilla samaan tapaan kuin Gaussin--Jordanin menetelmässä. Tavoitteena on saada vasemmalle puolelle ykkösmatriisi. Muokkaus voi tapahtua esimerkiksi seuraavasti:
                                                                                                                                                                                                \pagebreak[0]
                                                                                                                                                                                                \begin{align*}
                                                                                                                                                                                                &\begin{bmatrix}[rrr|ccc]
                                                                                                                                                                                                2 & 4 & -2 & 1 & 0 & 0\\
                                                                                                                                                                                                0 & 0 & 1 & 0 & 1 & 0\\
                                                                                                                                                                                                1 & 0 & 4 & 0 & 0 & 1
                                                                                                                                                                                                \end{bmatrix} \overset{R_1 \leftrightarrow R_3}{\longrightarrow}
                                                                                                                                                                                                \begin{bmatrix}[rrr|ccc]
                                                                                                                                                                                                1 & 0 & 4 & 0 & 0 & 1 \\
                                                                                                                                                                                                0 & 0 & 1 & 0 & 1 & 0 \\
                                                                                                                                                                                                2 & 4 & -2 & 1 & 0 & 0
                                                                                                                                                                                                \end{bmatrix} \overset{R_3-2R_1}{\longrightarrow} \\[2mm]
                                                                                                                                                                                                &\begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                1 & 0 & 4 & 0 & 0 & 1 \\
                                                                                                                                                                                                0 & 0 & 1 & 0 & 1 & 0 \\
                                                                                                                                                                                                0 & 4 & -10 & 1 & 0 & -2
                                                                                                                                                                                                \end{bmatrix} \overset{R_1 \leftrightarrow R_3}{\longrightarrow}
                                                                                                                                                                                                \begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                1 & 0 & 4 & 0 & 0 & 1 \\
                                                                                                                                                                                                0 & 4 & -10 & 1 & 0 & -2 \\
                                                                                                                                                                                                0 & 0 & 1 & 0 & 1 & 0
                                                                                                                                                                                                \end{bmatrix} \overset{\frac{1}{4}R_2}{\longrightarrow} \\[2mm]
                                                                                                                                                                                                &\begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                1 & 0 & 4 & 0 & 0 & 1 \\
                                                                                                                                                                                                0 & 1 & -\frac{5}{2} & \frac{1}{4} & 0 & -\frac{1}{2} \\
                                                                                                                                                                                                0 & 0 & 1 & 0 & 1 & 0
                                                                                                                                                                                                \end{bmatrix} \overset{R_2+\frac{5}{2}R_3}{\longrightarrow}
                                                                                                                                                                                                \begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                1 & 0 & 4 & 0 & 0 & 1 \\
                                                                                                                                                                                                0 & 1 & 0 & \frac{1}{4} & \frac{5}{2} & -\frac{1}{2} \\
                                                                                                                                                                                                0 & 0 & 1 & 0 & 1 & 0
                                                                                                                                                                                                \end{bmatrix} \overset{R_1-4R_3}{\longrightarrow} \\[2mm]
                                                                                                                                                                                                &\begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                1 & 0 & 0 & 0 & -4 & 1 \\
                                                                                                                                                                                                0 & 1 & 0 & \frac{1}{4} & \frac{5}{2} & -\frac{1}{2} \\
                                                                                                                                                                                                0 & 0 & 1 & 0 & 1 & 0
                                                                                                                                                                                                \end{bmatrix}.
                                                                                                                                                                                                \end{align*}
                                                                                                                                                                                                Koska matriisi \(A\)saatiin muutettua alkeisrivitoimituksilla ykkösmatriisiksi, on \(A\)kääntyvä. Lisäksi sen käänteismatriisi on
                                                                                                                                                                                                \[
                                                                                                                                                                                                \begin{bmatrix}
                                                                                                                                                                                                0 & -4 & \phantom{-}1\\
                                                                                                                                                                                                \frac{1}{4} & \phantom{-}\frac{5}{2} & -\frac{1}{2} \\
                                                                                                                                                                                                0 & \phantom{-}1 & \phantom{-}0
                                                                                                                                                                                                \end{bmatrix}.
                                                                                                                                                                                                \]
                                                                                                                                                                                            </div></div>

                                                                                                                                                                                        <!-- %Entä jos matriisi ei ole kääntyvä? Kuinka voidaan osoittaa, että matriisista ei saada alkeisrivitoimituksilla ykkösmatriisia? On itse asiassa niin, että jos alkeisrivitoimitusten avulla saadaan aikaan nollarivi, ei matriisi voi olla riviekvivalentti ykkösmatriisin kanssa. (Todistus perustuisi redusoidun porrasmatriisin yksikäsitteisyyteen.) Nollarivi on siis merkki siitä, ettei matriisi ei ole kääntyvä. -->

                                                                                                                                                                                        Jos matriisi ei ole kääntyvä, se on lauseen~alla <!-- \ref{k-->aanteismatriisiLause} mukaan riviekvivalentti sellaisen matriisin kanssa, joka sisältää nollarivin. Tämä tulee ilmi matriisia redusoitaessa.

                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                Tutkitaan, onko matriisilla
                                                                                                                                                                                                \[
                                                                                                                                                                                                B=\begin{bmatrix}
                                                                                                                                                                                                \phantom{-}2 & 1 & -3 \\
                                                                                                                                                                                                -1 & 0 & \phantom{-}2 \\
                                                                                                                                                                                                \phantom{-}1 & 1 & -1
                                                                                                                                                                                                \end{bmatrix}
                                                                                                                                                                                                \]
                                                                                                                                                                                                käänteismatriisi.
                                                                                                                                                                                                Ryhdytään muokkaamaan yhdistettyä matriisia alkeisrivitoimituksilla:
                                                                                                                                                                                                \begin{align*}
                                                                                                                                                                                                & \begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                -1 & 0 & 2 & 1 & 0 & 0 \\
                                                                                                                                                                                                4 & 1 & -3 & 0 & 1 & 0\\
                                                                                                                                                                                                3 & 1 & -1 & 0 & 0 & 1
                                                                                                                                                                                                \end{bmatrix} \overset{(-1)R_1}{\longrightarrow}
                                                                                                                                                                                                \begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                1 & 0 & -2 & -1 & 0 & 0\\
                                                                                                                                                                                                4 & 1 & -3 & 0 & 1 & 0\\
                                                                                                                                                                                                3 & 1 & -1 & 0 & 0 & 1
                                                                                                                                                                                                \end{bmatrix} \overset{R_2-4R_1}{\longrightarrow}
                                                                                                                                                                                                \begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                1 & 0 & -2 & -1 & 0 & 0\\
                                                                                                                                                                                                0 & 1 & 5 & 4 & 1 & 0\\
                                                                                                                                                                                                3 & 1 & -1 & 0 & 0 & 1
                                                                                                                                                                                                \end{bmatrix}  \\[1ex]
                                                                                                                                                                                                & \overset{R_3-3R_1}{\longrightarrow}
                                                                                                                                                                                                \begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                1 & 0 & -2 & -1 & 0 & 0\\
                                                                                                                                                                                                0 & 1 & 5 & 4 & 1 & 0\\
                                                                                                                                                                                                0 & 1 & 5 & 3 & 0 & 1
                                                                                                                                                                                                \end{bmatrix} \overset{R_3-R_2}{\longrightarrow} \begin{bmatrix}[rrr|rrr]
                                                                                                                                                                                                1 & 0 & -2 & -1 & 0 & 0\\
                                                                                                                                                                                                0 & 1 & 5 & 4 & 1 & 0\\
                                                                                                                                                                                                0 & 0 & 0 & -1 & -1 & 1
                                                                                                                                                                                                \end{bmatrix}.
                                                                                                                                                                                                \end{align*}
                                                                                                                                                                                                Koska matriisin \(B\)viimeisen rivin paikalle tuli nollarivi, matriisi \(B\)ei ole kääntyvä.
                                                                                                                                                                                            </div></div>

                                                                                                                                                                                        <h2>Lisää kääntyvyyteen liittyviä tuloksia}

                                                                                                                                                                                            Tässä alaluvussa esitetään kaksi toisinaan hyödyllistä tulosta. Molempien todistukset perustuvat matriisien ja yhtälöryhmien väliseen suhteeseen. Ensimmäisessä todetaan, että matriisin kääntyvyyden toteamiseksi ei tarvitse tarkastella matriisituloa molemmin päin.

                                                                                                                                                                                            <div class="lause"><h3>Lause</h3><!-- \label{kaantyvyysYksinkertaistusLause} --> Olkoot \(A,B\in\R^{n\times n}\). Jos \(BA=I\), niin \(AB=I\)eli matriisit \(A\)ja \(B\)ovat toistensa käänteismatriiseja.


                                                                                                                                                                                                <div class="todistus drop"><h4 class="otsikko">Todistus</h4> Oletetaan, että \(BA=I\). Osoitetaan ensin, että matriisi \(A\)on kääntyvä. Tehdään tämä osoittamalla, että homogeenisella yhtälöryhmällä \(A\vx=\nv\)on vain triviaaliratkaisu. Kertomalla yhtälö puolittain matriisilla \(B\)saadaan \(BA\vx=B\nv\). Oletuksen mukaan \(BA=I\)ja toisaalta \(B\nv=\nv\), joten yhtälö tulee muotoon \(\vx=\nv\). Voidaan siis todeta, että yhtälöryhmän \(A\vx=\nv\)ainoa ratkaisu on \(\vx=\nv\). Lauseen~alla <!-- \ref{k-->aanteismatriisiLause} nojalla tästä seuraa, että \(A\)on kääntyvä.

                                                                                                                                                                                                    Koska \(A\)on kääntyvä, käänteismatriisi \(A^{-1}\)on olemassa. Kerrotaan sillä yhtälön \(BA=I\)molemmat puolet oikealta. Näin saadaan yhtälö \((BA)A^{-1}=IA^{-1}\), joka supistuu muotoon \(B=A^{-1}\). Siten \(B\)on matriisin \(A\)käänteismatriisi. Muut väitteet seuraavat tästä. Nyt tiedetään, että \(AB=I\). Lisäksi matriisin \(B\)käänteismatriisi on lauseen~\ref{joitakinKaanteismatriisejaLause} nojalla \(A\).
                                                                                                                                                                                                    <!-- %Kerrotaan sitten tämän yhtälön molemmat puolet vasemmalta matriisilla \(A\). Nyt siis \(AB=AA^{-1}\), mistä seuraa, että \(AB=I\). -->
                                                                                                                                                                                                    <!-- %Tämä todistaa väitteen. -->

                                                                                                                                                                                                    <!-- %Koska \(A\)on kääntyvä, voidaan päätellä -->
                                                                                                                                                                                                    <!-- %\begin{align*} -->
                                                                                                                                                                                                    <!-- %& BA=I \\ -->
                                                                                                                                                                                                    <!-- %\Rightarrow  & (BA)A^{-1}=IA^{-1} \\ -->
                                                                                                                                                                                                    <!-- %\Rightarrow  & B=A^{-1} \\ -->
                                                                                                                                                                                                    <!-- %\Rightarrow  & AB=AA^{-1} \\ -->
                                                                                                                                                                                                    <!-- %\Rightarrow  & AB=I. -->
                                                                                                                                                                                                    <!-- %\end{align*} -->
                                                                                                                                                                                                    <!-- %Tämä todistaa väitteen. -->
                                                                                                                                                                                                </div>

                                                                                                                                                                                                Toinen tulos liittyy siihen, millä ehdoilla kahden matriisin tulo on tai ei ole kääntyvä.

                                                                                                                                                                                                <div class="lause">
                                                                                                                                                                                                    <h3>Lause</h3><!-- \label{tulonKaantyvyysLause} --> Olkoot \(A\)ja \(B\)neliömatriiseja. Tällöin seuraavat väitteet pätevät:
                                                                                                                                                                                                    <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li> Jos \(A\)ja \(B\)ovat molemmat kääntyviä, myös tulo \(AB\)on kääntyvä.
                                                                                                                                                                                                        <li> Jos vain toinen matriiseista \(A\)ja \(B\)on kääntyvä, tulo \(AB\)ei ole kääntyvä.
                                                                                                                                                                                                        <li> Jos kumpikaan matriiseista \(A\)ja \(B\)ei ole kääntyvä, tulo \(AB\)ei ole kääntyvä.
                                                                                                                                                                                                    </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                                                    <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        a) Tämä on todistettu lauseessa~\ref{joitakinKaanteismatriisejaLause}.

                                                                                                                                                                                                        b) Oletetaan esimerkiksi, että \(A\)on kääntyvä ja \(B\)ei. Tehdään vastaoletus, että tulo \(AB\)on kääntyvä ja sillä on käänteismatriisi \(C\). Tällöin voidaan laskea
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        (CA)B=C(AB)=I.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Lauseen~alla <!-- \ref{k-->aantyvyysYksinkertaistusLause} nojalla \(B\)on kääntyvä. Tämä on ristiriita, joten vastaoletus on väärä, eli tulo \(AB\)ei ole kääntyvä.

                                                                                                                                                                                                        Tapaus, jossa \(A\)ei ole kääntyvä ja \(B\)on kääntyvä, todistetaan samaan tapaan.

                                                                                                                                                                                                        c) Tämän kohdan todistuksessa tarvitaan matriisien ja yhtälöryhmien välistä yhteyttä. Oletetaan, että \(A\)ja \(B\)eivät ole kääntyviä. Tarkastellaan homogeenista yhtälöryhmää \((AB)\vx=\nv\)ja yritetään osoittaa, että sillä on muitakin kuin triviaaliratkaisu.

                                                                                                                                                                                                        Koska \(B\)ei ole kääntyvä, yhtälöryhmällä \(B\vx=\nv\)on jokin epätriviaali ratkaisu \(\vx=\vv\neq\nv\). Tällöin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        (AB)\vv=A(B\vv)=A\nv=\nv.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Siispä \(\vx=\vv\)on myös yhtälöryhmän \((AB)\vx=\nv\)ratkaisu. Koska kyseisellä yhtälöryhmällä on epätriviaali ratkaisu, lauseesta~alla <!-- \ref{k-->aanteismatriisiLause} seuraa, että matriisi \(AB\)ei ole kääntyvä.
                                                                                                                                                                                                    </div>
                                                                                                                                                                                                </div>
                                                                                                                                                                                                </section>
                                                                                                                                                                                                <section class="kappaleraja" id="11"><div div class="kappaleraja-linis" id="Determinantti" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" "><h1>Determinantti</h1>

                                                                                                                                                                                                        Neliömatriisille voidaan laskea luku, joka kertoo muun muassa, onko matriisi kääntyvä vai ei. Tätä lukua kutsutaan matriisin determinantiksi. Determinantilla on muitakin sovelluksia, mutta tässä yhteydessä tarkastelemme vain sen yhteyttä matriisin kääntyvyyteen.

                                                                                                                                                                                                        Determinantti voidaan määritellä monin eri tavoin. Tähän lukuun on valittu eräs melko yksinkertainen tapa. Kaikki luvussa esitellyt tulokset voitaisiin johtaa valitusta määritelmästä, mutta useimmat todistukset olisivat niin työläitä, että niistä tyydytään antamaan vain perusidea. Käytettäessä hieman kehittyneempiä määritelmiä monet todistukset helpottuisivat huomattavasti, mutta itse määritelmän esittäminen olisi työläämpää.

                                                                                                                                                                                                        <h2>Pienten matriisien determinantit}

                                                                                                                                                                                                        Tarkastellaan ensin korkeintaan \(3\times 3\)-matriisien determinantteja. Determinantti voidaan laskea vain neliömatriisille.

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li>[]
                                                                                                                                                                                                        <li> Matriisin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                                                        a
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        <strong>determinantti</strong><!-- \index{determinantti} --> on \(\det(A)=a\).

                                                                                                                                                                                                        <li> Matriisin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        B=\begin{bmatrix}
                                                                                                                                                                                                        a & b \\
                                                                                                                                                                                                        c & d
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        determinantti on \(\det(B)=ad-bc\).

                                                                                                                                                                                                        <li> Matriisin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        C=\begin{bmatrix}
                                                                                                                                                                                                        a_1 & a_2 & a_3 \\
                                                                                                                                                                                                        b_1 & b_2 & b_3 \\
                                                                                                                                                                                                        c_1 & c_2 & c_3
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        determinantti on
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \det(C) & =a_1(b_2 c_3-c_2 b_3)-a_2(b_1 c_3-b_3 c_1)+a_3(b_1 c_2-b_2 c_1) \\
                                                                                                                                                                                                        & = a_1 b_2 c_3 + a_2 b_3 c_1 + a_3 b_1 c_2 - a_3 b_2 c_1 - a_2 b_1 c_3 - a_1 b_3 c_2.
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->
                                                                                                                                                                                                        }

                                                                                                                                                                                                        Matriisin determinanttia voi merkitä myös pystyviivojen avulla:
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(A)=\begin{vmatrix}
                                                                                                                                                                                                        a
                                                                                                                                                                                                        \end{vmatrix}, 
                                                                                                                                                                                                        \det(B)=\begin{vmatrix}
                                                                                                                                                                                                        a & b \\
                                                                                                                                                                                                        c & d
                                                                                                                                                                                                        \end{vmatrix}  \text{ja} 
                                                                                                                                                                                                        \det(C)=\begin{vmatrix}
                                                                                                                                                                                                        a_1 & a_2 & a_3 \\
                                                                                                                                                                                                        b_1 & b_2 & b_3 \\
                                                                                                                                                                                                        c_1 & c_2 & c_3
                                                                                                                                                                                                        \end{vmatrix}.
                                                                                                                                                                                                        \]

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> <!-- \label{detEsim1} -->
                                                                                                                                                                                                        Matriisin \(A=[4]\)determinantti on \(\det(A)=4\).
                                                                                                                                                                                                        Matriisin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        B=\begin{bmatrix}
                                                                                                                                                                                                        1 & -1 \\
                                                                                                                                                                                                        2 & \phantom{-}4
                                                                                                                                                                                                        \end{bmatrix}\]
                                                                                                                                                                                                        determinantti on puolestaan
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(B)=1 \cdot 4-(-1)\cdot 2=4+2=6.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Edelleen matriisin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        C=\begin{bmatrix}
                                                                                                                                                                                                        -2 & 3 & 2 \\
                                                                                                                                                                                                        0 & 1 & -1 \\
                                                                                                                                                                                                        1 & 2 & 4
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        determinantti on
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \det(C)
                                                                                                                                                                                                        <!-- % & =-2 \cdot -->
                                                                                                                                                                                                        <!-- % \begin{vmatrix} -->
                                                                                                                                                                                                        <!-- % 1 & -1 \\ -->
                                                                                                                                                                                                        <!-- % 2 & \phantom{-}4 -->
                                                                                                                                                                                                        <!-- % \end{vmatrix} -3 \cdot -->
                                                                                                                                                                                                        <!-- % \begin{vmatrix} -->
                                                                                                                                                                                                        <!-- % 0 & -1 \\ -->
                                                                                                                                                                                                        <!-- % 1 & \phantom{-}4 -->
                                                                                                                                                                                                        <!-- % \end{vmatrix} + 2 \cdot -->
                                                                                                                                                                                                        <!-- % \begin{vmatrix} -->
                                                                                                                                                                                                        <!-- % 0 & 1 \\ -->
                                                                                                                                                                                                        <!-- % 1 & 2 -->
                                                                                                                                                                                                        <!-- % \end{vmatrix} \\ -->
                                                                                                                                                                                                        & =-2\bigl(1\cdot 4-(-1)\cdot 2\bigr)-3\bigl(0\cdot 4-(-1)\cdot 1\bigr)+2\bigl(0\cdot 2-1\cdot 1\bigr) \\
                                                                                                                                                                                                        & =-2 \cdot 6-3 \cdot 1+2 \cdot (-1)=-17.
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Matriisille, jonka tyyppi on \(2\times 2\), voi käyttää determinantin laskemiseen kuvassa~\ref{detMuistisaanto} esitettyä muistisääntöä. Piirretään matriisin poikki vinoviivat. Samalla viivalla olevat alkiot kerrotaan keskenään. Jos viiva on lävistäjän suuntainen, tulee tulon eteen plusmerkki ja muutoin miinusmerkki. Lopuksi tulot summataan.

                                                                                                                                                                                                        Kuvassa~\ref{detMuistisaanto} on esitetty laskemista helpottava muistisääntö myös suuremman, tyyppiä \(3\times 3\)olevan matriisin determinantille. Kirjoitetaan matriisin vierelle matriisin ensimmäinen ja toinen sarake. Piirretään kuvion päälle matriisin lävistäjän suuntaisia viivoja sekä vastakkaissuuntaisia viivoja. Samalla viivalla olevat alkiot kerrotaan keskenään. Jos viiva on lävistäjän suuntainen, tulee tulon eteen plusmerkki. Jos viiva on vastakkaissuuntainen, tulee tulon eteen miinusmerkki. Lopuksi tulot lasketaan yhteen.

                                                                                                                                                                                                        <div class="image"><!-- %TODO: kuvaa on korjattava -->

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva77.png" />
                                                                                                                                                                                                        \hspace{1cm}
                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva78.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Muistisäännöt \(2 \times 2\)-determinantin ja \(3 \times 3\)-determinantin laskemiseksi.}<!-- \label{detMuistisaanto} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Determinantin merkitys näkyy siinä, että se kertoo matriisin kääntyvyydestä. Lauseen~\ref{2x2KaantyvaLause} nojalla \(2 \times 2\)-matriisi
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                                                        a & b\\
                                                                                                                                                                                                        c & d
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        on kääntyvä, jos ja vain jos \(ad-bc \neq 0\).
                                                                                                                                                                                                        Toisaalta matriisin \(A\)determinantti on \(ad-bc\). Matriisi \(A\)on siis kääntyvä,
                                                                                                                                                                                                        jos ja vain jos \(\det(A) \neq 0\). Samanlainen tulos pätee myös \(3\times 3\)-matriisien determinanteille sekä myöhemmin määriteltäville suurempien matriisien determinanteille. Todistus on esitetty tämän luvun loppupuolella.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{detKaantyvaLause} -->
                                                                                                                                                                                                        Oletetaan, että \(A\)on \(n \times n\)-matriisi. Matriisi \(A\)on kääntyvä, jos ja
                                                                                                                                                                                                        vain jos \(\det(A) \neq 0\).


                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Tutkitaan, onko vektorijono \(((2,1,-1),(0,1,-3),(-2,1,-7))\)avaruuden \(\R^3\)kanta. Kyseessä on kanta, mikäli jokainen vektori \(\vw\in\R^3\)voidaan ilmaista yksikäsitteisesti annettujen vektorien lineaarikombinaationa. Tutkittava yhtälöryhmä voidaan ilmaista matriisimuodossa yhtälönä \(A\vx=\vw\), missä
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                                                        2 & 0 & -2 \\
                                                                                                                                                                                                        1 & 1 & 1 \\
                                                                                                                                                                                                        -1 & -3 & -5
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Yhtälöryhmällä on yksikäsitteinen ratkaisu, jos ja vain jos kerroinmatriisi \(A\)on kääntyvä (lause~alla <!-- \ref{k-->aantMatrYhtaloLause}). Toisaalta lauseen~\ref{detKaantyvaLause} nojalla \(A\)on kääntyvä, jos ja vain jos sen determinantti on nollasta poikkeava. Lasketaan determinantti:
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \det(A)=\begin{vmatrix}
                                                                                                                                                                                                        2 & 0 & -2 \\
                                                                                                                                                                                                        1 & 1 & 1 \\
                                                                                                                                                                                                        -1 & -3 & -5
                                                                                                                                                                                                        \end{vmatrix}
                                                                                                                                                                                                        & =2\bigl(1\cdot(-5)-1\cdot(-3)\bigr)-0-2\bigl(1\cdot(-3)-1\cdot(-1)\bigr) \\
                                                                                                                                                                                                        & =2\cdot(-2)-2\cdot(-2)=0.
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        Koska determinantti on 0, matriisi \(A\)ei ole kääntyvä. Tästä syystä tutkittavan yhtälöryhmän ratkaisua ei ole olemassa tai se ei ole yksikäsitteinen. Annettu vektorijono ei siis muodosta kantaa.
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        <h2>Determinantin kehityskaavat}

                                                                                                                                                                                                        Suurempien matriisien determinantit voidaan laskea pienempien matriisien determinanttien avulla.

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Olkoon \(A\)jokin \(n \times n\)-matriisi.</strong><!-- \index{determinantti!kehityskaava} --> Merkitään
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                                                        a_{11} & a_{12} & \dots & a_{1n} \\
                                                                                                                                                                                                        a_{21} & a_{22} & \dots & a_{2n} \\
                                                                                                                                                                                                        \vdots & \vdots & & \vdots \\
                                                                                                                                                                                                        a_{n1} & a_{n2} & \dots & a_{nn}
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Jos \(n=1\), niin \(\det(A)=a_{11}\). Jos taas \(n>1\), niin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(A)=\sum_{i=1}^n(-1)^{1+j}a_{1j}\det(A_{1j}),
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        missä \(A_{ij}\)on matriisi, joka on saatu matriisista \(A\)poistamalla \(i\):s rivi ja \(j\):s
                                                                                                                                                                                                        sarake.
                                                                                                                                                                                                        }<!-- \label{kehityskaavaMaar} -->

                                                                                                                                                                                                        Yleisen determinantin määritelmä ei ole ristiriidassa aiempien determinantin määritelmien kanssa.
                                                                                                                                                                                                        Esimerkiksi \(3\times 3\)-matriisin determinantti on uuden määritelmän mukaan
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \begin{vmatrix}
                                                                                                                                                                                                        a_1 & a_2 & a_3 \\
                                                                                                                                                                                                        b_1 & b_2 & b_3 \\
                                                                                                                                                                                                        c_1 & c_2 & c_3
                                                                                                                                                                                                        \end{vmatrix}
                                                                                                                                                                                                        & =a_1\begin{vmatrix}
                                                                                                                                                                                                        b_2 & b_3 \\
                                                                                                                                                                                                        c_2 & c_3
                                                                                                                                                                                                        \end{vmatrix}
                                                                                                                                                                                                        -a_2\begin{vmatrix}
                                                                                                                                                                                                        b_1 & b_3 \\
                                                                                                                                                                                                        c_1 & c_3
                                                                                                                                                                                                        \end{vmatrix}
                                                                                                                                                                                                        +a_3\begin{vmatrix}
                                                                                                                                                                                                        b_1 & b_2 \\
                                                                                                                                                                                                        c_1 & b_2
                                                                                                                                                                                                        \end{vmatrix}  \\
                                                                                                                                                                                                        & a_1(b_2 c_3-c_2 b_3)-a_2(b_1 c_3-b_3 c_1)+a_3(b_1 c_2-b_2 c_1).
                                                                                                                                                                                                        \end{align*}

                                                                                                                                                                                                        Määritelmässä olevat kertoimet \(a_1j\)otetaan matriisin ensimmäiseltä riviltä. Sanotaan, että determinantti on tällöin <strong>kehitetty ensimmäisen rivin suhteen}. Yhtä hyvin voidaan käyttää muita rivejä tai jopa muita sarakkeita.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3>
                                                                                                                                                                                                        Oletetaan, että \(A\in\R^{n\times n}\), ja merkitään \(A(i,j)=a_{ij}\)kaikilla \(i,j \in \{1,\dots, n\}\).
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li>
                                                                                                                                                                                                        Olkoon \(i \in \{1, \dots ,n\}\). Tällöin
                                                                                                                                                                                                        \[\begin{equation*}
                                                                                                                                                                                                        \det(A)=\sum_{j=1}^n(-1)^{i+j}a_{ij}\det(A_{ij}),
                                                                                                                                                                                                        \begin{equation*}\]
                                                                                                                                                                                                        missä \(A_{ij}\)on matriisi, joka on saatu matriisista \(A\)poistamalla \(i\):s rivi ja \(j\):s
                                                                                                                                                                                                        sarake. Kyseessä on kehitys rivin \(i\)suhteen.
                                                                                                                                                                                                        <li>
                                                                                                                                                                                                        Olkoon \(j \in \{1, \dots ,n\}\). Tällöin
                                                                                                                                                                                                        \[\begin{equation*}
                                                                                                                                                                                                        \det(A)=\sum_{i=1}^n(-1)^{i+j}a_{ij}\det(A_{ij}),
                                                                                                                                                                                                        \begin{equation*}\]
                                                                                                                                                                                                        missä \(A_{ij}\)on matriisi, joka on saatu matriisista \(A\)poistamalla \(i\):s rivi ja \(j\):s
                                                                                                                                                                                                        sarake. Kyseessä on kehitys sarakkeen \(j\)suhteen.
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>[Todistuksen idea]
                                                                                                                                                                                                        Lause voidaan todistaa tarkastelemalla, millaiseen lausekkeeseen määritelmän~alla <!-- \ref{k-->ehityskaavaMaar} kehityskaava lopulta johtaa. Syntyvä lauseke on summa tuloista
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \pm a_{ik_1}a_{ik_2}\cdots a_{ik_n},
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        missä \(k_1,\dots,k_n\)ovat sarakkeiden indeksit jossakin järjestyksessä. Esimerkiksi tyypin \(3\times 3\)matriisin determinantin laskeminen johtaa näillä merkinnöillä lausekkeeseen
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        a_{11}a_{22}a_{33}+a_{12}a_{23}a_{31}+a_{13}a_{21}a_{32}
                                                                                                                                                                                                        -a_{13}a_{22}a_{31}-a_{12}a_{21}a_{33}-a_{11}a_{23}a_{32}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Kunkin termin etumerkki määräytyy siitä, onko sarakkeiden järjestys \(k_1,\dots,k_n\)alkuperäisen järjestyksen \(1,\dots,n\)ns. parillinen vai pariton permutaatio. Tämän havainnon jälkeen on suoraviivaista tarkistaa, että jokainen kehityskaava johtaa itse asiassa täsmälleen samaan lausekkeeseen.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Toisinaan voi säästää vaivaa, jos valitsee viisaasti rivin tai sarakkeen, jonka
                                                                                                                                                                                                        suhteen determinantin kehittää. Lasketaan matriisin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        D=\begin{bmatrix}
                                                                                                                                                                                                        1 & 2 & \phantom{-}3 & \phantom{-}0 \\
                                                                                                                                                                                                        0 & 1 & \phantom{-}0 & -1 \\
                                                                                                                                                                                                        0 & 0 & -1 & \phantom{-}0 \\
                                                                                                                                                                                                        2 & 1 & -4 & -1
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        determinantti kehittämällä se aluksi kolmannen rivin ja välivaiheessa kolmannen sarakkeen suhteen:
                                                                                                                                                                                                        \pagebreak[0]
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        & \det(D)=\begin{vmatrix}[rrrr]
                                                                                                                                                                                                        1 & 2 & 3 & 0 \\
                                                                                                                                                                                                        0 & 1 & 0 & -1 \\
                                                                                                                                                                                                        0 & 0 & -1 & 0 \\
                                                                                                                                                                                                        2 & 1 & -4 & -1
                                                                                                                                                                                                        \end{vmatrix} \\
                                                                                                                                                                                                        &= 0  \cdot \begin{vmatrix}[rrrr]
                                                                                                                                                                                                        2 & 3 & 0 \\
                                                                                                                                                                                                        1 & 0 & -1 \\
                                                                                                                                                                                                        1 & -4 & -1
                                                                                                                                                                                                        \end{vmatrix} - 0 \cdot \begin{vmatrix}[rrrr]
                                                                                                                                                                                                        1 & 3 & 0 \\
                                                                                                                                                                                                        0 & 0 & -1 \\
                                                                                                                                                                                                        2 & -4 & -1
                                                                                                                                                                                                        \end{vmatrix}
                                                                                                                                                                                                        +(-1) \cdot \begin{vmatrix}[rrrr]
                                                                                                                                                                                                        1 & 2 & 0 \\
                                                                                                                                                                                                        0 & 1 & -1 \\
                                                                                                                                                                                                        2 & 1 & -1
                                                                                                                                                                                                        \end{vmatrix} - 0 \cdot \begin{vmatrix}[rrrr]
                                                                                                                                                                                                        1 & 2 & 3 \\
                                                                                                                                                                                                        0 & 1 & 0 \\
                                                                                                                                                                                                        2 & 1 & -4
                                                                                                                                                                                                        \end{vmatrix} \\
                                                                                                                                                                                                        &=-\begin{vmatrix}[rrrr]
                                                                                                                                                                                                        1 & 2 & 0  \\
                                                                                                                                                                                                        0 & 1 & -1 \\
                                                                                                                                                                                                        2 & 1 & -1
                                                                                                                                                                                                        \end{vmatrix} = -\left(0 \cdot \begin{vmatrix}[rrrr]
                                                                                                                                                                                                        0&1\\
                                                                                                                                                                                                        2&1
                                                                                                                                                                                                        \end{vmatrix} - (-1) \cdot \begin{vmatrix}[rrrr]
                                                                                                                                                                                                        {1}&{2}\\
                                                                                                                                                                                                        {2}&{1}
                                                                                                                                                                                                        \end{vmatrix} + {(-1)} \cdot \begin{vmatrix}[rrrr]
                                                                                                                                                                                                        {1}&{2}\\
                                                                                                                                                                                                        {0}&{1}
                                                                                                                                                                                                        \end{vmatrix} \right)\\
                                                                                                                                                                                                        &= -\bigl(0+(1 \cdot 1-2\cdot 2) - (1 \cdot 1-0\cdot 2)\bigr) = -(0-3 - 1) = 4.
                                                                                                                                                                                                        \end{align*}

                                                                                                                                                                                                        \begin{comment}
                                                                                                                                                                                                        Saadaan
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(C)=\begin{vmatrix}
                                                                                                                                                                                                        -2 & 3 & 2 \\
                                                                                                                                                                                                        0 & 1 & -1 \\
                                                                                                                                                                                                        1 & 2 & 4
                                                                                                                                                                                                        \end{vmatrix}=-2 \cdot
                                                                                                                                                                                                        \begin{vmatrix}
                                                                                                                                                                                                        1 & -1 \\
                                                                                                                                                                                                        2 & 4
                                                                                                                                                                                                        \end{vmatrix} -0 \cdot
                                                                                                                                                                                                        \begin{vmatrix}
                                                                                                                                                                                                        3 & 2 \\
                                                                                                                                                                                                        2 & 4
                                                                                                                                                                                                        \end{vmatrix} + 1 \cdot
                                                                                                                                                                                                        \begin{vmatrix}
                                                                                                                                                                                                        3 & 2 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{vmatrix}=-13.\]
                                                                                                                                                                                                        \end{comment}

                                                                                                                                                                                                        Kehityskaavojen etumerkkien vaihtelu (eli kaavoissa muotoa \((-1)^{i+j}\)oleva kerroin) saadaan shakkilautaa muistuttavasta kuviosta:
                                                                                                                                                                                                        \[\begin{equation*}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        + & - & + & - & \dots\\
                                                                                                                                                                                                        - & + & - & + & \\
                                                                                                                                                                                                        + & - & + & - & \\
                                                                                                                                                                                                        \vdots & & & &
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \begin{equation*}\]
                                                                                                                                                                                                        Matriisin tilalle ajatellaan plus- ja miinusmerkeistä koostuva ruudukko, jonka vasemmassa yläkulmassa on plusmerkki. Jos matriisin alkion kohdalla on plusmerkki, tulee kehityskaavassa alkion eteen plusmerkki. Vastaavasti jos alkion kohdalla on miinusmerkki, tulee kehityskaavaankin miinusmerkki. Kunkin alkion omaa etumerkkiä ei myöskään sovi unohtaa.

                                                                                                                                                                                                        <h2>Determinantin ominaisuuksia}

                                                                                                                                                                                                        Tarkastellaan vielä, miten determinantti suhtautuu matriisien alkeisrivitoimituksiin sekä laskutoimituksiin. Seuraavan tuloksen voi todistaa pienille matriiseille suoraan laskemalla, ja yleisen tapauksen voi johtaa determinanttien kehityskaavoista.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3><!-- \label{determinanttiRivitoimitusLause} -->
                                                                                                                                                                                                        Oletetaan, että \(A\)on neliömatriisi.
                                                                                                                                                                                                        <ol>
                                                                                                                                                                                                        <li> Jos matriisi \(B\)saadaan \(A\):sta vaihtamalla kaksi riviä keskenään,
                                                                                                                                                                                                        niin \(\det(B)=-\det(A)\).
                                                                                                                                                                                                        <li> Jos matriisi \(B\)saadaan matriisista \(A\)kertomalla jokin rivi nollasta poikkeavalla reaaliluvulla \(t\), niin \(\det(B)=t\det(A)\).
                                                                                                                                                                                                        <li> Jos matriisi \(B\)saadaan matriisista \(A\)lisäämällä johonkin riviin jokin
                                                                                                                                                                                                        toinen rivi reaaliluvulla \(k\)kerrottuna, niin \(\det(B)=\det(A)\).
                                                                                                                                                                                                        </ol>


                                                                                                                                                                                                        Lauseen \ref{determinantinOminaisuuksiaLause} kohdasta a) seuraa, että
                                                                                                                                                                                                        determinantin sarakkeet
                                                                                                                                                                                                        käyttäytyvät täsmälleen samalla tavalla kuin sen rivit.
                                                                                                                                                                                                        Lauseesta \ref{determinanttiRivitoimitusLause}
                                                                                                                                                                                                        saadaan siis seuraavat muistisäännöt:
                                                                                                                                                                                                        <ol>
                                                                                                                                                                                                        <li>
                                                                                                                                                                                                        Jos matriisin kaksi riviä (tai saraketta) vaihtaa keskenään, determinantin etumerkki muuttuu:
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{vmatrix}
                                                                                                                                                                                                        3&2&7\\
                                                                                                                                                                                                        1&6&0\\
                                                                                                                                                                                                        5&8&4
                                                                                                                                                                                                        \end{vmatrix} =-\begin{vmatrix}
                                                                                                                                                                                                        1&6&0\\
                                                                                                                                                                                                        3&2&7\\
                                                                                                                                                                                                        5&8&4
                                                                                                                                                                                                        \end{vmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        <li>
                                                                                                                                                                                                        Jos matriisin rivillä (tai sarakkeessa) kaikilla alkioilla on yhteinen nollasta poikkeava tekijä, tuon yhteisen tekijän voi ottaa determinantin eteen kertoimeksi:
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{vmatrix}
                                                                                                                                                                                                        1&6&0\\
                                                                                                                                                                                                        3&2&7\\
                                                                                                                                                                                                        5&8&4
                                                                                                                                                                                                        \end{vmatrix} = 2 \cdot\begin{vmatrix}
                                                                                                                                                                                                        1&3&0\\
                                                                                                                                                                                                        3&1&7\\
                                                                                                                                                                                                        5&4&4
                                                                                                                                                                                                        \end{vmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        <li>
                                                                                                                                                                                                        Jos matriisin riviin (tai sarakkeeseen) lisätään jokin toinen rivi (tai sarake)
                                                                                                                                                                                                        vakiolla kerrottuna, matriisin determinantti ei muutu:
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{vmatrix}
                                                                                                                                                                                                        1&3&0\\
                                                                                                                                                                                                        3&1&7\\
                                                                                                                                                                                                        5&4&4
                                                                                                                                                                                                        \end{vmatrix} = \begin{vmatrix}
                                                                                                                                                                                                        1&\phantom{-}3&0\\
                                                                                                                                                                                                        0&-8&7\\
                                                                                                                                                                                                        5&\phantom{-}4&4
                                                                                                                                                                                                        \end{vmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        </ol>

                                                                                                                                                                                                        Lauseesta seuraa myös, että eräiden matriisien determinantti on helppo määrittää suoraan matriisista.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3><!-- \label{lause:detPorrasmatriisit} -->
                                                                                                                                                                                                        Oletetaan, että \(A\)on neliömatriisi. Tällöin
                                                                                                                                                                                                        <ol>
                                                                                                                                                                                                        <li> jos matriisissa \(A\)on nollarivi (nollasarake), niin \(\det(A) = 0\)
                                                                                                                                                                                                        <li> jos matriisissa \(A\)on kaksi samaa riviä (samaa saraketta), niin \(\det(A) = 0\)
                                                                                                                                                                                                        <li> jos \(A\)on kolmiomatriisi eli kaikki lävistäjän alapuoliset tai yläpuoliset alkiot ovat nollia, niin matriisin \(A\)determinantti on lävistäjäalkioiden tulo.
                                                                                                                                                                                                        </ol>


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4> Todistetaan vain rivejä koskevat väitteet. Sarakkeita koskevat väitteet voidaan käsitellä samalla tavalla.
                                                                                                                                                                                                        <ol>
                                                                                                                                                                                                        <li> Kerrotaan matriisin nollarivi luvulla \(-1\), jolloin matriisi ei muutu. Edeltävän lauseen mukaan pätee siis \(\det(A)=-1\cdot\det(A)\), josta seuraa, että \(\det(A)=0\).

                                                                                                                                                                                                        <li> Vaihdetaan matriisin samanlaiset rivit keskenään, jolloin matriisi ei muutu. Edeltävän lauseen mukaan \(\det(A)=-\det(A)\), joten \(\det(A)=0\).

                                                                                                                                                                                                        <li> Tulos nähdään suoraan kehittämällä matriisi rivi riviltä alkaen ylimmästä tai alimmasta rivistä, jolla on vain yksi nollasta poikkeava alkio. \qedhere
                                                                                                                                                                                                        </ol>
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Edeltäviä lauseita voidaan käyttää hyväksi determinantin laskemisessa. Kun matriisi muutetaan porrasmatriisiksi alkeisrivitoimitusten avulla, determinantti muuttuu lauseessa~\ref{determinanttiRivitoimitusLause} kuvatulla tavalla. Porrasmatriisin determinantti voidaan puolestaan määrittää lauseen~\ref{lause:detPorrasmatriisit} avulla.

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> Lasketaan matriisin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{bmatrix}[rrrr]
                                                                                                                                                                                                        1 & -2 & 0 & 1 \\
                                                                                                                                                                                                        -2 & 4 & 1 & 0 \\
                                                                                                                                                                                                        2 & 0 & -2 & 1 \\
                                                                                                                                                                                                        3 & 2 & -1 & -5
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        determinantti muuntamalla se vaiheittain porrasmatriisiksi. Tarvittavat alkeisrivitoimitukset ovat seuraavat:
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        & \begin{bmatrix}[rrrr]
                                                                                                                                                                                                        1 & -2 & 0 & 1 \\
                                                                                                                                                                                                        -2 & 4 & 1 & 0 \\
                                                                                                                                                                                                        2 & 0 & -2 & 1 \\
                                                                                                                                                                                                        3 & 2 & -1 & -5
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \overset{R_2+2R_1}{\longrightarrow}
                                                                                                                                                                                                        \begin{bmatrix}[rrrr]
                                                                                                                                                                                                        1 & -2 & 0 & 1 \\
                                                                                                                                                                                                        0 & 0 & 1 & 2 \\
                                                                                                                                                                                                        2 & 0 & -2 & 1 \\
                                                                                                                                                                                                        3 & 2 & -1 & -5
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \overset{R_3-2R_1}{\longrightarrow}
                                                                                                                                                                                                        \begin{bmatrix}[rrrr]
                                                                                                                                                                                                        1 & -2 & 0 & 1 \\
                                                                                                                                                                                                        0 & 0 & 1 & 2 \\
                                                                                                                                                                                                        0 & 4 & -2 & -1 \\
                                                                                                                                                                                                        3 & 2 & -1 & -5
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \overset{R_4-3R_1}{\longrightarrow} \\
                                                                                                                                                                                                        & \begin{bmatrix}[rrrr]
                                                                                                                                                                                                        1 & -2 & 0 & 1 \\
                                                                                                                                                                                                        0 & 0 & 1 & 2 \\
                                                                                                                                                                                                        0 & 4 & -2 & -1 \\
                                                                                                                                                                                                        0 & 8 & -1 & -8
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \overset{R_4-2R_3}{\longrightarrow}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        1 & -2 & 0 & 1 \\
                                                                                                                                                                                                        0 & 0 & 1 & 2 \\
                                                                                                                                                                                                        0 & 4 & -2 & -1 \\
                                                                                                                                                                                                        0 & 0 & 3 & -6
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \overset{R_4-3R_2}{\longrightarrow}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        1 & -2 & 0 & 1 \\
                                                                                                                                                                                                        0 & 0 & 1 & 2 \\
                                                                                                                                                                                                        0 & 4 & -2 & -1 \\
                                                                                                                                                                                                        0 & 0 & 0 & -12
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \overset{R_2\leftrightarrow R_3}{\longrightarrow} \\
                                                                                                                                                                                                        & \begin{bmatrix}
                                                                                                                                                                                                        1 & -2 & 0 & 1 \\
                                                                                                                                                                                                        0 & 4 & -2 & -1 \\
                                                                                                                                                                                                        0 & 0 & 1 & 2 \\
                                                                                                                                                                                                        0 & 0 & 0 & -12
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        Tuloksena on yläkolmiomatriisi, jonka determinantti on lävistäjäalkioiden tulo eli tässä tapauksessa \(-48\). Lauseen~\ref{determinanttiRivitoimitusLause} perusteella ainoastaan viimeinen alkeisrivitoimitus muutti matriisin determinanttia, ja sekin aiheutti vain etumerkin muutoksen. Siispä alkuperäisen matriisin determinantti oli \(48\).
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Alkeisrivitoimituksia tarkastelemalla voidaan todistaa myös kääntyvän matriisin determinanttiin liittyvä lause.

                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>[Lauseen~\ref{detKaantyvaLause} todistus]
                                                                                                                                                                                                        Osoitetaan, että matriisi on kääntyvä, jos ja vain jos sen determinantti ei ole nolla.
                                                                                                                                                                                                        Neliömatriisi \(A\)on kääntyvä täsmälleen silloin, kun se voidaan muuttaa alkeisrivitoimituksilla ykkösmatriisiksi, muuten porrasmatriisiin tulee nollarivi. Ykkösmatriisin determinantti on 1 ja nollarivin omaavan matriisin 0. Toisaalta jokainen alkeisrivitoimitus säilyttää determinantin nollana tai nollasta poikkeavana sen mukaan, mitä se oli alun perin. Täten matriisi \(A\)on kääntyvä täsmälleen silloin, kun sen determinantti on nollasta poikkeava.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <!-- % Esimerkiksi -->
                                                                                                                                                                                                        <!-- % \[ -->
                                                                                                                                                                                                        <!-- % \begin{vmatrix} -->
                                                                                                                                                                                                        <!-- % 1&7&0&6\\ -->
                                                                                                                                                                                                        <!-- % 0&3&4&5\\ -->
                                                                                                                                                                                                        <!-- % 0&0&8&2\\ -->
                                                                                                                                                                                                        <!-- % 0&0&0&9 -->
                                                                                                                                                                                                        <!-- % \end{vmatrix}=1 \cdot 3 \cdot 4 \cdot 9=108 -->
                                                                                                                                                                                                        <!-- %  -->
                                                                                                                                                                                                        <!-- % \text{ja} -->
                                                                                                                                                                                                        <!-- %  \begin{vmatrix} -->
                                                                                                                                                                                                        <!-- % 1&0&0&0\\ -->
                                                                                                                                                                                                        <!-- % 2&0&0&0\\ -->
                                                                                                                                                                                                        <!-- % 0&5&8&0\\ -->
                                                                                                                                                                                                        <!-- % 4&6&7&9 -->
                                                                                                                                                                                                        <!-- % \end{vmatrix} -->
                                                                                                                                                                                                        <!-- % =1 \cdot 0 \cdot 8 \cdot 9=0. -->
                                                                                                                                                                                                        <!-- % \] -->

                                                                                                                                                                                                        Tarkastellaan vielä matriisien laskutoimituksien vaikutusta determinanttiin.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{determinantinOminaisuuksiaLause} -->
                                                                                                                                                                                                        Oletetaan, että \(A\)ja \(B\)ovat neliömatriiseja. Tällöin
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li> \(\det(\tp{A}) = \det(A)\)
                                                                                                                                                                                                        <li> \(\det(AB) = \det(A)\det(B)\).
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>[Todistuksen idea]
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li>[]
                                                                                                                                                                                                        <li> Tulos seuraa siitä, että determinantit voidaan kehittää yhtä hyvin sarakkeiden kuin rivienkin suhteen.

                                                                                                                                                                                                        <li> Jos jompikumpi tai molemmat matriiseista \(A\)ja \(B\)eivät ole kääntyviä, lauseen~\ref{tulonKaantyvyysLause} perusteella myöskään niiden tulo ei ole kääntyvä. Tällöin väite pätee lauseen~\ref{detKaantyvaLause} nojalla. Oletetaan sitten, että \(A\)ja \(B\)ovat kääntyviä ja kirjoitetaan ne alkeismatriisien tuloina:
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A=E_1\cdots E_r  \text{ja}  B=F_1\cdots F_s.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Lauseesta~\ref{determinanttiRivitoimitusLause} seuraa, että jos \(E\)on alkeismatriisi, jokaiselle neliömatriisille \(M\)pätee
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(EM)=\det(E)\det(M).
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Käyttämällä tätä havaintoa toistuvasti yllä esitettyihin tuloihin, nähdään, että
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(A)=\det(E_1)\cdots\det(E_r)  \text{ja}  \det(B)=\det(F_1)\cdots\det(F_s).
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Toisaalta \(AB=E_1\cdots E_r F_1\cdots F_s\), ja samalla tavoin kuin edellä saadaan
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(AB)=\det(E_1)\cdots\det(E_r)\cdot\det(F_1)\cdots\det(F_s).
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Väite seuraa tästä.\qedhere
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3>
                                                                                                                                                                                                        Oletetaan, että neliömatriisi \(A\)on kääntyvä. Tällöin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(A^{-1})=\frac{1}{\det(A)}.
                                                                                                                                                                                                        \]


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4> Oletuksen mukaan matriisi \(A\)on kääntyvä, joten sillä on käänteismatriisi \(A^{-1}\).
                                                                                                                                                                                                        Edellisen lauseen b)-kohdan nojalla pätee
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(A)\det(A^{-1})=\det(AA^{-1})=\det(I)=1.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Toisaalta lauseen \ref{detKaantyvaLause} mukaan \(\det(A) \neq 0\), sillä \(A\)on kääntyvä. Jakamalla puolittain saadaan
                                                                                                                                                                                                        \(\det(A^{-1})=1/\det(A)\).
                                                                                                                                                                                                        </div>


                                                                                                                                                                                                        <!-- \begin{comment}
                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        <strong>Determinanttifunktio} on kuvaus \(D \ : \ (\K^n)^n \rightarrow \K\), jolle pätevät
                                                                                                                                                                                                        seuraavat ehdot kaikilla \(a_1, a_2, \dots ,a_n \in \K^n\):
                                                                                                                                                                                                        \begin{enumerate}
                                                                                                                                                                                                        <li>[(D1)]
                                                                                                                                                                                                        jokaisella \(i \in \{1, \dots n\}\)ja kiinteillä \(a_1, \dots  , a_{i-1}, a_{i+1}, \dots ,a_n\)
                                                                                                                                                                                                        kuvaus \(a_i \mapsto D(a_1, \dots  , a_i, \dots ,a_n)\)on lineaarinen
                                                                                                                                                                                                        <li>[(D2)] jos \(a_i=a_{i+1}\)jollakin \(i \in \{1,2, \dots , n-1\}\), niin
                                                                                                                                                                                                        \)D(a_1, \dots , a_n)=0\)
                                                                                                                                                                                                        <li>[(D3)] \(D(e_1, \dots , e_n)=1\), missä \(e_i=(0, \dots ,1, \dots , 0)\)(ykkönen \(i\):nnellä paikalla).
                                                                                                                                                                                                        \end{enumerate}
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3>
                                                                                                                                                                                                        Jokaisella \(n \ge 1\)on olemassa täsmälleen yksi determinattifunktio
                                                                                                                                                                                                        \)D: (\K^n)^n \mapsto \K\).
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Neliömatriisin \(A\)<strong>determinantti} \(\det(A)\)on \(D(a_1, \dots, a_n)\), missä \(a_1, \dots , a_n\)
                                                                                                                                                                                                        ovat \(A\):n sarakkeet ja \(D: (\K^n)^n \mapsto \K\)determinanttifunktio.
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        
                                                                                                                                                                                                        Ehdoista ii) ja iii) seuraa, että matriisin \(A\)determinantin arvo on sama kuin
                                                                                                                                                                                                        sen konjugaatin \(P^{-1}AP\)(\(P\)on mikä tahansa kääntyvä matriisi). Determinantin
                                                                                                                                                                                                        arvo ei siis muutu kannanvaihdossa.
                                                                                                                                                                                                        
                                                                                                                                                                                                        Ehdosta ii) seuraa, että determinanttikuvaus on ryhmähomomorfismi kääntyvien matriisien ryhmältä
                                                                                                                                                                                                        ryhmälle \(\K^*\). Kääntyvien mariisien muodostamaa ryhmää käsitellään seuraavassa luvussa.
                                                                                                                                                                                                        
                                                                                                                                                                                                        \end{comment} -->
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </section>
                                                                                                                                                                                                        <section class="kappaleraja" id="12">
                                                                                                                                                                                                        <div div class="kappaleraja-linis" id="Ominaisarvot ja diagonalisointi" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                                                                                                                                                                                                        <h1>Ominaisarvot ja diagonalisointi</h1>


                                                                                                                                                                                                        Tässä luvussa tarkastellaan neliömatriisin ominaisarvoja ja diagonalisointia. Sovelluksena esitetään laskumenetelmä diagonalisoituvan matriisin potensseille. Ominaisarvoja tarkastellaan lisää kurssin toisessa osassa.

                                                                                                                                                                                                        <h2>Ominaisarvon määritelmä}

                                                                                                                                                                                                        Matriisin ominaisarvoista puhutaan silloin, kun matriisilla kertominen vaikuttaa johonkin vektorin samalla tavalla kuin skalaarilla kertominen. Tuo vektori on silloin matriisin ominaisvektori ja vastaava skalaari on matriisin ominaisarvo.

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Oletetaan, että \(A\)on \(n \times n\)-neliömatriisi. Luku \(\lambda \in \R\)on matriisin \(A\)
                                                                                                                                                                                                        <strong>ominaisarvo</strong><!-- \index{ominaisarvo} -->, jos on olemassa sellainen vektori \(\vv \in \R^n\), että \(\vv \neq \nv\)ja
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A\vv=\lambda \bar{v}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Vektoria  \(\vv\), joka toteuttaa yllä mainitun ehdon kutsutaan ominaisarvoon \(\lambda\)liittyväksi <strong>ominaisvektoriksi</strong><!-- \index{ominaisvektori} -->.
                                                                                                                                                                                                        }

                                                                                                                                                                                                        <strong>Huom. 1. Edellinen määritelmä on sekä ominaisarvon että ominaisvektorin määritelmä. Ominaisarvoa ei voida määritellä ilman ominaisvektoreita eikä ominaisvektoreista voida puhua mainitsematta, mihin ominaisarvoon ne liittyvät.

                                                                                                                                                                                                        <strong>Huom. 2. Nollavektorin ei haluta olevan ominaisvektori, sillä jos niin olisi, kaikki reaaliluvut olisivat kaikkien matriisien ominaisarvoja, koska \(A\nv=\lambda\nv\)kaikilla \(\lambda\in\R\).

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> <!-- \label{ominaisarvoEsim} -->
                                                                                                                                                                                                        Matriisilla
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                                                        3 & 1 \\
                                                                                                                                                                                                        1 & 3
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        on ominaisarvo 4, johon liitty ominaisvektori \((1,1)\). Tämä nähdään laskemalla matriisin \(A\)ja vektorin \((1,1)\)tulo:
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        3 & 1 \\
                                                                                                                                                                                                        1 & 3
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        1 \\
                                                                                                                                                                                                        1
                                                                                                                                                                                                        \end{bmatrix}=
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        4 \\
                                                                                                                                                                                                        4
                                                                                                                                                                                                        \end{bmatrix}=
                                                                                                                                                                                                        4\begin{bmatrix}
                                                                                                                                                                                                        1 \\
                                                                                                                                                                                                        1
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]

                                                                                                                                                                                                        Samaa ominaisarvoa voi vastata useampi eri ominaisvektori. Esimerkiksi \((2,2)\)on myös matriisin \(A\)ominaisarvoa 4 vastaava ominaisvektori, sillä
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        3 & 1 \\
                                                                                                                                                                                                        1 & 3
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        2 \\
                                                                                                                                                                                                        2
                                                                                                                                                                                                        \end{bmatrix}=
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        8 \\
                                                                                                                                                                                                        8
                                                                                                                                                                                                        \end{bmatrix}=
                                                                                                                                                                                                        4\begin{bmatrix}
                                                                                                                                                                                                        2 \\
                                                                                                                                                                                                        2
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]

                                                                                                                                                                                                        Matriisilla \(A\)ominaisarvon 4 lisäksi toinenkin ominaisarvo. Huomataan nimittäin, että
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        3 & 1 \\
                                                                                                                                                                                                        1 & 3
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        1 \\
                                                                                                                                                                                                        -1
                                                                                                                                                                                                        \end{bmatrix}=
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        2 \\
                                                                                                                                                                                                        -2
                                                                                                                                                                                                        \end{bmatrix}=
                                                                                                                                                                                                        2\begin{bmatrix}
                                                                                                                                                                                                        1 \\
                                                                                                                                                                                                        -1
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Siten myös luku 2 on matriisin \(A\)ominaisarvo.

                                                                                                                                                                                                        Kun matriisilla kertoo ominaisvektoria \(\vv\), tuloksena on vektorin \(\vv\)skalaarimonikerta. Toisin sanoen tulos on vektorin \(\vv\)virittämällä suoralla (ks. kuva alla <!-- \ref{k-->124}).

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva124.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Vektori \(\vv_1=(1,1)\)on matriisin \(A\)ominaisvektori, sillä \(A\vv_1\)on vektorin \(\vv_1\)virittämällä suoralla. Samoin vektori \(\vv_2=(1,-1)\)on matriisin \(A\)ominaisvektori, sillä \(A\vv_2\)on vektorin \(\vv_2\)virittämällä suoralla.}<!-- \label{k124} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Tutkitaan vielä lopuksi, onko vektori \(\vw=(2,1)\)matriisin \(A\)ominaisvektori. Nähdään, että \(A\vw=(7,5)\). Tuloksena ei ole vektorin \(\vw\)skalaarimonikerta, joten \(\vw\)ei ole matriisin \(A\)ominaisvektori.

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva125.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Vektori \(\vw=(2,1)\)ei ole matriisin \(A\)ominaisvektori, sillä \(A\vw\)ei ole vektorin \(\vw\)virittämällä suoralla.}<!-- \label{k125} -->
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Kuten edellinen esimerkki osoittaa, matriisilla voi olla useampi kuin yksi ominaisarvo. Kuhunkin ominaisarvoon liittyvät omat ominaisvektorit, ja myös niitä on kullakin ominaisarvolla useita.

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"><!-- \label{esim:ominaisvektorit} -->
                                                                                                                                                                                                        Jatketaan edellistä esimerkkiä ja etsitään kaikki matriisin \(A\)ominaisarvoa 4 vastaavat ominaisvektorit. On siis ratkaistava yhtälöstä \(A\vv=4\vv\)tuntematon \(\vv\). Yhtälö saadaan muotoon
                                                                                                                                                                                                        \[A\vv-4\vv=\nv.\]

                                                                                                                                                                                                        Tästä yhtälöstä haluttaisiin nyt ottaa yhteiseksi tekijäksi \(\vv\), mutta se ei onnistu, sillä \(A\)on matriisi ja 4 on reaaliluku eikä niitä voi vähentää toisistaan. Huomataan kuitenkin, että luvulla 4 kertominen on sama asia kuin skalaarimatriisilla
                                                                                                                                                                                                        \)4I=
                                                                                                                                                                                                        [\begin{smallmatrix}
                                                                                                                                                                                                        4 & 0 \\
                                                                                                                                                                                                        0 & 4
                                                                                                                                                                                                        \end{smallmatrix}]
                                                                                                                                                                                                        \)
                                                                                                                                                                                                        kertominen. Siten \(4\vv=4I\vv\). Nyt yhtälö saadaan muotoon
                                                                                                                                                                                                        \)A\vv-4I\vv=\nv\), josta seuraa
                                                                                                                                                                                                        \[(A-4I)\vv=\nv.\]

                                                                                                                                                                                                        Sijoitetaan yhtälöön matriisi \(A\):
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \left(\begin{bmatrix}
                                                                                                                                                                                                        3 & 1 \\
                                                                                                                                                                                                        1 & 3
                                                                                                                                                                                                        \end{bmatrix}-
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        4 & 0 \\
                                                                                                                                                                                                        0 & 4
                                                                                                                                                                                                        \end{bmatrix}\right)
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        v_1 \\
                                                                                                                                                                                                        v_2
                                                                                                                                                                                                        \end{bmatrix}=
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        0 \\
                                                                                                                                                                                                        0
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Nyt yhtälö sievenee muotoon
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        -1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        v_1 \\
                                                                                                                                                                                                        v_2
                                                                                                                                                                                                        \end{bmatrix}=
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        0 \\
                                                                                                                                                                                                        0
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        <!-- %ja edelleen muotoon -->
                                                                                                                                                                                                        <!-- %\[ -->
                                                                                                                                                                                                        <!-- %\begin{bmatrix} -->
                                                                                                                                                                                                        <!-- %-v_1+v_2 \\ -->
                                                                                                                                                                                                        <!-- %v_1-v_2 -->
                                                                                                                                                                                                        <!-- %\end{bmatrix}= -->
                                                                                                                                                                                                        <!-- %\begin{bmatrix} -->
                                                                                                                                                                                                        <!-- %0 \\ -->
                                                                                                                                                                                                        <!-- %0 -->
                                                                                                                                                                                                        <!-- %\end{bmatrix}. -->
                                                                                                                                                                                                        <!-- %\] -->
                                                                                                                                                                                                        Päädytään siis ratkaisemaan yhtälöryhmä
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \left\{
                                                                                                                                                                                                        \begin{aligned}
                                                                                                                                                                                                        -v_1+v_2 &= 0 \\
                                                                                                                                                                                                        v_1-v_2& =0 \\
                                                                                                                                                                                                        \end{aligned}\right.
                                                                                                                                                                                                        \]

                                                                                                                                                                                                        Muutetaan yhtälöryhmän matriisi porrasmuotoon:
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{bmatrix}[cc|c]
                                                                                                                                                                                                        -1 & 1 & 0 \\
                                                                                                                                                                                                        1 & -1 & 0
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \overset{R_2+R_1}{\longrightarrow}
                                                                                                                                                                                                        \begin{bmatrix}[cc|c]
                                                                                                                                                                                                        -1 & 1 & 0\\
                                                                                                                                                                                                        0 & 0 & 0
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \overset{R_1\leftrightarrow R_2}{\longrightarrow}
                                                                                                                                                                                                        \begin{bmatrix}[cc|c]
                                                                                                                                                                                                        1 & -1 & 0\\
                                                                                                                                                                                                        0 & 0 & 0
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Merkitään \(v_2=t\). Nyt \(v_1=v_2=t\). Siten yhtälön ratkaisu on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \left\{
                                                                                                                                                                                                        \begin{aligned}
                                                                                                                                                                                                        v_1 &= t \\
                                                                                                                                                                                                        v_2& = t,  \text{missä \(t \in \R\).} \\
                                                                                                                                                                                                        \end{aligned}\right.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Nollavektoria ei kuitenkaan määritelmän mukaan kelpuuteta ominaisvektoriksi.
                                                                                                                                                                                                        Siten ominaisarvoa \(4\)vastaavat ominaisvektorit ovat muotoa
                                                                                                                                                                                                        \)(t,t)\), missä \(t\in\R\setminus\{0\}\).
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        <h2>Ominaisarvojen löytäminen}

                                                                                                                                                                                                        Ominaisarvojen ja ominaisvektoreiden löytäminen perustuu yhtälön
                                                                                                                                                                                                        \begin{equation}<!-- \label{yhtalo:ominaisarvo1} -->
                                                                                                                                                                                                        A\vv-\lambda\vv=\nv
                                                                                                                                                                                                        \end{equation}
                                                                                                                                                                                                        ratkaisemiseen. Ominaisvektoria \(\vv\)ei kuitenkaan voida ratkaista ennen kuin tunnetaan ominaisarvo \(\lambda\). Sen löytämiseksi muutetaan yhtälö hieman toiseen muotoon samaan tapaan kuin esimerkissä \ref{esim:ominaisvektorit}. Ensinnäkin huomataan, että \(\lambda\vv=\lambda I\vv\), missä \(I\)on ykkösmatriisi. Näin ollen
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A\vv-\lambda\vv=A\vv-\lambda I\vv=(A-\lambda I)\vv.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Nyt yhtälö~\eqref{yhtalo:ominaisarvo1} tulee muotoon
                                                                                                                                                                                                        \begin{equation}<!-- \label{yhtalo:ominaisarvo2} -->
                                                                                                                                                                                                        (A-\lambda I)\vv=\nv.
                                                                                                                                                                                                        \end{equation}

                                                                                                                                                                                                        Yhtälöä~\eqref{yhtalo:ominaisarvo2} vastaa homogeeninen yhtälöryhmä, joten sillä on aina triviaaliratkaisu \(\vv=\nv\). Tämä ei kuitenkaan kelpaa ominaisvektoriksi, joten tavoitteena on löytää jokin epätriviaali ratkaisu. Lauseen~alla <!-- \ref{k-->aanteismatriisiLause} nojalla yhtälöllä on epätriviaaleja ratkaisuja täsmälleen silloin, kun kerroinmatriisi \(A-\lambda I\)ei ole kääntyvä. Toisaalta lauseen~\ref{detKaantyvaLause} mukaan neliömatriisi ei ole kääntyvä täsmälleen silloin, kun sen determinantti on 0. Näin saadaan seuraava lause.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{lause:ominaisarvot} -->
                                                                                                                                                                                                        Reaaliluku \(\lambda\)on neliömatriisin \(A\)ominaisarvo, jos ja vain jos
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \det(A-\lambda I)=0.
                                                                                                                                                                                                        \]


                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"><!-- \label{esim:ominaisarvonLaskeminen} -->
                                                                                                                                                                                                        Määritetään matriisin
                                                                                                                                                                                                        \(\displaystyle{A=\begin{bmatrix}
                                                                                                                                                                                                        1 & 2 \\
                                                                                                                                                                                                        3 & 2
                                                                                                                                                                                                        \end{bmatrix}}\)
                                                                                                                                                                                                        ominaisarvot ja niitä vastaavat ominaisvektorit.
                                                                                                                                                                                                        Lähdetään liikkeelle laskemalla lauseessa~\ref{lause:ominaisarvot} mainittu determinantti:
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \det(A-\lambda I)&=
                                                                                                                                                                                                        \begin{vmatrix}
                                                                                                                                                                                                        1-\lambda & 2 \\
                                                                                                                                                                                                        3 & 2-\lambda
                                                                                                                                                                                                        \end{vmatrix}
                                                                                                                                                                                                        =(1-\lambda)(2-\lambda)-6\\
                                                                                                                                                                                                        &=2-\lambda-2\lambda+\lambda^2-6=\lambda^2-3\lambda-4,
                                                                                                                                                                                                        \end{align*}

                                                                                                                                                                                                        Matriisin \(A\)ominaisarvot ovat nyt yhtälön \(\lambda^2-3\lambda-4=0\)ratkaisut.
                                                                                                                                                                                                        Toisen asteen ratkaisukaavan avulla saadaan yhtälön ratkaisuiksi
                                                                                                                                                                                                        \(\lambda=4\)ja \(\lambda-1\). Siten matriisin ominaisarvot ovat \(\lambda_1=4\)ja \(\lambda_2=-1\).

                                                                                                                                                                                                        Määritetään vielä ominaisvektorit. Kumpaakin ominaisarvoa vastaavat omat ominaisvektorinsa. Tarkastellaan ensin ominaisarvoa \(\lambda_1=4\). Tällöin ratkaistavana on yhtälö \((A-4I)\vv=\nv\). Ratkaistavaksi saadaan siis yhtälöryhmä, jota vastaa matriisi 
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{bmatrix}[cc|c]
                                                                                                                                                                                                        -3 & 2&0 \\
                                                                                                                                                                                                        3 & -2&0
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Kun yhtälöryhmä ratkaistaan Gaussin-Jordanin eliminointimenetelmällä, ratkaisun nähdään olevan
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \left\{
                                                                                                                                                                                                        \begin{aligned}
                                                                                                                                                                                                        x_1&=(2/3)t \\
                                                                                                                                                                                                        x_2&=t,
                                                                                                                                                                                                        \end{aligned}
                                                                                                                                                                                                        \right.  \text{missä \(t \in \R\).}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Ominaisarvoa 4 vastaavat ominaisvektorit ovat siis muotoa
                                                                                                                                                                                                        \)((2/3)t,t)\), missä \(t\in\R\setminus\{0\}\).

                                                                                                                                                                                                        Tarkastellaan sitten ominaisarvoa \(\lambda_2=-1\). Nyt ratkaistavana oleva yhtälö on \((A+I)\vv=\nv\). Sen ratkaisuksi saadaan
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \left\{
                                                                                                                                                                                                        \begin{aligned}
                                                                                                                                                                                                        x_1&=-t \\
                                                                                                                                                                                                        x_2&=t,
                                                                                                                                                                                                        \end{aligned}
                                                                                                                                                                                                        \right.  \text{missä \(t \in \R\).}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Ominaisarvoa \(-1\)vastaavat  ominaisvektorit ovat siis muotoa \((-t,t)\), missä \(t\in\R\setminus\{0\}\).
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Lauseke \(\det(A-\lambda I)\)on eräs muuttujan \(\lambda\)polynomi. Sitä nimitetään matriisin \(A\)<strong>karakteristiseksi polynomiksi</strong><!-- \index{karakteristinen polynomi} -->. Edellinen lause voidaan siis muotoilla myös niin, että matriisin \(A\)ominaisarvot ovat sen karakteristisen polynomin nollakohdat.

                                                                                                                                                                                                        <strong>Huom.</strong>
                                                                                                                                                                                                        Jos matriisille \(A\)löytyy yksikin ominaisvektori, sillä on välttämättä äärettömän monta ominaisvektoria.
                                                                                                                                                                                                        <!-- %Toisin sanoen, jos \(\lambda\)on matriisin \(A\)ominaisarvo, yhtälöllä~\ref{yhtalo:ominaisarvo2} on äärettömän monta ratkaisua. -->
                                                                                                                                                                                                        Jokainen ominaisvektorin \(\vv\)skalaarimonikerta on nimittäin myös ominaisvektori, sillä \(A(c\vv)=c(A\vv)=c(\lambda\vv)=\lambda(c\vv)\)kaikilla \(c\in\R\).

                                                                                                                                                                                                        Ominaisarvoja voi sen sijaan olla vain äärellisen monta.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3>
                                                                                                                                                                                                        Jos \(A\)on \(n \times n\)-matriisi, sillä on korkeintaan \(n\)ominaisarvoa.


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Koska \(A\)on \(n \times n\)-matriisi, sen karakteristinen polynomi on korkeintaan astetta \(n\). Karakteristinen polynomi on siis muotoa \(c_0 + c_1\lambda + \dots + c_n\lambda^n\), missä \(c_0, \dots, c_n \in \R\). Voidaan osoittaa, että yhtälöllä 
                                                                                                                                                                                                        \[c_0 + c_1\lambda + \dots + c_n\lambda^n = 0\]
                                                                                                                                                                                                        on enintään \(n\)eri ratkaisua. (Tämä tehdään esimerkiksi kurssilla Algebra I.) Näin ollen matriisilla \(A\)on enintään \(n\)eri ominaisarvoa.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <h2>Diagonalisointi}

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Neliömatriisia \(A\in\R^{n\times n}\)kutsutaan <strong>diagonalisoituvaksi</strong><!-- \index{diagonalisoituva matriisi --><!-- \index{diagonalisointi} -->, jos on olemassa kääntyvä matriisi \(P\in\R^{n\times n}\)ja lävistäjämatriisi \(D\in\R^{n\times n}\), joille pätee
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        P^{-1}AP=D.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        }

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"><!-- \label{esim:diagonalisoituva} -->
                                                                                                                                                                                                        Osoitetaan, että matriisi
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                                                        3 & 1 \\
                                                                                                                                                                                                        1 & 3
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        on diagonalisoituva.Valitaan
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        P=\begin{bmatrix}
                                                                                                                                                                                                        1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Matriisin \(P\)käänteismatriisi saadaan esimerkiksi lauseen~\ref{2x2KaantyvaLause} avulla, ja se on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        P^{-1}=\frac{1}{2}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Nyt nähdään, että
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        P^{-1}AP & =
                                                                                                                                                                                                        \frac{1}{2}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        3 & 1 \\
                                                                                                                                                                                                        1 & 3
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        =\frac{1}{2}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        4 & 4 \\
                                                                                                                                                                                                        2 & -2
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix} \\[0.5ex]
                                                                                                                                                                                                        & =\frac{1}{2}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        8 & 0 \\
                                                                                                                                                                                                        0 & 4
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        =\begin{bmatrix}
                                                                                                                                                                                                        4 & 0 \\
                                                                                                                                                                                                        0 & 2
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        Määritelmässä vaadittu lävistäjämatrisii on siis
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        D=\begin{bmatrix}
                                                                                                                                                                                                        4 & 0 \\
                                                                                                                                                                                                        0 & 2
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Edellisessä esimrkissä matriisi \(P\)vain tupsahti jostakin. Huomataan kuitenkin, että matriisin \(D\)lävistäjäalkiot ovat \(A\):n ominaisarvoja ja matriisin \(P\)sarakkeet niitä vastaavia ominaisvektoreita. Seuraava lause osoittaa, että näin on aina, jos matriisi on diagonalisoituva.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3><!-- \label{lause:diagonalisoituvuus} -->
                                                                                                                                                                                                        Neliömatriisi \(A\in\R^{n\times n}\)on diagonalisoituva, jos ja vain jos sillä on \(n\)lineaarisesti riippumatonta ominaisvektoria. Tällöin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        P^{-1}AP=
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        \lambda_1 & 0 & \cdots & 0 \\
                                                                                                                                                                                                        0 & \lambda_2 & & 0 \\
                                                                                                                                                                                                        \vdots & & \ddots & \vdots \\
                                                                                                                                                                                                        0 & \cdots & 0 & \lambda_n
                                                                                                                                                                                                        \end{bmatrix},
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        missä matriisin \(P\in\R^{n\times n}\)sarakkeet koostuvat \(A\):n lineaarisesti riippumattomista ominaisvektoreista ja \(\lambda_1,\dots\lambda_n\)ovat niitä vastaavat ominaisarvot samassa järjestyksessä.


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        ''\(\Rightarrow\)'':
                                                                                                                                                                                                        Oletetaan, että \(P^{-1}AP=D\), missä \(P \in \R^{n\times n}\)on jokin kääntyvä matriisi ja \(D \in \R^{n\times n}\)lävistäjämatriisi. Nyt \(AP=PD\). Olkoot \(P\):n sarakkeet \(\bar{p}_1, \dots, \bar{p}_n\)ja \(D\):n lävistäjäalkiot \(\lambda_1, \dots, \lambda_n\). Nyt siis
                                                                                                                                                                                                        \[P = \begin{bmatrix} \vp_1 & \dots & \vp_n \end{bmatrix}  \text{ ja }  
                                                                                                                                                                                                        D = \begin{bmatrix}
                                                                                                                                                                                                        \lambda_{1}&0&\cdots&0&0 \\
                                                                                                                                                                                                        0&\lambda_{2}&\cdots&0&0 \\
                                                                                                                                                                                                        \vdots&\vdots&\ddots&\vdots&\vdots \\
                                                                                                                                                                                                        0&0&\cdots&\lambda_{n-1}&0 \\
                                                                                                                                                                                                        0&0&\cdots&0&\lambda_n 
                                                                                                                                                                                                        \end{bmatrix}.\]

                                                                                                                                                                                                        Matriisituloa laskettaessa tulon \(AP\)jokainen sarake saadaan kertomalla matriisilla \(A\)vastaava sarake matriisista \(P\):
                                                                                                                                                                                                        \[AP=A[\bar{p}_1 \cdots \bar{p}_n]=[A\bar{p}_1 \cdots A\bar{p}_n].\]
                                                                                                                                                                                                        Toisaalta lävistäjämatriisilla \(D\)kerrottaessa tullaan kertoneeksi jokainen sarake vastaavalla lävistäjäalkiolla:
                                                                                                                                                                                                        \[PD=[\lambda_1\bar{p}_1 \cdots \lambda_n\bar{p}_n].\]
                                                                                                                                                                                                        Koska \(AP=PD\), nähdään nyt, että \(A\bar{p}_i=\lambda_i\bar{p}_i\)kaikilla \(i \in \{1, \dots, n\}\).
                                                                                                                                                                                                        Siis jokainen \(\lambda_i\)on ominaisarvo ja \(\bar{p}_i\)sitä vastaava ominaisvektori.

                                                                                                                                                                                                        On vielä osoitettava, että ominaisvektorien jono \((\vp_1, \dots, \vp_n)\)on vapaa.
                                                                                                                                                                                                        Koska \(P\)on kääntyvä, yhtälöllä \(P\bar{x}=\bar{0}\)on lauseen alla <!-- \ref{k-->aantMatrYhtaloLause} mukaan täsmälleen yksi ratkaisu \(\bar{x}=\bar{0}\). Yhtälö \(P\bar{x}=\bar{0}\)voidaan kirjoittaa myös muotoon
                                                                                                                                                                                                        \[x_1\vp_1 + x_2\vp_2 +\dots + x_n\vp_n = \nv.\]
                                                                                                                                                                                                        Tämän yhtälön ainoa ratkaisu on siis \(x_1 = 0, \dots, x_n = 0\). Näin ollen matriisin \(A\)ominaisvektoreiden jono \((\vp_1, \dots, \vp_n)\)on vapaa.

                                                                                                                                                                                                        ''\(\Leftarrow\)'':
                                                                                                                                                                                                        Oletetaan, että \(\bar{p}_1, \dots, \bar{p}_n\)ovat jotkin \(A\):n lineaarisesti riippumattomat ominaisvektorit. Olkoot niitä vastaavat ominaisarvot \(\lambda_1, \dots, \lambda_n\). Nyt \(A\bar{p}_i=\lambda_i\bar{p}_i\)kaikilla \(i \in \{1, \dots, n\}\). Olkoon \(P\)matriisi, jonka sarakkeet ovat ominaisvektorit: \(P=[\bar{p}_1 \cdots \bar{p}_n]\). Olkoon \(D\)puolestaan lävistäjämatriisi, jonka lävistäjäalkiot ovat \(\lambda_1, \dots, \lambda_n\). Tällöin nähdään samaan tapaan kuin edellä, että \(AP=PD\).

                                                                                                                                                                                                        Koska matriisin \(P\)sarakkeet ovat lineaarisesti riippumattomat, on yhtälöllä \(P\bar{x}=\bar{0}\)täsmälleen yksi ratkaisu \(\bar{x}=\bar{0}\). (Tämä nähdään samalla tavalla kuin todistuksen ensimmäisessä osassa.) Lauseen alla <!-- \ref{k-->aanteismatriisiLause} nojalla matriisi \(P\)on nyt kääntyvä. Yhtälö \(AP = PD\)saadaan siis muotoon 
                                                                                                                                                                                                        \[P^{-1}AP = D. \qedhere\]

                                                                                                                                                                                                        \begin{comment}
                                                                                                                                                                                                        Merkitään matriisin \(A\)lineaarisesti riippumattomia ominaisvektoreita \(\vv_1,\dots,\vv_n\). Nämä siis muodostavat matriisin \(P\)sarakkeet. Siitä, että kyseiset sarakkeet ovat lineaarisesti riippumattomat, voidaan johtaa, että homogeenisella yhtälöryhmällä \(P\vx=\nv\)on vain triviaaliratkaisu. Tästä puolestaan seuraa, että \(P\)on kääntyvä.

                                                                                                                                                                                                        Matriisikertolaskun määritelmästä seuraa, että matriisin \(AP\)\(i\):s sarake on \(A\vv_i\)ja että matriisin \(PD\)vastaava sarake on \(\lambda_i\vv_i\). Koska \(A\vv_i=\lambda_i\vv_i\), saadaan yhtälö \(AP=PD\). Väite seuraa, kun kerrotaan tämä yhtälö vasemmalta matriisilla \(P^{-1}\).
                                                                                                                                                                                                        \end{comment}
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Tutkitaan, onko esimerkin \ref{esim:ominaisarvonLaskeminen} matriisi
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                                                        1 & 2 \\
                                                                                                                                                                                                        3 & 2
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        diagonalisoituva. Esimerkissä \ref{esim:ominaisarvonLaskeminen} todettiin, että matriisin ominaisarvot ovat \(4\)ja \(-1\). Eräät näitä ominaisarvoja vastaavat ominaisvektorit ovat \((2,3)\)ja \((-1,1)\). Nämä ominaisvektorit ovat lineaarisesti riippumattomat, sillä ne eivät ole yhdensuuntaiset. Lauseen~\ref{lause:diagonalisoituvuus} perusteella \(A\)on diagonalisoituva. Muodostetaan ominaisvektoreista matriisi
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        P=\begin{bmatrix}
                                                                                                                                                                                                        2 & -1 \\
                                                                                                                                                                                                        3 & 1
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        ja ominaisarvoista matriisi
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        D=\begin{bmatrix}
                                                                                                                                                                                                        4 & 0 \\
                                                                                                                                                                                                        0 & -1
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Nyt lauseen~\ref{lause:diagonalisoituvuus} nojalla  pätee \(P^{-1}AP=D\). Tämän voi vielä tarkistaa laskemalla.

                                                                                                                                                                                                        <!-- %Jos on epävarma ratkaisustaan, voi vielä lopukasi tarkistaa, että \(\det(P)\neq 0\)ja \(AP = PD\). -->
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Diagonalisoidaan matriisi
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        A=\begin{bmatrix}
                                                                                                                                                                                                        2&1\\
                                                                                                                                                                                                        0&2
                                                                                                                                                                                                        \end{bmatrix},
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        jos mahdollista. Selvitetään aluksi matriisin ominaisarvot. Matriisin karakteristinen polynomi on \((\lambda-2)^2\), ja tämän polynomin ainoa nollakohta on \(2\). Siten ominaisarvoja on yksi, ja se on \(2\). Ominaisarvoa vastaavat ominaisvektorit saadaan yhtälöstä \(A\vx=2\vx\). Kun yhtälö ratkaistaan, nähdään sen ratkaisujen olevan muotoa
                                                                                                                                                                                                        \(\vx=(t,0)\), missä \(t \in \R \setminus \{0\}\).
                                                                                                                                                                                                        Matriisilla \(A\)ei siis ole kahta lineaarisesti riippumatonta ominaisarvoa, joten \(A\)ei ole diagonalisoituva.
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">[Diagonalisoituvan matriisin potenssit] Lasketaan esimerkissä \ref{esim:diagonalisoituva} esiintyneen matriisin \(A\)seitsemäs potenssi. Suora matriisikertolasku olisi työläs suorittaa, mutta koska matriisi \(A\)on diagonalisoituva, voidaan käyttää hyväksi sen ominaisarvoja.

                                                                                                                                                                                                        Esimerkissä todettiin, että \(A=PDP^{-1}\), missä
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        P=\begin{bmatrix}
                                                                                                                                                                                                        1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \text{ja} 
                                                                                                                                                                                                        D=\begin{bmatrix}
                                                                                                                                                                                                        4 & 0 \\
                                                                                                                                                                                                        0 & 2
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]

                                                                                                                                                                                                        Lävistäjämatriisin potensseja on vaivatonta laskea.
                                                                                                                                                                                                        Huomataan, että
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        D^7=
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        4^7 & 0 \\
                                                                                                                                                                                                        0 & 2^7
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        =
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        16384 & 0 \\
                                                                                                                                                                                                        0 & 128
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        (Vastaava pätee kaikille neliömatriiseille.)

                                                                                                                                                                                                        Toisaalta, jos kerrotaan yhtälöä \(D=P^{-1}AP\)vasemmalta matriisilla \(P\)ja oikealta matriisilla \(P^{-1}\), saadaan \(A = PDP^{-1}\).
                                                                                                                                                                                                        Nyt voidaan laskea
                                                                                                                                                                                                        \[\begin{split}
                                                                                                                                                                                                        A^7 &= (PDP^{-1})^7 \\[2mm]
                                                                                                                                                                                                        &= \underbrace{(PDP^{-1})(PDP^{-1})\dots (PDP^{-1})(PDP^{-1})}_{7 \text{ kpl}} \\
                                                                                                                                                                                                        &= PD(P^{-1}P)D\dots (P^{-1}P)DP^{-1} \\
                                                                                                                                                                                                        &= P\underbrace{D\dots D}_{7 \text{ kpl}}P^{-1} \\
                                                                                                                                                                                                        &= PD^7P^{-1}.
                                                                                                                                                                                                        \end{split}\] 
                                                                                                                                                                                                        Siten
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        A^7 & =(PDP^{-1})^7=PD^7 P^{-1}
                                                                                                                                                                                                        =\begin{bmatrix}
                                                                                                                                                                                                        1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \cdot
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        16384 & 0 \\
                                                                                                                                                                                                        0 & 128
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \cdot\frac{1}{2}\begin{bmatrix}
                                                                                                                                                                                                        1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix} \\
                                                                                                                                                                                                        & =\frac{1}{2}\begin{bmatrix}
                                                                                                                                                                                                        16384 & 128 \\
                                                                                                                                                                                                        16384 & -128
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \begin{bmatrix}
                                                                                                                                                                                                        1 & 1 \\
                                                                                                                                                                                                        1 & -1
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        =\frac{1}{2}\begin{bmatrix}
                                                                                                                                                                                                        16512 & 16256 \\
                                                                                                                                                                                                        16256 & 16512
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        =\begin{bmatrix}
                                                                                                                                                                                                        8256 & 8128 \\
                                                                                                                                                                                                        8128 & 8256
                                                                                                                                                                                                        \end{bmatrix}.
                                                                                                                                                                                                        \end{align*}

                                                                                                                                                                                                        Matriisipotenssin laskeminen saatiin muutettua pariksi matriisikertolaskuksi sekä tavallisten kokonaislukujen potenssiksi. Samalla vaivalla voitaisiin laskea paljon suurempiakin potensseja. Tämä temppu onnistuu kuitenkin vain, jos alkuperäinen matriisi on diagonalisoituva.
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Neliömatriisi \(A\)on <strong>similaarinen</strong><!-- \index{similaariset matriisit} --> matriisin \(B\)kanssa, jos on olemassa kääntyvä matriisi \(P\), jolle pätee \(P^{-1}AP=B\). Diagonalisoituvat matriisit ovat siis similaarisia lävistäjämatriisin kanssa. Similaarisilla matriisit muistuttavat monessa suhteessa toisiaan. Niillä on muun muassa samat ominaisarvot ja sama determinantti. 

                                                                                                                                                                                                        Palataan vielä tutkimaan matriisin ominaisvektoreita. Seuraava lause osoittaa, että
                                                                                                                                                                                                        eri ominaisarvoja vastaavat ominaisvektorit ovat lineaarisesti riippumattomia. Tästä tuloksesta on toisinaan hyötyä, kun tutkitaan, onko matriisi diagonalisoituva.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{ominaisvektorienVapausLause} -->
                                                                                                                                                                                                        Oletetaan, että \(A\)on \(n \times n\)-matriisi. Oletetaan, että \(\lambda_1, \dots, \lambda_m\)ovat matriisin \(A\)
                                                                                                                                                                                                        eri ominaisarvoja ja \(\vv_1, \dots, \vv_m \in \R^n\)jotkin niitä vastaavat ominaisvektorit. Tällöin jono \((\vv_1, \dots, \vv_m)\)on vapaa.


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Oletetaan vastoin väitettä, että jono \((\vv_1, \dots, \vv_m)\)on sidottu. Nyt lauseen \ref{sidottuLause} nojalla jokin jonon vektoreista on muiden lineaarikombinaatio. Tästä seuraa, että jokin jonon vektoreista on sitä edeltävien jonon vektoreiden lineaarikombinaatio.
                                                                                                                                                                                                        Olkoon \(\vv_{k+1}\)jonon ensimmäinen vektori, joka on sitä edeltävien vektoreiden lineaarikombinaatio. Tällöin on olemassa reaaliluvut \(c_1, \dots, c_k\), joille pätee
                                                                                                                                                                                                        \begin{equation}<!-- \label{yhtalo1} -->
                                                                                                                                                                                                        c_1\vv_1 + \dots + c_k\vv_k = \vv_{k+1}.
                                                                                                                                                                                                        \end{equation}
                                                                                                                                                                                                        Lisäksi jono \((\vv_1, \dots, \vv_k)\)on vapaa. Jos se nimittäin ei olisi vapaa, \(\vv_{k + 1}\)ei olisikaan ensimmäinen vektori, joka on sitä edeltävien vektoreiden lineaarikombinaatio.

                                                                                                                                                                                                        Kertomalla yhtälön \eqref{yhtalo1} molemmat puolet vasemmalta matriisilla \(A\)saadaan yhtälö \(\(A(c_1\vv_1 + \dots + c_k\vv_k) = A\vv_{k+1}.\(\)Matriisien laskusääntöjen avulla yhtälö saa muodon \(c_1A\vv_1 + \dots + c_kA\vv_k = A\vv_{k+1}\). Kun vielä muistetaan, että vektorit \(\vv_1, \dots, \vv_k\)ovat matriisin \(A\)ominaisvektoreita, saadaan lopulta yhtälö
                                                                                                                                                                                                        \begin{equation}<!-- \label{yhtalo2} -->
                                                                                                                                                                                                        c_1\lambda_1\vv_1 + \dots + c_k\lambda_k\vv_k = \lambda_{k+1}\vv_{k+1}.
                                                                                                                                                                                                        \end{equation}
                                                                                                                                                                                                        Toisaalta voidaan kertoa yhtälön \eqref{yhtalo1} molemmat puolet luvulla \(\lambda_{k+1}\)päätyen yhtälöön
                                                                                                                                                                                                        \begin{equation}<!-- \label{yhtalo3} -->
                                                                                                                                                                                                        c_1\lambda_{k+1}\vv_1 + \dots + c_k\lambda_{k+1}\vv_k = \lambda_{k+1}\vv_{k+1}.
                                                                                                                                                                                                        \end{equation}

                                                                                                                                                                                                        Vähennetään yhtälöstä \eqref{yhtalo2} puolittain yhtälö \eqref{yhtalo3}, jolloin saadaan 
                                                                                                                                                                                                        \[c_1(\lambda_1-\lambda_{k+1})\vv_1 + \dots + c_k(\lambda_k-\lambda_{k+1})\vv_k =\nv.\] 
                                                                                                                                                                                                        Jono \((\vv_1, \dots, \vv_k)\)on vapaa, joten kaikkien yhtälössä olevien kertoimien on oltava nollia:
                                                                                                                                                                                                        \[c_1(\lambda_1-\lambda_{k+1}) = 0, \ c_2(\lambda_2-\lambda_{k+1}) = 0, \ldots, \ c_k(\lambda_k-\lambda_{k+1}) = 0.\]
                                                                                                                                                                                                        Koska \(\lambda_1, \dots, \lambda_m\)ovat kaikki eri ominaisarvoja, niin tiedetään, että \((\lambda_i - \lambda_{k+1}) \neq 0\)kaikilla \(i \in \{1, \dots, k\}\). Tulon nollasäännön nojalla
                                                                                                                                                                                                        \[c_1 = 0, \ c_2 = 0, \ \ldots, \ c_k = 0.\]

                                                                                                                                                                                                        Näin ollen
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \vv_{k+1}= c_1\vv_1 + \dots + c_k\vv_k= 0\vv_1 + \dots + 0\vv_k = \nv.\]
                                                                                                                                                                                                        Toisaalta oletuksen mukaan \(\vv_{k+1}\)on matriisin \(A\)ominaisvektori, joten \(\vv_{k+1} \neq \nv\). 
                                                                                                                                                                                                        Koska päädyttiin ristiriitaan, vastaoletus ei voi olla tosi. Siis alkuperäinen väite pätee, eli jono \((\vv_1, \dots, \vv_m)\)on vapaa.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Edellisestä lauseesta seuraa, että toisinaan matriisin diagonalisoituvuus on helppo todeta.
                                                                                                                                                                                                        \begin{kor}
                                                                                                                                                                                                        Oletetaan, että \(n \times n\)-matriisilla on \(n\)eri ominaisarvoa. Tällöin \(A\)on diagonalisoituva.
                                                                                                                                                                                                        \end{kor}

                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Olkoot \(\vv_1, \dots, \vv_n\)jotkin eri ominaisarvoihin liittyvät ominaisvektorit. Ne ovat lineaarisesti riippumattomia lauseen \ref{ominaisvektorienVapausLause} nojalla. Koska matriisilla \(A\)on \(n\)lineaarisesti riippumatonta ominaisvektoria, on \(A\)diagonalisoituva lauseen \ref{lause:diagonalisoituvuus} nojalla.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Huomaa, että diagonalisoituvan \(n \times n\)-matriisin ominaisarvojen lukumäärän ei tarvitse olla \(n\). Esimerkiksi lävistäjämatriisi
                                                                                                                                                                                                        \[A=\begin{bmatrix}
                                                                                                                                                                                                        -3&0\\
                                                                                                                                                                                                        0&-3
                                                                                                                                                                                                        \end{bmatrix}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        on diagonalisoituva, sillä \(I^{-1}AI=A\). Kuitenkin karakteristisen polynomin avulla nähdään, että matriisilla on vain yksi ominaisarvo, \(-3\).
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </section>
                                                                                                                                                                                                        <section class="kappaleraja" id="13">
                                                                                                                                                                                                        <div div class="kappaleraja-linis" id="Pistetulo" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                                                                                                                                                                                                        <h1>Pistetulo</h1> <!-- \label{pistetuloLuku} -->

                                                                                                                                                                                                        Avaruuksissa \(\R^2\)ja \(\R^3\)on totuttu puhumaan vektorien pituuksista ja vektoreiden välisistä kulmista. Kuten tavallista, näiden käsitteiden yleistäminen korkeampiulotteisiin avaruuksiin ei välttämättä onnistu pelkästään geometrisen intuition avulla. Kuitenkin esimerkiksi Pythagoraan lauseen voidaan ajatella toimivan kaikissa ulottuvuuksissa samalla tavalla. Kyseinen lause, samoin kuin muutkin vektoreiden pituuksiin ja kulmiin liittyvät käsitteet, voidaan ilmaista pistetulon avulla, ja pistetulo puolestaan voidaan laskea avaruudessa \(\R^n\), oli \(n\)miten suuri tahansa.

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Vektoreiden \(\vv=(v_1,\dots,v_n) \in \R^n\)ja \(\vw=(w_1,\dots,w_n) \in \R^n\)<strong>pistetulo</strong><!-- \index{pistetulo} --> on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \vv \cdot \vw = v_1w_1+v_2w_2+ \dots +v_nw_n.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        }

                                                                                                                                                                                                        Vektorien pistetulo on aina reaaliluku. Jos esimerkiksi \(\vv=(3,-2,0)\)ja \(\vw=(1,-2,\sqrt{3})\), vektorien \(\vv\)ja \(\vw\)pistetulo on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \vv \cdot \vw = 3 \cdot 1+(-2)(-2)+ 0 \cdot \sqrt{3}=7.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Pistetulolle voidaan johtaa laskusääntöjä.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3>
                                                                                                                                                                                                        Oletetaan, että \(\vv, \vw, \vu \in \R^n\)ja \(c \in \R\). Tällöin
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li> \(\vv \cdot \vw=\vw \cdot \vv\)
                                                                                                                                                                                                        <li> \(\vv \cdot (\vw+\vu)=\vv \cdot \vw+\vv \cdot \vu\)
                                                                                                                                                                                                        <li> \((c\vv) \cdot \vw=c(\vv \cdot \vw)\).
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Todistetaan vain kohta b) ja jätetään loput kohdat harjoitustehtäviksi. Merkitään \(\bar{v} = (v_1, \dots, v_n)\), \(\bar{w} = (w_1, \dots, w_n)\)ja \(\bar{u} = (u_1, \dots, u_n)\). Nyt nähdään, että
                                                                                                                                                                                                        \[\begin{split}
                                                                                                                                                                                                        \vv \cdot (\vw + \vu) &= (v_1, \dots, v_n) \cdot (w_1 + u_1, w_2 + u_2, \dots, w_n+u_n) \\
                                                                                                                                                                                                        &= v_1(w_1 + u_1)+v_2(w_2 + u_2)+ \cdots + v_n(w_n+u_n) \\
                                                                                                                                                                                                        &= v_1w_1 + v_1u_1 + v_2w_2 + v_2u_2+ \cdots + v_nw_n+v_nu_n \\
                                                                                                                                                                                                        &= (v_1w_1 + v_2w_2 + \cdots + v_nw_n) + (v_1u_1 + v_2u_2 + \cdots + v_nu_n) \\
                                                                                                                                                                                                        &= \vv \cdot \vw + \vv \cdot \vu.
                                                                                                                                                                                                        \end{split}\]
                                                                                                                                                                                                        Tässä käytettiin reaalilukujen yhteenlaskun ja kertolaskun osittelulakia.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <strong>Huom.</strong> Kohdan b) osittelulaki pätee myös toisin päin: \((\vv+\vw)\cdot\vu=\vv\cdot\vu+\vw\cdot\vu\). Tämä seuraa kohdasta a), jonka mukaan pistetulo on vaihdannainen:
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        (\vv+\vw)\cdot\vu\overset{a)}{=}\vu\cdot(\vv+\vw)
                                                                                                                                                                                                        \overset{b)}{=}\vu\cdot\vv+\vu\cdot\vw\overset{a)}{=}\vv\cdot\vu+\vw\cdot\vu.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Samaan tapaan myös c)-kohta voidaan kääntää muotoon \(\vv\cdot(c\vw)=c(\vv \cdot \vw)\).



                                                                                                                                                                                                        Seuraava lause osoittaa, että vektorin pistetulo itsensä kanssa on aina epänegatiivinen. Ainoastaan nollavektorin pistetulo itsensä kanssa on nolla.
                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{pistetuloNollaLause} -->
                                                                                                                                                                                                        Oletetaan, että \(\vv \in \R^n\). Tällöin
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li>
                                                                                                                                                                                                        \(\vv \cdot \vv \ge 0\)
                                                                                                                                                                                                        <li>
                                                                                                                                                                                                        \(\vv \cdot \vv = 0\), jos ja vain jos \(\vv=\nv\).
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                                                        \pagebreak[0]
                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        \begin{enumerate}
                                                                                                                                                                                                        <li>[]
                                                                                                                                                                                                        <li>[a)] Nähdään, että
                                                                                                                                                                                                        \[\vv \cdot \vv  = v_1^2 + v_2^2 + \cdots + v_n^2 \geq 0 + 0 + \cdots + 0 = 0\,,\]
                                                                                                                                                                                                        sillä reaaliluvun neliö on aina epänegatiivinen. Tämä todistaa väitteen.
                                                                                                                                                                                                        <li>[b)]
                                                                                                                                                                                                        ''\(\Rightarrow\)'': Oletetaan, että \(\vv \cdot \vv = 0\). Tällöin \(v_1^2 + v_2^2 + \cdots + v_n^2 = 0\). Koska jokainen yhteenlaskettava on epänegatiivinen, täytyy yhteenlaskettavien olla nollia. Toisin sanoen \(v_i^2 = 0\)kaikilla \(i \in \{1, \dots, n\}\). Tästä seuraa, että \(v_i = 0\)kaikilla \(i \in \{1, \dots, n\}\). Siten \(\vv = (0,0, \dots, 0) =\nv\).

                                                                                                                                                                                                        ''\(\Leftarrow\)'': Oletetaan, että \(\vv = \nv\). Nyt \(\vv \cdot \vv = 0^2 + 0^2 + \cdots + 0^2 = 0\). Väite on todistettu. \qedhere
                                                                                                                                                                                                        \end{enumerate}
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <h2>Vektorin normi}

                                                                                                                                                                                                        Pistetulon avulla voidaan määritellä avaruuden \(\R^n\)vektorin normi eli pituus. Lauseen \ref{pistetuloNollaLause} nojalla pätee \(\vv \cdot \vv \ge 0\), joten seuraavassa määritelmässä juurrettava on epänegatiivinen, kuten kuuluu olla.

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Vektorin \(\vv \in \R^n\)<strong>normi</strong><!-- \index{normi} eli <strong>pituus</strong><!-- \index{pituus, vektorin} --> on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \norm{\vv}=\sqrt{\vv \cdot \vv}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        }<!-- \label{normiMaar} -->

                                                                                                                                                                                                        Määritelmästä seuraa, että \(\norm{\vv}=\sqrt{v_1^2+v_2^2+ \dots +v_n^2}\), kun pistetulo lasketaan auki. Esimerkiksi vektorin \(\vv=(1/2,3,-2,0)\)normi on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \norm{\vv}=\sqrt{(1/2)^2+3^2+(-2)^2+0^2}=\sqrt{\frac{53}{4}}=\frac{\sqrt{53}}{2}.
                                                                                                                                                                                                        \]

                                                                                                                                                                                                        Tasossa normia voi havainnollistaa Pythagoraan lauseen avulla. Kuvaan~alla <!-- \ref{k-->11} on piirretty vektori \(\vw=(-4,-3)\). Pythagoraan lauseetta käyttäen sen pituudeksi saadaan
                                                                                                                                                                                                        \(\sqrt{3^2+4^2}=\sqrt{25}=5\).
                                                                                                                                                                                                        Pituuden geometrinen tulkinta antaa siis saman tuloksen kuin määritelmä \ref{normiMaar}.
                                                                                                                                                                                                        <!-- %Myös kolmiulotteisen avaruuden vektorin pituus on sama normin ja Pythagoraan lauseen avulla laskettuna. -->

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva11.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Vektorin \(\vw=(-4,-3)\)normi eli pituus on 5.}<!-- \label{k11} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Seuraava lause ilmaisee normien avulla sen, että vektorin pituus on aina epänegatiivinen ja nollavektori on ainoa vektori, jonka pituus on nolla.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{nollaNormiLause} -->
                                                                                                                                                                                                        Oletetaan, että \(\vv \in \R^n\). Tällöin
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li> \(\norm{\vv} \ge 0\)
                                                                                                                                                                                                        <li> \(\norm{\vv}=0\), jos ja vain jos \(\vv=0\).
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Tulokset seuraavat suoraan normin määritelmästä, neliöjuuren ominaisuuksista ja lauseesta \ref{pistetuloNollaLause}.
                                                                                                                                                                                                        \begin{enumerate}
                                                                                                                                                                                                        <li>[a)] Määritelmän mukaan \(\norm{\vv}=\sqrt{\vv \cdot \vv}\). Neliöjuuren arvo on aina epänegatiivinen, joten \(\norm{\vv} \ge 0\).

                                                                                                                                                                                                        <li>[b)] Huomataan, että \(\norm{\vv}=\sqrt{\vv\cdot\vv}=0\), jos ja vain jos juurrettava \(\vv \cdot \vv\)on nolla. Lauseen \ref{pistetuloNollaLause} nojalla taas \(\vv \cdot \vv=0\), jos ja vain jos \(\vv=\nv\). Tämä todistaa väitteen. \qedhere
                                                                                                                                                                                                        \end{enumerate}
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Kun vektoria kerrotaan skalaarilla, tavallisinta on sanoa, että vektorin suunta pysyy samana, mutta sen pituutta ''skaalataan''. Tähän asti kyse on ollut vain intuitiivisesta kuvailusta, mutta normin käsitteen avulla asia voidaan ilmaista tarkasti. On vain otettava huomioon, että pituus on aina epänegatiivinen, vaikka skalaarikerroin olisikin negatiivinen.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3><!-- \label{skalaariNormiLause} -->
                                                                                                                                                                                                        Oletetaan, että \(\vv \in \R^n\)ja \(c\in \R\). Tällöin \(\norm{c\vv}=|c|\norm{\vv}\).


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Pistetulon ominaisuuksien perusteella
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \norm{c\vv}=\sqrt{(c\vv)\cdot(c\vv)}=\sqrt{c(\vv\cdot(c\vv))}=\sqrt{c^2(\vv \cdot \vv)}
                                                                                                                                                                                                        =|c|\sqrt{\vv \cdot \vv}=|c|\norm{\vv}. \qedhere
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Jos vain vektorin suunnalla on merkitystä, pyritään usein yksinkertaisuuden vuoksi rajoittumaan vektoreihin, joiden pituus on yksi. Tällaisilla vektoreilla on oma nimityksensä.

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Vektori \(\vu \in \R^n\)on <strong>yksikkövektori</strong><!-- \index{yksikkövektori} -->, jos sen normi on yksi eli
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \norm{\vu}=1.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        }

                                                                                                                                                                                                        <strong>Huom.</strong> Vektoreita \(\vi=(1,0)\)ja \(\vj=(0,1)\)kutsutaan toisinaan tason yksikkövektoreiksi. Koska niiden pituus on 1, ne ovat kuin ovatkin yksikkövektoreita myös yllä olevan määritelmän mukaan, samoin kuin kaikki luonnollisen kannan vektorit \(\ve_i\in\R^n\). On kuitenkin olemassa muitakin yksikkövektoreita, kuten seuraava esimerkki osoittaa.

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> <!-- \label{yksikkovektoriEsim} -->
                                                                                                                                                                                                        Etsitään jokin yksikkövektori, joka on yhdensuuntainen annetun vektorin \(\vv=(2,-1,0)\)kanssa. Vektorin \(\vv\)normi on \(\norm{\vv}=\sqrt{4+1}=\sqrt{5}\). Jos vektori \(\vv\)kerrotaan skalaarilla \(1/\sqrt{5}\), saadaan vektori \((1/\sqrt{5})\vv\), jonka pituus on lauseen~\ref{skalaariNormiLause} nojalla
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \frac{1}{\sqrt{5}}\,\norm{\vv}=\frac{1}{\sqrt{5}} \cdot \sqrt{5}=1.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Vektori \((1/\sqrt{5})\vv\)on siis yksikkövektori. Lisäksi vektorit \(\vv\)ja \((1/\sqrt{5})\vv\)ovat yhdensuuntaiset, koska ne eroavat vain skalaarikertoimen verran. Eräs tavoiteltu vektori on siis \((1/\sqrt{5})\vv\).
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Edellistä esimerkkiä mukaillen saadaan seuraava yleinen tulos.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3>
                                                                                                                                                                                                        Oletetaan, että \(\vv \in \R^n \setminus \{\nv\}\). Tällöin vektori
                                                                                                                                                                                                        \(\dfrac{1}{\norm{\vv}}\vv\)on yksikkövektori, joka on yhdensuuntainen vektorin \(\vv\)kanssa.


                                                                                                                                                                                                        <!-- % <div class="todistus drop"><h4 class="otsikko">Todistus</h4> -->
                                                                                                                                                                                                        <!-- % Väite seuraa lauseesta \ref{skalaariNormiLause} samalla tavalla kuin esimerkissä \ref{yksikkovektoriEsim}. -->
                                                                                                                                                                                                        <!-- % </div> -->

                                                                                                                                                                                                        <!-- %<div class="lause"><h3>Lause</h3>[Kolmioepäyhtälö] -->
                                                                                                                                                                                                        <!-- %Oletetaan, että \(\vv, \vw, \vu \in \R^n\). Tällöin -->
                                                                                                                                                                                                        <!-- %\[\norm{\vv+\vw} \le \norm{\vv}+\norm{\vw}.\] -->
                                                                                                                                                                                                        <!-- % -->

                                                                                                                                                                                                        Kun vektorit \(\vv\)ja \(\vw\)tulkitaan tason pisteiksi, niiden välinen etäisyys voidaan määritellä niitä yhdistävän suuntajanan \(\vv-\vw\)pituutena. Tämä taas palautuu vektorin normiin.

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Oletetaan, että \(\vv\), \(\vw \in \R^n\). Vektorien \(\vv\)ja \(\vw\)välinen <strong>etäisyys</strong><!-- \index{etäisyys, vektorien välinen} --> on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        d(\vv, \vw)=\norm{\vv-\vw}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        }

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> <!-- \label{etaisyysEsim} -->
                                                                                                                                                                                                        Vektoreiden \(\vv = (2,2)\)ja \(\vw = (-3,-1)\)välinen etäisyys on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        d(\vv, \vw)=\norm{\vv-\vw} = \norm{(2-(-3), 2-(-1))} =\norm{(5,3)} = \sqrt{5^2 + 3^2} = \sqrt{34}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Etäisyyttä on havainnollistettu kahdella eri tavalla kuvassa alla <!-- \ref{k-->20-21}.

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva20.png" /> 
                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva21.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Vektoreiden \(\vv\)ja \(\vw\)välinen etäisyys. Ensimmäisessä kuvassa vektorit on havainnollistettu tason pisteinä, jälkimmäisessä kuvassa paikkavektoreina.}<!-- \label{k20-21} -->
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        <h2>Vektorien kohtisuoruus ja projektio</h2>

                                                                                                                                                                                                        Pituuden lisäksi pistetulon avulla voidaan määritellä vektorien välinen kulma. Tarkastellaan aluksi yksinkertaisinta eli suoraa kulmaa.

                                                                                                                                                                                                        <!-- % Vektorien pituuksien kohdalla erityisasemaan nostettiin yksikkövektorit. Kulmista puolestaan suora kulma on kaikkein tärkeimmässä asemassa. Jälleen kerran esitetään määritelmä yleisessä muodossaan ottamatta kantaa siihen, miltä suora kulma voisi moniulotteisessa avaruudessa ''näyttää''. -->

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Vektorit \(\vv \in \R^n\)ja \(\vw \in \R^n\)ovat <strong>kohtisuorassa toisiaan vastaan</strong><!-- \index{kohtisuoruus} --> eli <strong>ortogonaaliset </strong><!-- \index{ortogonaalisuus} -->, jos \(\vv \cdot \vw =0\). Tällöin merkitään \(\vv
                                                                                                                                                                                                        \perp \vw\).
                                                                                                                                                                                                        }

                                                                                                                                                                                                        Esimerkiksi tason vektorit \((2,1)\)ja \((-2,4)\)ovat kohtisuorassa toisiaan vastaan, sillä
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        (2,1)\cdot(-2,4)=2\cdot(-2)+1\cdot 4=0.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Voidaan siis merkitä \((2,1)\perp(-2,4)\).

                                                                                                                                                                                                        Kohtisuoruuden käsite tarjoaa mahdollisuuden määritellä vektorin <strong>projektio}. Tätä voidaan ajatella vektorin heittämänä varjona kuvan~alla <!-- \ref{k-->130} mukaan. Projektio on hyödyllinen työkalu esimerkiksi tietokonegrafiikassa ja geometriassa (ks.~esim.~\ref{pisteenEtaisyysSuorastaEsim}), mutta sillä on myös teoreettiset sovelluksensa. Projektiota tarkastellaan lähemmin kurssin toisessa osassa. Tässä rajoitumme vektorin projektioon jonkin toisen vektorin virittämälle aliavaruudelle (eli suoralle).

                                                                                                                                                                                                        Palataan vielä varjovertaukseen.
                                                                                                                                                                                                        Voidaan ajatella, että vektorin \(\vv\)projektio vektorin \(\vw\)suuntaiselle suoralle on \(\vv\):n heittämä varjo, kun aurinko paistaa kohtisuoraan suoraa vastaan kuten kuvassa~alla <!-- \ref{k-->130}. Matemaattisesti tämä voidaan ilmaista sanomalla, että projektio \(\vp\)on yhdensuuntainen vektorin \(\vw\)kanssa ja vektorit \(\vw\)sekä \(-\vp+\vv\)ovat kohtisuorassa toisiaan vastaan.

                                                                                                                                                                                                        <!-- % Pistetulon avulla voidaan laskea vektorin \(\vv\)projektio vektorin \(\vw\)virittämälle aliavaruudelle \(\vir(\vw)\)(eli vektorin \(\vw\)suuntaiselle suoralle). Voidaan ajatella, että projektio on vektorin \(\vv\)heittämä varjo, kun aurinko paistaa kohtisuoraan vektoria \(\vw\)vastaan kuten kuvassa~alla <!-- \ref{k-->64}. -->

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva130.png" /> \
                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva64.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Projektiota voi ajatella vektorin heittämänä varjona.}<!-- \label{k130} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <!-- % Projektion määritelmäksi valitsemme yksinkertaisuuden vuoksi kaavan, jolla projektion voi suoraan laskea. -->

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Oletetaan, että \(n\in\{1,2,\dots\}\). Olkoot \(\vv,\vw \in \R^n\)ja \(\vw \neq \nv\). Tällöin vektorin \(\vv\)<strong>projektio</strong><!-- \index{projektio} --> vektorin \(\vw\)virittämälle aliavaruudelle on sellainen vektori \(\vp\in\R^n\), että
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li> vektori \(\vp\)on yhdensuuntainen vektorin \(\vw\)kanssa
                                                                                                                                                                                                        <li> vektori \(\vv-\vp\)on kohtisuorassa vektoria \(\vw\)vastaan.
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->
                                                                                                                                                                                                        Projektiota merkitään \(\vp=\proj_{\vw}(\vv)\).
                                                                                                                                                                                                        }

                                                                                                                                                                                                        <!-- % <div class="maar"><h3>Määritelmä</h3> -->
                                                                                                                                                                                                        <!-- % Oletetaan, että \(n \in \{1,2,\dots\}\). Olkoot \(\vv,\vw \in \R^n\)ja \(\vw \neq \nv\). Tällöin vektorin \(\vv\) -->
                                                                                                                                                                                                        <!-- % <strong>projektio} vektorin \(\vw\)virittämälle aliavaruudelle on -->
                                                                                                                                                                                                        <!-- % \[ -->
                                                                                                                                                                                                        <!-- % \proj_{\vw}(\vv)=\frac{\vv \cdot \vw}{\vw \cdot \vw}\vw. -->
                                                                                                                                                                                                        <!-- % \] -->
                                                                                                                                                                                                        <!-- % </div> -->

                                                                                                                                                                                                        Määritelmän ensimmäinen kohta tarkoittaa, että \(\vp\)on suoralla, jonka suuntavektori on \(\vw\). Jälkimmäinen kohta puolestaan takaa, että projisointi on tapahtunut kohtisuoraan. Projektion laskeminen määritelmästä lähtien on hankalaa, joten johdetaan sille heti käytännöllinen laskukaava.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3>
                                                                                                                                                                                                        Oletetaan, että \(n \in \{1,2,\dots\}\). Olkoot \(\vv,\vw \in \R^n\)ja \(\vw \neq \nv\). Tällöin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \proj_{\vw}(\vv)=\frac{\vv \cdot \vw}{\vw \cdot \vw}\vw.
                                                                                                                                                                                                        \]


                                                                                                                                                                                                        <strong>Huom.</strong> Kerroin \((\vv \cdot \vw)/(\vw \cdot \vw)\)on reaaliluku, sillä vektoreiden pistetulot ovat reaalilukuja. Kaavan antama projektio on siis vektorin \(\vw\)skalaarimonikerta aivan kuten kuuluukin. 

                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Merkitään \(\vp=\proj_{\vw}(\vv)\). Projektion määritelmän ensimmäisen kohdan perusteella \(\vp=t\vw\)jollakin \(t\neq 0\). Määritelmän toisesta kohdasta voidaan tällöin päätellä
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        (\vv-\vp)\cdot\vw=\vv\cdot\vw-\vp\cdot\vw=\vv\cdot\vw-t\vw\cdot\vw=0.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Viimeisestä yhtälöstä saadaan termejä siirtelemällä \(t=(\vv\cdot\vw)/(\vw\cdot\vw)\). Nyt siis
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \vp=t\vw=\frac{\vv\cdot\vw}{\vw\cdot\vw}\vw.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Väite on todistettu.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <strong>Huom.</strong> Edellisen lauseen todistus osoittaa samalla myös, että annetun vektorin projektio toisen vektorin virittämällä aliavaruudelle on yksikäsitteinen.



                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Esimerkiksi vektorin \(\vv=(1,2)\)projektio vektorin \(\vw=(-1,3)\)virittämälle aliavaruudelle on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \proj_{\vw}(v)=\frac{\vv\cdot\vw}{\vw\cdot\vw}\vw=\frac{5}{10}(-1,3)=\frac{1}{2}(-1,3)=\left(-\frac{1}{2},\frac{3}{2}\right).
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Vektorin \(\vu=(-2,-2)\)projektio vektorin \(\vw\)virittämälle aliavaruudelle on puolestaan
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \proj_{\vw}(v) =\frac{-4}{10}(-1,3)=-\frac{2}{5}(-1,3)=\left(\frac{2}{5},-\frac{6}{5}\right).
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Projektiot on esitetty kuvassa alla <!-- \ref{k-->63}.

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva63.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Vektoreiden \(\vv\)ja \(\vu\)projektiot vektorin \(\vw\)virittämälle aliavaruudelle.}<!-- \label{k63} -->
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        <!-- % <div class="lause"><h3>Lause</h3> Olkoot \(\vv,\vw\in\R^n\). Oletetaan, että \(\vu\in\R^n\)on vektorin \(\vv\)projektio aliavaruudelle \(\vir(\vw)\). Tällöin
                                                                                                                                                                                                        <!-- % <ol><!-- \begin{aakkosta*} --> -->
                                                                                                                                                                                                        <!-- % <li> vektori \(\vu\)on yhdensuuntainen vektorin \(\vw\)kanssa -->
                                                                                                                                                                                                        <!-- % <li> vektori \(\vv-\vu\)on kohtisuorassa vektoria \(\vw\)vastaan. -->
                                                                                                                                                                                                        <!-- % </ol><!-- \end{aakkosta*} --> -->
                                                                                                                                                                                                        <!-- %  -->
                                                                                                                                                                                                        <!-- % -->
                                                                                                                                                                                                        <!-- % <div class="todistus drop"><h4 class="otsikko">Todistus</h4> a) Määritelmästä nähdään, että \(\vu=\proj_{\vw}(v)\)on aina yhdensuuntainen vektorin \(\vw\)kanssa. Vektori \(\vu\)saadaan nimittäin vektorista \(\vw\)kertomalla sitä skalaarilla \((\vv \cdot \vw)/(\vw \cdot \vw)\).
                                                                                                                                                                                                        <!-- % -->
                                                                                                                                                                                                        <!-- % b) Jätetään lukijan harjoitustehtäväksi. -->
                                                                                                                                                                                                        <!-- % </div> -->

                                                                                                                                                                                                        Vaikka kaava on yleensä kätevin tapa määrittää vektorin projektio, sen voi tehdä myös suoraan määritelmän perusteella geometrisesti (ks.~kuva~alla <!-- \ref{k-->18}). Piirretään vektorit \(\vv\)ja \(\vw\)alkamaan samasta pisteestä ja piirretään vektorin \(\vw\)suuntainen suora. Projektio \(\proj_{\vw}(v)\)löydetään piirtämällä suora, joka on kohtisuorassa vektorin \(\vw\)suuntaista suoraa vastaan ja kulkee vektorin \(\vv\)kärjen kautta.

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva18.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Vektorin \(\vv\)projektion määrittäminen piirtämällä.}<!-- \label{k18}
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        <!-- %Tämän voisi laittaa toiseen osaan: -->
                                                                                                                                                                                                        <!-- %Osoitetaan vielä lopuksi, että projektio \(\proj_{\vw}(\vv)\)on ainoa vektori, joka on yhdensuuntainen <!-- %vektorin \(\vw\)kanssa, ja jolle pätee, että \(\vv-\proj_{\vw}(\vv)\)ja \(\vw\)ovat ortogonaaliset.
                                                                                                                                                                                                        <!-- %Oletetaan, että \(\vv,\vw \in \R^n\)ja \(\vw \neq \nv\). Oletetaan, että vektori \(\vp\)on yhdensuutainen <!-- %vektorin \(\vw\)kanssa ja lisäksi vektokrit \(\vw\)ja \(\vv-\vp\)ovat ortogonaaliset. Nyt siis \(\vp=t\vw\)<!-- %jollakin \(t \in \R\)ja lisäksi
                                                                                                                                                                                                        <!-- %\begin{align*} -->
                                                                                                                                                                                                        <!-- %0&=\vw \cdot (\vv-\vp) \\ -->
                                                                                                                                                                                                        <!-- %&=\vw \cdot \vv-\vw \cdot \vp \\ -->
                                                                                                                                                                                                        <!-- %&=\vw \cdot \vv-\vw \cdot t\vw \\ -->
                                                                                                                                                                                                        <!-- %&=\vw \cdot \vv-t(\vw \cdot \vw) \\ -->
                                                                                                                                                                                                        <!-- %&=\vw \cdot \vv-t\norm{\vw}^2. -->
                                                                                                                                                                                                        <!-- %\end{align*} -->
                                                                                                                                                                                                        <!-- %Tästä seuraa, että -->
                                                                                                                                                                                                        <!-- %\[t=\frac{\vv \cdot \vw}{\norm{\vw}^2}\] -->
                                                                                                                                                                                                        <!-- %ja edelleen -->
                                                                                                                                                                                                        <!-- %\[\vp=t\vw=\frac{\vv \cdot \vw}{\norm{\vw}^2}\vw.\] -->
                                                                                                                                                                                                        <!-- %Näin ollen \(\vp=\proj_{\vw}(\vv).\) -->

                                                                                                                                                                                                        <h2>Vektorien välinen kulma</h2>

                                                                                                                                                                                                        Suoran kulman lisäksi pistetulo soveltuu myös muiden kulmien määrittämiseen. Ennen määritelmää tarvitaan kuitenkin pari aputulosta. Ensimmäinen on eräs yleisen teorian kannalta tärkeän tulos, jota tässä vaiheessa kuitenkin tarvitaan lähinnä sitä seuraavan lemman todistamiseen.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3>[Schwarzin epäyhtälö]<!-- \label{schwarzLause} -->
                                                                                                                                                                                                        Oletetaan, että \(\vv \in \R^n\)ja \(\vw \in \R^n\). Tällöin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        |\vv \cdot \vw| \le \norm{\vv}\norm{\vw}.
                                                                                                                                                                                                        \]


                                                                                                                                                                                                        Schwarzin epäyhtälön todistus on melko tekninen, ja siksi sen esitystä lykätään kurssin toiseen osaan.
                                                                                                                                                                                                        <!-- % Tasossa kahden vektorin välinen kulma voidaan laskea pistetulon avulla. Yleisessä avaruudessa \(\R^n\)tyydymme geometrisen perustelun sijasta <strong>määrittelemään} vektorien välisen kulman vastaavalla tavalla. Tähän tarvitaan kuitenkin seuraavaa lemmaa. -->

                                                                                                                                                                                                        \begin{lemma}<!-- \label{kulmaLemma} -->
                                                                                                                                                                                                        Oletetaan, että \(\vv, \vw \in \R^n \setminus \{\nv\}\). Tällöin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        -1 \le \frac{\vv \cdot \vw}{\norm{\vv}\norm{\vw}} \le 1.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        \end{lemma}

                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Schwarzin epäyhtälön mukaan \(|\vv \cdot \vw| \le \norm{\vv}\norm{\vw}\). Tästä seuraa, että
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        -\norm{\vv}\norm{\vw} \le \vv \cdot \vw \le \norm{\vv}\norm{\vw}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Jakamalla näin saadut epäyhtälöt positiivisella luvulla \(\norm{\vv}\norm{\vw}\)saadaan
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        -1 \le \frac{\vv \cdot \vw}{\norm{\vv}\norm{\vw}} \le 1. \qedhere
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Nyt voidaan määritellä kahden vektorin välinen kulma. Kosinifunktio on määritelty niin, että jokaista lukua \(x \in [-1,1]\)vastaa täsmälleen yksi sellainen kulma \(\alpha\), että \(0^\circ \leq \alpha \leq 180^\circ\)ja \(\cos \alpha = x\). Edellisen lemman nojalla voidaan siis asettaa seuraava määritelmä.

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3> 
                                                                                                                                                                                                        Vektorien \(\vv \in \R^n\setminus \{\nv\}\)ja \(\vw \in \R^n\setminus \{\nv\}\)välinen <strong>kulma</strong><!-- \index{kulma, vektorien välinen} --> on se kulma \(\alpha\),
                                                                                                                                                                                                        jolle pätee \(0^{\circ} \le \alpha \le 180^{\circ}\)ja
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \cos\alpha=\frac{\vv \cdot \vw}{\norm{\vv}\norm{\vw}}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        }<!-- \label{maaritelma:kulma} -->

                                                                                                                                                                                                        Esimerkiksi vektorien \(\vv=(3,-2,0)\)ja \(\vw=(1,-2,\sqrt{3})\)välinen
                                                                                                                                                                                                        kulma \(\alpha\)saadaan yhtälöstä
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \cos \alpha=\frac{7}{\sqrt{13}\sqrt{8}}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Lisäksi täytyy päteä \(0^{\circ} \le \alpha \le 180^{\circ}\). Laskimella saadaan vektorien välisen kulman likiarvoksi
                                                                                                                                                                                                        \(\alpha \approx 46{,}65^{\circ}\).


                                                                                                                                                                                                        <strong>Määritelmän tausta.} Vaikka määritelmiä ei tarvitsekaan perustella mitenkään, on kuitenkin valaisevaa katsoa, miten vektorien välisen kulman määritelmä vastaa tasossa geometrista käsitystämme.

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva16.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Vektoreiden \(\vv\)ja \(\vw\)välinen kulma kosinilauseen näkökulmasta.}<!-- \label{k16} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Kosinilauseen mukaan kuvan~alla <!-- \ref{k-->16} kolmiossa pätee
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \norm{\vw - \vv}^2 = \norm{\vv}^2 + \norm{\vw}^2 - 2\norm{\vv}\norm{\vw}\cos \alpha.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Toisaalta normin määritelmän nojalla
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{split}
                                                                                                                                                                                                        \norm{\vw - \vv}^2 &= (\vw-\vv)\cdot (\vw-\vv) = \vw \cdot \vw - \vw \cdot \vv - \vv \cdot \vw + \vv \cdot \vv\\
                                                                                                                                                                                                        & = \norm{\vv}^2 - 2(\vv \cdot \vw) + \norm{\vw}^2.
                                                                                                                                                                                                        \end{split}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Saadaan siis yhtälö
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \norm{\vv}^2 + \norm{\vw}^2 - 2\norm{\vv}\norm{\vw}\cos \alpha = \norm{\vv}^2 - 2(\vv \cdot \vw) + \norm{\vw}^2,
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        josta edelleen
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \cos \alpha = \frac{\vv \cdot \vw}{\norm{\vv}\norm{\vw}}.
                                                                                                                                                                                                        \]



                                                                                                                                                                                                        Aiemmin määriteltiin, että vektorit ovat kohtisuorassa toisiaan vastaan, jos niiden pistetulo on nolla. Olisi luonnollista että toisiaan vastaan kohtisuorien vektorien välinen kulma olisi \(90^\circ\). Tämä pitääkin paikkansa. Oletetaan nimittäin, että \(\vv, \vw \in \R^n \setminus\{\nv\}\). Määritelmän~\ref{maaritelma:kulma} mukaan vektoreiden \(\vv\)ja \(\vw\)välinen kulma on \(90^{\circ}\), jos ja vain jos
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \frac{\vv \cdot \vw}{\norm{\vv}\norm{\vw}}=\cos 90^\circ.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Koska \(\cos 90^\circ=0\), yhtälö pätee, jos ja vain jos \(\vv \cdot \vw=0\). Siten vektoreiden \(\vv\)ja \(\vw\)välinen kulma on \(90^{\circ}\), jos ja vain jos \(\vv \cdot \vw=0\).

                                                                                                                                                                                                        <!-- % <div class="image"> -->
                                                                                                                                                                                                        <!-- %  -->
                                                                                                                                                                                                        <!-- % <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva79.png" /> -->
                                                                                                                                                                                                        <!-- % <strong>Kuva: </strong>Vektorit \(\vv\)ja \(\vw\)ovat ortogonaaliset eli kohtisuorassa toisiaan vastaan. <!-- \label{k79}} -->
                                                                                                                                                                                                        <!-- % </div> -->

                                                                                                                                                                                                        <!-- %<div class="lause"><h3>Lause</h3>[Pythagoraan lause] -->
                                                                                                                                                                                                        <!-- %Vektorit \(\vv\in \R^n\)ja \(\vw\in \R^n\) -->
                                                                                                                                                                                                        <!-- %ovat ortogonaaliset, jos ja vain jos \[\norm{\vv+\vw}^2=\norm{\vv}^2+\norm{\vw}^2.\] -->
                                                                                                                                                                                                        <!-- % -->

                                                                                                                                                                                                        <h2>Pistetulon sovelluksia</h2>

                                                                                                                                                                                                        <h3></h3>Normaalimuotoiset yhtälöt}

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> Tarkastellaan kaikkia avaruuden \(\R^3\)vektoreita \(\vv\), jotka ovat kohtisuorassa vektoria \(\vn=(1,2,3)\)vastaan. Tällaiset vektorit toteuttavat yhtälön
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \vn\cdot\vv=0  \text{eli}  v_1+2v_2+3v_3=0.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Vektorien muodostama joukko \(W\)voidaan kirjoittaa eri muodoissa:
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        W & =\{(v_1,v_2,v_3)\in\R^3 \mid v_1+2v_2+3v_3=0\} \\
                                                                                                                                                                                                        & =\{(v_1,v_2,v_3)\in\R^3 \mid v_1=-2v_2-3v_3\} \\
                                                                                                                                                                                                        & =\{(-2v_2-3v_3,\,v_2,\,v_3) \mid v_2,v_3\in\R\} \\
                                                                                                                                                                                                        & =\{v_2(-2,1,0)+v_3(-3,0,1) \mid v_2,v_3\in\R\}.
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        Viimeisestä muodosta nähdään, että kyseessä on origon kautta kulkeva taso eli aliavaruus.
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Edellistä esimerkkiä voidaan yleistää, jolloin nähdään, että kaikki jotakin nollavektorista poikkeavaa vektoria vastaan kohtisuorassa olevat avaruuden \(\R^3\)vektorit muodostavat tietyn tason, joka on samalla aliavaruus. Päätellään seuraavaksi sama asia toiseen suuntaan.

                                                                                                                                                                                                        Tarkastellaan aluksi origon kautta kulkevaa tasoa \(T=\{s\vv+t\vw \mid s,t\in\R\}\). Jos jokin vektori \(\vn\)on kohtisuorassa tason molempia suuntavektoreita vastaan, niin kaikille tason vektoreille \(s\vv+t\vw\)pätee
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \vn\cdot(s\vv+t\vw)=s(\vn\cdot\vv)+t(\vn\cdot\vw)=s\cdot 0+t\cdot 0=0.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Vektori \(\vn\)on siis kohtisuorassa kaikkia tason vektoreita vastaan, jolloin sanotaan, että se on <strong>kohtisuorassa tasoa vastaan}. Tällaista vektoria kutsutaan tason <strong>normaaliksi} (ks. kuva alla <!-- \ref{k-->71}).

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva71.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Tason normaali \(\vn\).} <!-- \label{k71} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Olkoon \(\vn\)edelleen origon kautta kulkevan tason \(T\)normaali. Voidaan osoittaa, että piste \(\vx\)on tasossa \(T\), jos ja vain jos
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \vn\cdot\vx=0.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Tällaista yhtälöä kutsutaan tason <strong>normaalimuotoiseksi yhtälöksi</strong><!-- \index{normaalimuotoinen yhtälö, tason} --> (kun taso kulkee origon kautta).

                                                                                                                                                                                                        Jos taso ei kulje origon kautta, on sen vektoreita siirrettävä ennen normaalin määrittämistä. Oletetaan, että \(T\)on nyt avaruuden \(\R^3\)taso, jonka paikkavektori on \(\vp\)ja jolla on normaali \(\vn\). Tällöin \(\vx\)on tasossa \(T\), jos ja vain jos
                                                                                                                                                                                                        \[\begin{equation*}
                                                                                                                                                                                                        \vn \cdot (\vx-\vp) = 0.
                                                                                                                                                                                                        \begin{equation*}\]
                                                                                                                                                                                                        Tämä on siis normaalimuotoinen yhtälö tapauksessa, jossa taso ei kulje origon kautta. Tilannetta on havainnollistettu kuvassa alla <!-- \ref{k-->38}.

                                                                                                                                                                                                        <!-- % Edellä esitettyä yhtälöä kutsutaan tason \(T\)<strong>normaalimuotoiseksi yhtälöksi}. Piste \(Q\)on tasossa \(T\), jos ja vain jos pisteen paikkavektori \(\vq\)toteuttaa yhtälön. -->

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva38.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Tason \(T\)normaalimuotoisen yhtälön havainnollistus.}<!-- \label{k38} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"><!-- \label{esim:normaalimuoto} -->
                                                                                                                                                                                                        Oletetaan, että taso \(T\)kulkee pisteen \(P=(6,0,1)\)kautta ja sillä on normaali \(\vn=(1,2,3)\). Tason \(T\)normaalimuotoinen yhtälö on tällöin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        (1,2,3) \cdot \bigl(\vq - (6,0,1)\bigr) = 0.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Tasossa \(T\)ovat siis ne pisteet \(\vq\), jotka toteuttavat edellä esitetyn yhtälön. Toisin sanoen
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        T=\{\vq \in \R^3 \mid (1,2,3) \cdot (\vq - (6,0,1)) = 0\}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Kirjoitetaan sama taso vielä hiukan toisenlaisessa muodossa. Merkitään \(\vx=(x,y,z)\), missä \(x,y,z \in \R\). Nyt
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        (1,2,3) \cdot (\vx - (6,0,1))&=(1,2,3) \cdot (x-6,y-0,z-1)\\
                                                                                                                                                                                                        &=x-6+2y+3z-3 \\
                                                                                                                                                                                                        &=x+2y+3z-9.
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        Voidaan siis kirjoittaa
                                                                                                                                                                                                        \)T=\{\vq \in \R^3 \mid x+2y+3z-9=0\}\).
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Avaruuden \(\R^2\)suorille on mahdollista johtaa normaalimuotoinen yhtälö samalla tavalla kuin tasoille.

                                                                                                                                                                                                        <h3></h3>Pisteen etäisyys suorasta}

                                                                                                                                                                                                        Pisteen \(Q\)etäisyys suorasta \(S=\{\vp+t\vv \mid t \in \R\}\)on kaikkein lyhin välimatka, joka voi olla pisteen \(Q\)ja suoran \(S\)jonkin pisteen välillä. Täsmällisesti ilmaistuna pisteen \(Q\)etäisyys suorasta \(S\)on \(\min\{d(\vq,\va) \mid \va \in S\}\), missä \(\vq\)on pisteen \(Q\)paikkavektori. Tämä etäisyys on sama kuin sellaisen janan pituus, jonka toinen päätepiste on \(Q\)ja toinen suoralla \(S\), ja joka muodostaa suoran kulman suoran \(S\)kanssa. (Todistus ei ole vaikea, mutta se sivuutetaan.) Etäisyyden määrittämiseen voidaan siten käyttää projektiota. Tutkitaan tätä esimerkin avulla.<!-- %, kuinka projektiota voidaan käyttää etäisyyden määrittämisessä, ilman tarkkoja todistuksia. -->

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"><!-- \label{pisteenEtaisyysSuorastaEsim} -->
                                                                                                                                                                                                        Määritetään pisteen \(Q = (4,-1,9)\)etäisyys suorasta \(S\), joka kulkee pisteiden \(A = (2,-3,5)\)ja \(B = (4,1,7)\)kautta (ks. kuva alla <!-- \ref{k-->27}).

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva27.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Pisteiden \(A\)ja \(B\)kautta kulkeva suora \(S\).}<!-- \label{k27} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Määritetään ensin vektori jostakin suoran pisteestä tutkittavaan pisteeseen. Esimerkiksi vektori
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \pv{AQ} = \pv{OQ} - \pv{OA} =(2,2,4)
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        käy tähän tarkoitukseen.
                                                                                                                                                                                                        Lisäksi tarvitaan jokin suoran suuntavektori, kuten vaikkapa vektori \(\pv{AB} = (2, 4, 2)\).

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva36.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Pisteen \(Q\)etäisyys suorasta \(S\).}<!-- \label{k36} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Vektorin \(\pv{AQ}\)projektio suoralle \(S\)on
                                                                                                                                                                                                        \[\proj_{\pv{AB}}(\pv{AQ}) = \frac{\pv{AQ} \cdot \pv{AB}}{\pv{AB} \cdot \pv{AB}}\pv{AB} = \frac{20}{24}(2, 4, 2) = \frac{5}{6}(2, 4, 2).\]
                                                                                                                                                                                                        Erotus \(\pv{AQ} - \proj_{\pv{AB}}(\pv{AQ})\)on projektion määritelmän mukaisesti kohtisuorassa suoraa \(S\)vastaan. Lasketaan kyseinen erotus:
                                                                                                                                                                                                        \[\begin{split}
                                                                                                                                                                                                        \pv{AQ} - \proj_{\pv{AB}}(\pv{AQ}) &=(2,2,4) - \frac{5}{6}(2, 4, 2)=\frac{6}{6}(2,2,4) - \frac{5}{6}(2, 4, 2) \\
                                                                                                                                                                                                        &= \frac{1}{6}(12-10,12-20,24-10)= \frac{1}{6}(2,-8,14) \\
                                                                                                                                                                                                        &= \frac{1}{3}(1,-4,7)
                                                                                                                                                                                                        \end{split}\]
                                                                                                                                                                                                        Koska \(\pv{AQ} - \proj_{\pv{AB}}(\pv{AQ})\)on kohtisuorassa suoraa \(S\)vastaan, antaa erotusvektorin pituus pisteen \(Q\)etäisyyden suorasta:
                                                                                                                                                                                                        \[\|\pv{AQ} - \proj_{\pv{AB}}(\pv{AQ})\| = \frac{1}{3}\|(1,-4,7)\| = \frac{1}{3}\sqrt{1 + 16 + 49} = \frac{1}{3}\sqrt{66}.\]
                                                                                                                                                                                                        Siten pisteen \(Q\)etäisyys suorasta \(S\)on \(\frac{1}{3}\sqrt{66}\).
                                                                                                                                                                                                        </div></div>


                                                                                                                                                                                                        <!-- \begin{comment}
                                                                                                                                                                                                        <h2>Ortogonaalinen ja ortonormaali kanta}<!-- \label{ortonormaaliKantaPistetuloLuku} 
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Avaruuden \(\R^n\)aliavaruuden \(W\)kanta \((\vw_1,\vw_2,\dots,\vw_k)\)on
                                                                                                                                                                                                        <strong>orto\-gonaalinen}, jos
                                                                                                                                                                                                        \[\vw_i \cdot \vw_j=0  \text{kaikilla \(i,j \in \{1,2,\dots ,k\}\), missä \(i \neq j\).}\]
                                                                                                                                                                                                        Toisin sanoen kantavektorit ovat kohtisuorassa toisiaan vastaan. <!-- %(eikä mikään vektoreista ole nollavektori, koska kysymyksessä on kanta).
                                                                                                                                                                                                        
                                                                                                                                                                                                        Kanta \((\vw_1,\vw_2,\dots,\vw_k)\)on <strong>ortonormaali}, jos se on
                                                                                                                                                                                                        ortogonaalinen ja lisäksi
                                                                                                                                                                                                        \[\norm{\vw_i}=1  \text{kaikilla \(i \in \{1,2,\dots ,k\}\)}.\]
                                                                                                                                                                                                        Toisin sanoen kantavektorit ovat kohtisuorassa toisiaan vastaan ja niiden normi
                                                                                                                                                                                                        on yksi.
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto"> <!-- \label{ortonormaaliEsim}
                                                                                                                                                                                                        Avaruuden \(\R^n\)luonnollinen kanta \(\kE_n=(\ve_1, \dots, \ve_n)\)on ortonormaali. Huomataan nimittäin, että
                                                                                                                                                                                                        \[\ve_i \cdot \ve_j=0,  \text{jos \(i \neq j\)}.\]
                                                                                                                                                                                                        Lisäksi \(\norm{\ve_i}=1\)kaikilla \(i \in \{1,\dots,n\}\).
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="image">
                                                                                                                                                                                                        
                                                                                                                                                                                                        <!-- %\resizebox{\columnwidth}{!}{{kuva7.png" />}
                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva53.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Avaruuden \(\R^3\)luonnollinen kanta \(\kE_3 = (\ve_1, \ve_2, \ve_3)\)on ortonormaali.}<!-- \label{k53}
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </div></div>
                                                                                                                                                                                                        
                                                                                                                                                                                                        Ortogonaaliset kannat ovat monissa tilanteissa hyvin käyttökelpoisia. Mistä tahansa kannasta voidaan muodostaan ortogonaalinen kanta projektiota apuna käyttäen. Seuraavassa esimerkissä näytetään, miten tämä tapahtuu avaruudessa \(\R^2\). Asiaan palataan tarkemmin kurssin toisessa osassa.
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Merkitään \(\vv_1 = (-1,2)\)ja \(\vv_2 = (3,-1)\). Jono \((\vv_1, \vv_2)\)on avaruuden \(\R^2\)kanta. (Tämän todistaminen jätetään lukijalle.)
                                                                                                                                                                                                        
                                                                                                                                                                                                        Etsitään ortogonaalinen kanta muodostamalla uusi jono \((\vw_1, \vw_2)\)valitsemalla \(\vw_1 = \vv_1\)ja \(\vw_2 = \vv_2-\proj_{\vw_1}(\vv_2)\). Nyt vektorit \(\vw_1\)ja \(\vw_2\)ovat ortogonaaliset kuten luvussa \ref{projektioLuku} todettiin. Lisäksi \((\vw_1, \vw_2)\)on avaruuden \(\R^2\)kanta, minkä todistaminen jätetään jälleen lukijalle.
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="image">
                                                                                                                                                                                                        
                                                                                                                                                                                                        <!-- %\resizebox{\columnwidth}{!}{{kuva7.png" />}
                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva54.png" /> 
                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva55.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Kannan \((\vv_1, \vv_2)\)muuttaminen ortogonaaliseksi kannaksi \((\vw_1, \vw_2)\).}<!-- \label{k55}
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        
                                                                                                                                                                                                        Näin saadusta ortogonaalisesta kannasta voidaan vielä muodostaa ortonormaali kanta \((\vu_1, \vu_2)\)valitsemalla
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \vu_1 &= \dfrac{1}{\|\vw_1\|}\vw_1 = \frac{1}{\sqrt{5}}(-1,2)  \text{ja} 
                                                                                                                                                                                                        \vu_2 = \dfrac{1}{\|\vw_2\|}\vw_2= \frac{1}{\sqrt{5}}(2,1).
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        Jono \((\vu_1, \vu_2)\)on avaruuden \(\R^2\)ortonormaali kanta.
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="image">
                                                                                                                                                                                                        
                                                                                                                                                                                                        <!-- %\resizebox{\columnwidth}{!}{{kuva7.png" />}
                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva56.png" />
                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva57.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Ortogonaalinen kanta \((\vw_1, \vw_2)\)ja ortonormaali kanta \((\vu_1, \vu_2)\).}<!-- \label{k56&57}
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </div></div>
                                                                                                                                                                                                        
                                                                                                                                                                                                        Vektorin koordinaatit ortonormaalin kannan suhteen saadaan pistetulon avulla.
                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{koordinaattiSisatuloLause}
                                                                                                                                                                                                        Oletetaan, että \(\mathcal{B}=(\vu_1,\dots,\vu_k)\)on aliavaruuden \(W\)ortonormaali
                                                                                                                                                                                                        kanta. Oletetaan, että \(\vw \in W\). Tällöin vektorin \(\vw\)koordinaatit kannan \(\mathcal{B}\)suhteen ovat \(\vw \cdot \vu_1\), \(\vw \cdot \vu_2, \dots, \vw \cdot \vu_k\)eli
                                                                                                                                                                                                        \[\vw = (\vw \cdot \vu_1)\vu_1 + (\vw \cdot \vu_2)\vu_2 + \dots + (\vw \cdot \vu_k)\vu_k\,.\]
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Tutkitaan vektorin \(\vw \in W\)koordinaatteja kannan \(S\)suhteen. Olkoot
                                                                                                                                                                                                        koordinaatit \(a_1,\dots,a_k\)eli \(\vw=a_1\vw_1+a_2\vw_2+\cdots+a_k\vw_k\).
                                                                                                                                                                                                        Huomataan, että
                                                                                                                                                                                                        \[\begin{split}
                                                                                                                                                                                                        \vw \cdot \vw_1&=(a_1\vw_1+a_2\vw_2+\cdots+a_k\vw_k) \cdot \vw_1 \\
                                                                                                                                                                                                        &=a_1(\vw_1\cdot \vw_1)+a_2(\vw_2\cdot \vw_1)+\cdots+a_k(\vw_k\cdot \vw_1) \\
                                                                                                                                                                                                        &=a_1 \cdot 1+a_2 \cdot 0+\cdots+a_k \cdot 0=a_1.
                                                                                                                                                                                                        \end{split}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Vastaavalla tavalla nähdään, että \(\vw \cdot \vw_i=a_i\)kaikilla \(i \in
                                                                                                                                                                                                        \{1,2,\dots,k\}\). Vektorin \(\vw\)koordinaatit kannan \(\kB\)suhteen saadaan siis
                                                                                                                                                                                                        laskemalla \(\vw\):n pistetulo kantavektorien kanssa.
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Määritetään vektorin \(\vw = (2, 9, -7)\)koordinaantit ortonormaalin kannan \(\mathcal{E}_3 = (\ve_1, \ve_2, \ve_3)\)suhteen käyttäen edellä osoitettua tulosta. Koska
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \vw \cdot \ve_1 &= (2,9,-7)\cdot (1,0,0) = 2, \\
                                                                                                                                                                                                        \vw \cdot \ve_2 &= (2,9,-7)\cdot (0,1,0) = 9, \\
                                                                                                                                                                                                        \vw \cdot \ve_3 &= (2,9,-7)\cdot (0,0,1) = -7,
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        saadaan \(\vw = 2\ve_1 + 9\ve_2-7\ve_3\). (Tämän olisimme toki voineet päätellä suoraankin.)
                                                                                                                                                                                                        </div></div>
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Tarkastellaan esimerkissä \ref{ortonormaaliEsim} muodostettua avaruuden \(\R^2\)orto\-normaalia kantaa \((\vu_1, \vu_2)\), jossa
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \vu_1 = \frac{1}{\sqrt{5}}(-1,2),  \vu_2 = \frac{1}{\sqrt{5}}(2,1).
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Vektorin \(\vv = (3,4)\)koordinaatit tämän kannan suhteen ovat
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \vv \cdot \vu_1 &= \dfrac{1}{\sqrt{5}}\Bigl((3,4)\cdot (-1,2)\Bigr) = \dfrac{5}{\sqrt{5}}= \sqrt{5}, \\
                                                                                                                                                                                                        \vv \cdot \vu_2 &= \dfrac{1}{\sqrt{5}}\Bigl((3,4)\cdot (2,1)\Bigr) = \dfrac{10}{\sqrt{5}} =2\sqrt{5}.
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        
                                                                                                                                                                                                        <div class="image">
                                                                                                                                                                                                        
                                                                                                                                                                                                        <!-- %\resizebox{\columnwidth}{!}{{kuva7.png" />}
                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva58.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Vektorin \(\vv\)koordinaantit ortonormaalin kannan \((\vu_1, \vu_2)\)suhteen.}<!-- \label{k58}
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </div></div>
                                                                                                                                                                                                        \end{comment} -->
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </section>
                                                                                                                                                                                                        <section class="kappaleraja" id="14">
                                                                                                                                                                                                        <div div class="kappaleraja-linis" id="Ristitulo" tekija="Jokke Häsä, Lotta Oinonen, Johanna Rämö" deadline=" ">
                                                                                                                                                                                                        <h1>Ristitulo</h1>

                                                                                                                                                                                                        Avaruuden \(\R^3\)vektoreille voidaan määritellä pistetulon lisäksi niin kutsuttu ristitulo. Pistetulosta poiketen ristitulon tulos ei ole reaaliluku vaan avaruuden \(\R^3\)vektori. Ristitulosta on hyötyä esimerkiksi silloin, kun tarvitaan vektori, joka on kohtisuorassa jotakin tasoa vastaan.

                                                                                                                                                                                                        Ristitulo poikkeaa kaikista kurssilla tähän mennessä määritellyistä käsitteistä siinä, että sen määritelmää ei voida yleistää kaikkiin avaruuksiin \(\R^n\). Ristitulo on nimenomaan kolmiulotteisen avaruuden laskutoimitus.

                                                                                                                                                                                                        <div class="maar"><h3>Määritelmä</h3>
                                                                                                                                                                                                        Vektorien \(\vv = (v_1, v_2,v_3)\in \R^3\)ja \(\vw = (w_1, w_2, w_3)\in \R^3\)<strong>ristitulo</strong><!-- \index{ristitulo} --> on vektori
                                                                                                                                                                                                        \[\vv \times \vw = (v_2w_3-v_3w_2,\ v_3w_1-v_1w_3,\ v_1w_2-v_2w_1).\]
                                                                                                                                                                                                        }

                                                                                                                                                                                                        Ristitulon \(\vv \times \vw\)laskemiseen voi käyttää kuvassa alla <!-- \ref{k-->32} esitettyä laskusääntöä. Yhtenäisellä viivalla yhdistettyjen komponenttien tulosta vähennetään katkoviivalla yhdistettyjen komponenttien tulo.

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva32.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Ristitulon \(\vv \times \vw\)laskeminen.}<!-- \label{k32} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Merkitään \(\va = (2,1,4)\)ja \(\vb = (3,-1,-3)\). Kuvan~alla <!-- \ref{k-->44} perusteella voidaan laskea
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{split}
                                                                                                                                                                                                        \va \times \vb &= (1 \cdot (-3)- 4 \cdot (-1), \ 4 \cdot 3 - 2 \cdot (-3), \ 2 \cdot (-1)- 1 \cdot 3) \\
                                                                                                                                                                                                        &=(1, 18, -5).
                                                                                                                                                                                                        \end{split}
                                                                                                                                                                                                        \]

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva44.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Ristitulon \(\va \times \vb\)laskeminen.}<!-- \label{k44} -->
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Ristitulolle saadaan toinen muistisääntö determinantin avulla. Vektoreiden \(\vv\)ja \(\vw\)ristitulo saadaan laskemalla determinantti
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{vmatrix}
                                                                                                                                                                                                        \ve_1 & \ve_2 & \ve_3 \\
                                                                                                                                                                                                        v_1 & v_2 & v_3 \\
                                                                                                                                                                                                        w_1 & w_2 & w_3
                                                                                                                                                                                                        \end{vmatrix}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Tässä \(\ve_1=(1,0,0)\), \(\ve_2=(0,1,0)\)ja \(\ve_3=(0,0,1)\). Tarkalleen ottaen oikean determinantin alkiot eivät voisi olla vektoreita, mutta kyseessä on vain muistisääntö: vektoreiden \(\ve_1\), \(\ve_2\)ja \(\ve_3\)ajatellaan käyttäytyvän determinanttia laskettaessa reaalilukujen tavoin.

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Esimerkiksi vektoreiden \(\va = (2,1,4)\)ja \(\vb = (3,-1,-3)\)ristitulo on
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        & \begin{vmatrix}
                                                                                                                                                                                                        \ve_1 & \phantom{-}\ve_2 & \phantom{-}\ve_3 \\
                                                                                                                                                                                                        2 & \phantom{-}1 & \phantom{-}4 \\
                                                                                                                                                                                                        3 & -1 & -3
                                                                                                                                                                                                        \end{vmatrix} \\
                                                                                                                                                                                                        & =\ve_1\bigl(1\cdot(-3)-4\cdot(-1)\bigr)
                                                                                                                                                                                                        -\ve_2\bigl(2\cdot(-3)-4\cdot 3\bigr)
                                                                                                                                                                                                        +\ve_3\bigl(2\cdot(-1)-1\cdot 3\bigr) \\
                                                                                                                                                                                                        & =\ve_1-18\ve_2-5\ve_3=(1, 18, -5).
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Eräs ristitulon sovelluksista on, että sen avulla voidaan löytää vektori, joka on kohtisuorassa yhtä aikaa kahta vektoria
                                                                                                                                                                                                        vastaan.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{ristituloKohtisuoruusLause} -->
                                                                                                                                                                                                        Oletetaan, että \(\vv,\vw \in \R^3\). Tällöin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        (\vv \times \vw) \perp \vv  \text{ja}  (\vv \times \vw) \perp \vw.
                                                                                                                                                                                                        \]


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Huomataan, että
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{split}
                                                                                                                                                                                                        (\vv \times \vw) \cdot \vv&=(v_2w_3-v_3w_2,\ v_3w_1-v_1w_3,\ v_1w_2-v_2w_1) \cdot (v_1,v_2,v_3) \\
                                                                                                                                                                                                        &=(v_2w_3-v_3w_2)v_1+(v_3w_1-v_1w_3)v_2+(v_1w_2-v_2w_1)v_3 \\
                                                                                                                                                                                                        &=v_2w_3v_1-v_3w_2v_1+v_3w_1v_2-v_1w_3v_2+v_1w_2v_3-v_2w_1v_3=0.
                                                                                                                                                                                                        \end{split}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Siten vektorit \((\vv \times \vw)\)ja \(\vv\)ovat kohtisuorassa toisiaan vastaan. Väitteen toinen osa osoitetaan samalla tavalla.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva72.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Ristitulo \(\vv \times \vw\)on kohtisuorassa vektoria \(\vv\)ja vektoria \(\vw\)vastaan.}<!-- \label{k72} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Edellisestä lauseesta seuraa, että ristitulon avulla voidaan löytää tason normaali (eli vektori, joka on kohtisuorassa tason suuntavektoreita vastaan). Tästä on hyötyä tason normaalimuotoisen yhtälön määrittämisessä.

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Määritetään esimerkkiä~\ref{esim:normaalimuoto} mukaillen normaalimuotoinen yhtälö tasolle \(T\), joka kulkee pisteiden \(A = (0,1,0)\), \(B = (-1,3,2)\)ja \(C = (-2,0,1)\)kautta. Tätä varten tarvitaan tason \(T\)normaali. Normaali on vektori, joka on kohtisuorassa tason suuntavektoreita vastaan. Valitaan suuntavektoreiksi suuntajanat \(\pv{AB} = (-1,2,2)\)ja \(\pv{AC} = (-2,-1,1)\), jolloin normaaliksi käy edellisen lauseen nojalla vektorien ristitulo
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \pv{AB} \times \pv{AC} = (4,-3,5).
                                                                                                                                                                                                        \]

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva38b.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Tason \(T\)normaalimuotoisen yhtälön määrittäminen.}<!-- \label{k38b} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Lisäksi tarvitaan jokin tason paikkavektori, kuten esimerkiksi \(\pv{OA}=(0,1,0)\). Kun merkitään vielä \(\vq=\pv{OQ}=(x,y,z)\), tason normaalimuotoiseksi yhtälöksi saadaan esimerkin~\ref{esim:normaalimuoto} mukaisesti
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        (\underbrace{\pv{AB} \times \pv{AC}}_{\text{normaali}})\cdot(\pv{OQ}-\pv{OA})=0.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Kun yhtälöön sijoitetaan luvut, se tulee muotoon
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        (4,-3,5)\cdot(x,y-1,0)=0.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Laskemalla pistetulo saadaan yhtälö lopulliseen muotoon
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        4x-3y+5z+3 = 0.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Näin ollen \(T=\{(x,y,z) \in \R^3 \mid 4x - 3y + 5z + 3 = 0\}.\)
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        <div class="esim drop"><h3 class="otsikko">Esimerkki</h3><div class="sisalto">
                                                                                                                                                                                                        Pisteen etäisyys tasosta voidaan määrittää ristitulon ja projektion avulla.
                                                                                                                                                                                                        Merkitään \(A = (0,1,0)\), \(B = (-1,3,2)\)ja \(C = (-2,0,1)\).
                                                                                                                                                                                                        Oletetaan, että taso \(T\)kulkee pisteiden \(A\), \(B\)ja \(C\)kautta. Määritetään
                                                                                                                                                                                                        pisteen \(D = (1,2,3)\)etäisyys tasosta \(T\)(ks. kuva alla <!-- \ref{k-->37}).

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva37.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Pisteen \(D\)etäisyys tasosta \(T\).}<!-- \label{k37} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Tason suuntaisten vektoreiden \(\pv{AB} = (-1,2,2)\)ja \(\pv{AC} = (-2,-1,1)\)ristitulo
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \pv{AB} \times \pv{AC} = (4,-3,5)
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        on tason normaali.
                                                                                                                                                                                                        Lisäksi tarvitaan vektori jostakin tason pisteestä pisteeseen \(D=(1,2,3)\). Valitaan vektori
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \pv{AD} = \pv{OD} - \pv{OA} = (1,1,3).
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Vektorin \(\pv{AD}\)projektio normaalin \(\vn = \pv{AB} \times \pv{AC}\)virittämälle aliavaruudelle
                                                                                                                                                                                                        on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \begin{split}
                                                                                                                                                                                                        \proj_{\vn}(\pv{AD}) = \frac{\pv{AD}\cdot \vn}{\vn \cdot \vn}\,\vn = \frac{16}{50}\,(4,-3,5)= \frac{8}{25}\,(4,-3,5).
                                                                                                                                                                                                        \end{split}
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Tämän projektion normi (eli pituus) on pisteen \(P\)etäisyys tasosta \(T\):
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \|\proj_{\vn}(\pv{AD})\|=  \frac{8}{25}\,\|(4,-3,5)\| = \frac{8}{25}\sqrt{16 + 9 + 25} = \frac{8}{25}\sqrt{50}
                                                                                                                                                                                                        = \frac{8}{5}\sqrt{2}.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        </div></div>

                                                                                                                                                                                                        Seuraavassa lauseessa on lueteltu ristituloon liittyviä laskusääntöjä. Erityisesti sääntöihin a), e) ja g) on hyvä kiinnittää huomiota, sillä ne poikkeavat monista tutuista laskusäännöistä. Esimerkiksi säännön a) mukaan ristitulo ei ole vaihdannainen laskutoimitus.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{ristitulonOminaisuudetLause} -->
                                                                                                                                                                                                        Oletetaan, että \(\vu\), \(\vv\), \(\vw \in \R^3\)ja \(c \in \R\). Tällöin
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li> \(\vv \times \vw = -(\vw \times \vv)\) (antikommutointi)
                                                                                                                                                                                                        <li> \(\vu \times (\vv + \vw) = \vu \times \vv + \vu \times \vw\)
                                                                                                                                                                                                        (osittelulaki)
                                                                                                                                                                                                        <li> \((\vv + \vw) \times \vu = \vv \times \vu + \vw \times \vu\)
                                                                                                                                                                                                        (osittelulaki)
                                                                                                                                                                                                        <li> \(c(\vv \times \vw) = (c\vv) \times \vw = \vv \times (c\vw)\)
                                                                                                                                                                                                        <li> \(\vv \times \vv = \nv\)
                                                                                                                                                                                                        <li> \(\nv \times \vv = \nv\)ja \(\vv \times \nv = \nv\)
                                                                                                                                                                                                        <li> \(\vu \cdot (\vv \times \vw) = (\vu \times \vv) \cdot \vw\)
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Lauseen todistus on suoraviivainen ja käyttää ainoastaan ristitulon määritelmää. Todistus jätetään harjoitustehtäväksi.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Ristitulolla ja pistetulolla on yhteyksiä, jotka eivät ole aivan itsestään selviä. Niitä on koottu seuraavaan lauseeseen.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{ristituloJaPistetuloLause} -->
                                                                                                                                                                                                        Oletetaan, että \(\vu\), \(\vv\), \(\vw \in \R^3\). Tällöin
                                                                                                                                                                                                        <ol><!-- \begin{aakkosta*} -->
                                                                                                                                                                                                        <li> \((\vu \times \vv) \times \vw = (\vu \cdot \vw)\vv - (\vv\cdot \vw) \vu\)
                                                                                                                                                                                                        <li> \(\vu \times (\vv \times \vw) = (\vu \cdot \vw)\vv - (\vu \cdot \vv) \vw\)
                                                                                                                                                                                                        <li> \(\norm{\vv \times \vw}^2 = \norm{\vv}^2\norm{\vw}^2 - (\vv \cdot \vw)^2\)
                                                                                                                                                                                                        (Lagrangen identiteetti)
                                                                                                                                                                                                        </ol><!-- \end{aakkosta*} -->


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Osoitetaan kohta c) (eli Lagrangen identiteetti) ja jätetään muut kohdat harjoitustehtäviksi. Käyttämällä lauseen \ref{ristitulonOminaisuudetLause} kohtaa g) ja lauseen \ref{ristituloJaPistetuloLause} kohtaa a) saadaan
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \norm{\vv \times \vw}^2&=(\vv \times \vw) \cdot (\vv \times \vw)
                                                                                                                                                                                                        =\bigl((\vv \times \vw) \times \vv\bigr) \cdot \vw \\
                                                                                                                                                                                                        &=\bigl((\vv \cdot \vv)\vw-(\vv \cdot \vw)\vv\bigr) \cdot \vw
                                                                                                                                                                                                        =\bigl(\norm{\vv}^2\vw-(\vv \cdot \vw)\vv\bigr) \cdot \vw \\
                                                                                                                                                                                                        &=\norm{\vv}^2(\vw \cdot \vw)-(\vv \cdot \vw)(\vv \cdot \vw)
                                                                                                                                                                                                        =\norm{\vv}^2\norm{\vw}^2-(\vv \cdot \vw)^2.
                                                                                                                                                                                                        \end{align*}
                                                                                                                                                                                                        Siten Lagrangen identiteetti pätee.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Lauseen~\ref{ristituloKohtisuoruusLause} perusteella tiedetään, että kahden vektorin ristitulo on kohtisuorassa kumpaakin vektoria vastaan, joten ristitulovektorin suunnalla on vain kaksi mahdollisuutta. Ristitulovektorin pituus puolestaan määräytyy seuraavasta lauseesta.

                                                                                                                                                                                                        <div class="lause"><h3>Lause</h3> <!-- \label{kohtisuoraRistituloLause} -->
                                                                                                                                                                                                        Oletetaan, että \(\vv, \vw \in \R^3\). Jos \(\vv \neq \nv\)ja \(\vw \neq \nv\), niin
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \norm{\vv \times \vw} = \norm{\vv}\norm{\vw}\sin \alpha,
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        missä \(\alpha\)on vektorien \(\vv\)ja \(\vw\)
                                                                                                                                                                                                        välinen kulma.


                                                                                                                                                                                                        <div class="todistus drop"><h4 class="otsikko">Todistus</h4>
                                                                                                                                                                                                        Todistuksessa käytetään Lagrangen identiteettiä (lause \ref{ristituloJaPistetuloLause}). Vektorien välisen kulman määritelmän mukaan \(\cos\alpha=(\vv \cdot \vw)/(\norm{\vv}\norm{\vw})\), ja lisäksi pätee \(\sin^2 \alpha+\cos^2 \alpha =1\). Nyt Lagrangen identiteetistä saadaan
                                                                                                                                                                                                        \begin{align*}
                                                                                                                                                                                                        \norm{\vv \times \vw}^2 &= \norm{\vv}^2\norm{\vw}^2 - (\vv \cdot \vw)^2
                                                                                                                                                                                                        = \norm{\vv}^2\norm{\vw}^2 - (\cos\alpha\cdot\norm{\vv}\norm{\vw})^2 \\
                                                                                                                                                                                                        &= \norm{\vv}^2\norm{\vw}^2 - \cos^2\alpha\cdot\norm{\vv}^2\norm{\vw}^2
                                                                                                                                                                                                        = \norm{\vv}^2\norm{\vw}^2(1-\cos^2\alpha) \\
                                                                                                                                                                                                        &= \norm{\vv}^2\norm{\vw}^2\sin^2\alpha
                                                                                                                                                                                                        = (\norm{\vv}\norm{\vw}\sin\alpha)^2.
                                                                                                                                                                                                        \end{align*}

                                                                                                                                                                                                        Vektorien välisen kulman määritelmän mukaan \(0^{\circ} \le \alpha \le 180^{\circ}\), mistä seuraa, että \(\sin\alpha\ge 0\). Lisäksi vektorien normit ovat aina epänegatiivisia. Siten \(\norm{\vv \times \vw} \ge 0\)ja \(\norm{\vv}\norm{\vw}\sin\alpha \ge 0\). Saadusta yhtälöstä voidaan näin ollen päätellä, että
                                                                                                                                                                                                        \[\norm{\vv \times \vw}=\norm{\vv}\norm{\vw}\sin\alpha.\]
                                                                                                                                                                                                        Tämä todistaa väitteen.
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Edellisestä lauseesta seuraa, että ristitulovektorin \(\vv \times \vw\)pituus on yhtä suuri kuin vektorien \(\vv\)ja \(\vw\)määräämän suunnikkaan ala (ks. kuva alla <!-- \ref{k-->33}). Oletetaan nimittäin, että vektorien \(\vv\)ja \(\vw\)välinen kulma on \(\alpha\). Tällöin suunnikkaan korkeus on \(\norm{\vw}\sin\alpha\). Näin suunnikkaan pinta-alaksi saadaan \(\norm{\vw}\sin\alpha\cdot \norm{\vv}=\norm{\vv \times \vw}\).

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva33.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Ristitulovektorin \(\vv \times \vw\)pituus on yhtä suuri kuin vektorien \(\vv\)ja \(\vw\)määräämän suunnikkaan ala.}<!-- \label{k33} -->
                                                                                                                                                                                                        </div>

                                                                                                                                                                                                        Ristitulon avulla voidaan määrittää myös suuntaissärmiön tilavuus.
                                                                                                                                                                                                        Vektoreiden \(\vv\), \(\vw\)ja \(\vu\)määräämään suuntaissärmiön tilavuus on pohjan pinta-alan \(\norm{\vv \times \vw}\)ja korkeuden \(h\)tulo (ks.~kuva~alla <!-- \ref{k-->34}). Pohjan pinta-alan tiedetään olevan \(\norm{\vv \times \vw}\). Määritetään vielä korkeus \(h\). Olkoon \(\beta\)vektoreiden \(\vu\)ja \(\vv \times \vw\)välinen kulma. Nyt
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        h = \norm{\vu}|\cos (180^\circ -\beta)|= \norm{\vu}|\cos \beta|.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Siten tilavuus on
                                                                                                                                                                                                        \[
                                                                                                                                                                                                        \norm{\vv \times \vw}\norm{\vu}|\cos \beta|=\bigl|\norm{\vv \times \vw}\norm{\vu}\cos \beta\bigr|
                                                                                                                                                                                                        =|(\vv \times \vw) \cdot \vu|.
                                                                                                                                                                                                        \]
                                                                                                                                                                                                        Viimeisessä välivaiheessa käytettiin vektorien \(\vu\)ja \(\vv \times \vw\)välisen kulman määritelmää.
                                                                                                                                                                                                        Suunnikkaan tilavuus on siis niin kutsutun <strong>skalaarikolmitulon} \((\vv \times \vw) \cdot \vu\)itseisarvo. Lauseesta~14.7 seuraa, että vektorien \(\vv\), \(\vw\)ja \(\vu\)järjestyksellä tässä kaavassa ei ole väliä.

                                                                                                                                                                                                        <div class="image">

                                                                                                                                                                                                        <img src="https://raw.github.com/ruumis/Lineaarialgebra-ja-matriisilaskenta/master/kuvia/kuva34.png" />
                                                                                                                                                                                                        <strong>Kuva: </strong>Vektoreiden \(\vv\), \(\vw\)ja \(\vu\)määräämään suuntaissärmiön tilavuus.}<!-- \label{k34} -->
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </div>
                                                                                                                                                                                                        </section>

                                                                                                                                                                                                        </body>
                                                                                                                                                                                                        </html>
